1
00:00:00,330 --> 00:00:04,896
Hi, in this video we will prove that
the set of functions we suggested to you

2
00:00:04,896 --> 00:00:08,751
with integers is really a universal
family of hash functions.

3
00:00:08,751 --> 00:00:12,410
This video will be heavy on math but
it is optional.

4
00:00:12,410 --> 00:00:15,800
We will use properties of prime
numbers of modular arithmetics.

5
00:00:15,800 --> 00:00:18,750
We will use the concept of
one to one correspondence.

6
00:00:18,750 --> 00:00:23,520
Properties of upper integral parts of
real number and probabilities of course.

7
00:00:24,840 --> 00:00:29,000
So the theorem is that the set of
functions was suggested polygraphic H with

8
00:00:29,000 --> 00:00:34,220
index B is the set of all
hash functions indexed by B,

9
00:00:34,220 --> 00:00:39,910
A, and B where B is a prime number and
A and B are parameters.

10
00:00:39,910 --> 00:00:43,131
And those parameters
generate hash functions.

11
00:00:43,131 --> 00:00:48,894
So the formula for the hash function
is on the side, and parameters a and

12
00:00:48,894 --> 00:00:53,911
b are from one to p-1 and
from zero to p-1, respectively.

13
00:00:53,911 --> 00:00:58,666
So this is a family of hash functions
which contains p multiplied by p-1,

14
00:00:58,666 --> 00:01:01,998
different hash functions for
different bayers ab.

15
00:01:01,998 --> 00:01:05,882
So these functions is
the universal family for

16
00:01:05,882 --> 00:01:10,740
the universe of keys,
which are integers from 0 to p- 1.

17
00:01:10,740 --> 00:01:15,810
And of course, it will be also universal
family for any sub-set of this universe.

18
00:01:16,940 --> 00:01:19,217
Now, let's prove this theorem.

19
00:01:19,217 --> 00:01:21,357
To do that, we first need a Lemma.

20
00:01:21,357 --> 00:01:27,500
So, select some hash function with
parameters a and b from our set, a b.

21
00:01:29,350 --> 00:01:36,599
And fix some keys, x and y which are
different, then, the intermediate values,

22
00:01:36,599 --> 00:01:42,497
which would compute while computing
the hash value of keys x and y.

23
00:01:42,497 --> 00:01:45,568
So ax + b modular p and ay + b modular p,

24
00:01:45,568 --> 00:01:51,153
those are the intermediate values
before we take the value modular m and

25
00:01:51,153 --> 00:01:56,220
get the actual value of the hash
function from our family.

26
00:01:56,220 --> 00:02:02,910
So those values are always different for
different keys in the universe.

27
00:02:02,910 --> 00:02:05,830
We will prove this Lemma by contradiction.

28
00:02:05,830 --> 00:02:11,260
So suppose is equal to s or
(ax + b) is equal to (ay +b) mod p.

29
00:02:11,260 --> 00:02:15,840
We subtract the right part
from the left part and

30
00:02:15,840 --> 00:02:20,280
we see that a(x-y) is equal to 0 mod p.

31
00:02:20,280 --> 00:02:24,810
And that means that b divides
product of a and x minus y.

32
00:02:24,810 --> 00:02:27,920
Now recall that b is a prime number and so

33
00:02:27,920 --> 00:02:32,650
it means that either b divides a or
that b divides x minus y.

34
00:02:32,650 --> 00:02:37,670
But a is between 1 and p minus 1 so
a is a positive integer less than p and

35
00:02:37,670 --> 00:02:43,060
p is prime so p cannot divide a and
thus p must divide x minus y.

36
00:02:44,290 --> 00:02:48,670
But x and y are between 0 and p minus 1.

37
00:02:48,670 --> 00:02:53,570
So their difference is,
by absolute value, less than p.

38
00:02:53,570 --> 00:02:55,810
And p divides x minus y.

39
00:02:55,810 --> 00:03:00,032
So, the only value for x minus y,
for which it is possible is 0.

40
00:03:00,032 --> 00:03:02,080
x minus y is 0.

41
00:03:02,080 --> 00:03:04,120
And so x is equal to y.

42
00:03:04,120 --> 00:03:07,130
But this contradicts our
initial assumption that x and

43
00:03:07,130 --> 00:03:08,600
y are different keys.

44
00:03:08,600 --> 00:03:12,570
And so we prove by contradiction
that r is not equal to s.

45
00:03:14,330 --> 00:03:18,070
There is a corollary from that that for
hash function h

46
00:03:19,530 --> 00:03:24,160
which is without taking modular m,
there are no collisions.

47
00:03:24,160 --> 00:03:27,040
And an important corollary is that for

48
00:03:27,040 --> 00:03:32,460
a hash function,
which is before taking modulo m,

49
00:03:32,460 --> 00:03:37,630
there are no collisions for the universe
of integer keys from 0 to p minus 1.

50
00:03:37,630 --> 00:03:39,857
Now we need another lemma.

51
00:03:39,857 --> 00:03:42,850
That for
any pair of different keys x and y,

52
00:03:42,850 --> 00:03:47,256
there is a 1 to 1 correspondence
between pairs of numbers a and

53
00:03:47,256 --> 00:03:52,160
b which generally different
hash functions in our family.

54
00:03:52,160 --> 00:03:56,580
And pairs of numbers r and s,
which are the intermediate values in

55
00:03:56,580 --> 00:04:00,570
the computation of hash
function of keys x and y.

56
00:04:02,050 --> 00:04:02,850
Let's prove that.

57
00:04:02,850 --> 00:04:08,810
First know that different pairs a,
b generate different pairs r, s.

58
00:04:08,810 --> 00:04:13,320
And that is because if we
have some pair r, s we can

59
00:04:13,320 --> 00:04:18,270
uniquely solve for a and
b module b with these formulas.

60
00:04:18,270 --> 00:04:24,287
So if there is any other pair, a prime
b prime which leads to the same r and

61
00:04:24,287 --> 00:04:29,200
s, then actually a prime and
b prime have to be equal to a and

62
00:04:29,200 --> 00:04:33,035
b respectively because of these equations.

63
00:04:33,035 --> 00:04:38,906
So now we know that different pairs a and
b generate different pairs r, s.

64
00:04:39,910 --> 00:04:44,940
And we know that the total number of
pairs a,b is p multiplied by p-1 because

65
00:04:44,940 --> 00:04:49,660
there are p-1 values for a and
independently p values for b.

66
00:04:49,660 --> 00:04:52,980
So total number of pairs
is p multiplied by p-1.

67
00:04:52,980 --> 00:04:58,060
And also, it turns out that the total
number of pairs r,s is also p multiplied

68
00:04:58,060 --> 00:05:01,501
by p-1 Because the total
number of pairs r,

69
00:05:01,501 --> 00:05:05,080
s with values from 0 to p- 1 is p squared.

70
00:05:05,080 --> 00:05:10,760
But r must be different from s so
we must subtract p from that,

71
00:05:10,760 --> 00:05:15,580
and that will be p squared- p which
is the same as p multiplied by p- 1.

72
00:05:15,580 --> 00:05:20,990
So the number of pairs a,
b is the same as the number of pairs r, s.

73
00:05:20,990 --> 00:05:26,208
And different pairs a,b led to different
pairs (r,s) and that means that

74
00:05:26,208 --> 00:05:31,275
there is a one to one correspondence
between these pairs and these pairs.

75
00:05:31,275 --> 00:05:37,776
And the corollary from that is that if
we select some pair of different keys,

76
00:05:37,776 --> 00:05:41,955
x and y and
we select any hash function at random.

77
00:05:41,955 --> 00:05:46,979
For all our family with equal probability,
which is one of p multiplied

78
00:05:46,979 --> 00:05:51,664
by p minus one, because they're all,
p multiplied by p minus 1,

79
00:05:51,664 --> 00:05:56,797
different hash functions in our family,
then each pair of values are S.

80
00:05:56,797 --> 00:06:01,789
Which are intermediate values,
happen with equal probability,

81
00:06:01,789 --> 00:06:06,460
again, one over P multiplied by p- 1 so
why is that?

82
00:06:06,460 --> 00:06:11,250
Well we know that there's a one to one
correspondence between pairs a, b and

83
00:06:11,250 --> 00:06:16,010
pairs r, s and selecting the hash
function from our family is the same

84
00:06:16,010 --> 00:06:20,510
selecting random pair a, b we know
that the probability of any pair a,

85
00:06:20,510 --> 00:06:23,990
b is one over p by p -1.

86
00:06:23,990 --> 00:06:28,356
And so the probability of any pair
r,s is the same as the probability of

87
00:06:28,356 --> 00:06:30,283
the corresponding pair a,b.

88
00:06:30,283 --> 00:06:35,044
So it is always 1/p(p- 1).

89
00:06:35,044 --> 00:06:37,982
So we proved our corrollary.

90
00:06:37,982 --> 00:06:41,520
Now let's prove the initial theorem.

91
00:06:41,520 --> 00:06:46,590
The probability of collision for a fixed
pair of keys, x and y, which are different

92
00:06:46,590 --> 00:06:52,750
is the same as the probability that
r module m is the same as s module m.

93
00:06:52,750 --> 00:06:56,303
We know that r is different from s, but

94
00:06:56,303 --> 00:07:01,974
they still can be equal module m
because m can be less than Pm.

95
00:07:01,974 --> 00:07:04,970
In most cases it is actually less than b.

96
00:07:07,230 --> 00:07:14,260
So we, again, know that each pair r,
s has probability 1 over p by p minus 1.

97
00:07:14,260 --> 00:07:19,310
And we'll estimate the probability
of collision using this fact.

98
00:07:21,330 --> 00:07:26,564
Know that for each fixed r from 0
to p minus 1, there are at most.

99
00:07:26,564 --> 00:07:30,020
Upper integral part of p over m,

100
00:07:30,020 --> 00:07:35,524
minus 1 such value of s that
s is different from r and

101
00:07:35,524 --> 00:07:39,503
r modular m is the same as s modular m.

102
00:07:39,503 --> 00:07:40,757
So why is that?

103
00:07:40,757 --> 00:07:45,764
Well, let's assume, without loss of
generality, that r modular m is 0.

104
00:07:45,764 --> 00:07:50,672
And look at the roll of numbers from 0-P-1

105
00:07:50,672 --> 00:07:55,710
than the numbers which
have the same remainder

106
00:07:55,710 --> 00:08:00,355
module m as r are 0 M, 2M, 3M, 4M and so

107
00:08:00,355 --> 00:08:06,835
on up to a paranted real part
of P over M-1 multiplied by M.

108
00:08:06,835 --> 00:08:12,400
We cannot multiply the next integer
by m because that is already

109
00:08:12,400 --> 00:08:18,385
bigger than p minus 1, so
in total there are part of pure m,

110
00:08:18,385 --> 00:08:21,430
different integers between 0 and

111
00:08:21,430 --> 00:08:27,070
p minus 1 which have the same
remainder modular m as r.

112
00:08:27,070 --> 00:08:29,970
But, s also needs to be different from r.

113
00:08:29,970 --> 00:08:33,070
So, the number of such s', less by 1.

114
00:08:35,310 --> 00:08:41,160
And now, the probability of collision
is equal to probability r module m,

115
00:08:41,160 --> 00:08:46,850
equal to s module m, and that is,
at most, some of probabilities

116
00:08:46,850 --> 00:08:52,900
of all such pairs are s for
which this equality holds.

117
00:08:52,900 --> 00:08:58,240
So we sum over all different
values of r from 0 to p-1 and

118
00:09:00,060 --> 00:09:04,750
then we sum over all pairs
which contain this r.

119
00:09:04,750 --> 00:09:08,120
And for which s module m
is the same as r module m.

120
00:09:08,120 --> 00:09:13,080
We estimated that their at most
integral part of p over m-1

121
00:09:13,080 --> 00:09:15,530
such as for any fixed r.

122
00:09:16,540 --> 00:09:20,360
And the probability of any
final pair of this r and

123
00:09:20,360 --> 00:09:25,640
any s with the same remainder
module m is 1 over p

124
00:09:25,640 --> 00:09:30,070
by p-1 so
the total probability is at most this sum.

125
00:09:31,360 --> 00:09:36,150
And the sum has exactly p and
it has p in the denominator so

126
00:09:36,150 --> 00:09:39,390
we can just remove the sum and
the denominator and

127
00:09:39,390 --> 00:09:44,790
we get upper integral part of
p over m-1 divided by p-1.

128
00:09:44,790 --> 00:09:49,040
Then we use the property of that upper
integral part of p over m at most

129
00:09:49,040 --> 00:09:51,260
p plus m minus one over m.

130
00:09:52,440 --> 00:09:57,850
And then, when we make the common
denominator, and remove

131
00:09:57,850 --> 00:10:02,880
all the things that cancel out,
we see that it is equal to 1 over m.

132
00:10:02,880 --> 00:10:05,530
So we just proved that the probability of

133
00:10:05,530 --> 00:10:10,150
r modular m being the same as s
modular m is, at most, 1 over m.

134
00:10:10,150 --> 00:10:13,710
And that proves that
the probability of collision for

135
00:10:13,710 --> 00:10:18,840
some fixed pair of different keys,
x and y is, at most, 1 over m.

136
00:10:18,840 --> 00:10:22,140
And that is the property of universal
family that we needed to prove.

137
00:10:22,140 --> 00:10:24,808
So we finally proved our theorem.

138
00:10:24,808 --> 00:10:29,461
In conclusion, we've just proved
that a suggested family is

139
00:10:29,461 --> 00:10:34,648
really a universal family for
integers, but now the important thing

140
00:10:34,648 --> 00:10:39,583
that integers are not unbounded
on the integers from 0 to p- 1.

141
00:10:39,583 --> 00:10:43,279
So if you need to hash really,
really big integers,

142
00:10:43,279 --> 00:10:48,235
you will need to select a prime number
that is bigger, even bigger than

143
00:10:48,235 --> 00:10:53,191
the largest of those numbers and
then you will get universal family for

144
00:10:53,191 --> 00:10:57,920
that prime number and
it will work for your integers.

145
00:10:57,920 --> 00:11:02,660
We also proved in the previous
video the upper bound for

146
00:11:02,660 --> 00:11:08,140
expected chain length using universal
family and constant amortized expected

147
00:11:08,140 --> 00:11:12,800
running time of operations with hash
table, also provided in the last lecture.

148
00:11:12,800 --> 00:11:14,690
So now we have the whole picture.

149
00:11:14,690 --> 00:11:17,230
We have a universal family for integers.

150
00:11:17,230 --> 00:11:20,605
And we have proofs that if
you use a universal family,

151
00:11:20,605 --> 00:11:22,713
that your operations work fast.

152
00:11:22,713 --> 00:11:27,554
So now we are confident that if
you use the suggested family for

153
00:11:27,554 --> 00:11:32,302
integers, then the operations
with the hash tables storing

154
00:11:32,302 --> 00:11:37,351
those integers will run fast in practice,
at least on average.