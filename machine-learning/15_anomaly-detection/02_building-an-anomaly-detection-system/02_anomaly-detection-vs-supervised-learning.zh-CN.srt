1
00:00:00,180 --> 00:00:01,210
在上一段视频中 我们谈到

2
00:00:01,580 --> 00:00:02,950
如何评价一个

3
00:00:03,790 --> 00:00:05,780
异常检测算法

4
00:00:05,910 --> 00:00:06,980
我们先是用了一些

5
00:00:07,210 --> 00:00:08,810
带标签的数据

6
00:00:08,880 --> 00:00:10,150
以及一些我们知道是异常

7
00:00:11,010 --> 00:00:13,170
或者正常的样本 用 y=1 或 y=0 来表示

8
00:00:14,690 --> 00:00:15,380
这就引出了这样一个问题：

9
00:00:15,690 --> 00:00:17,700
我们有了这些带标签的数据

10
00:00:18,130 --> 00:00:19,620
我们有了一些样本

11
00:00:19,750 --> 00:00:20,840
其中一些我们知道是异常的

12
00:00:21,020 --> 00:00:21,850
另外一些是正常的

13
00:00:22,090 --> 00:00:23,540
那我们为什么我们不

14
00:00:23,640 --> 00:00:25,580
直接用监督学习的方法呢？

15
00:00:25,720 --> 00:00:26,790
为什么不直接用

16
00:00:27,110 --> 00:00:28,360
逻辑回归或者

17
00:00:28,680 --> 00:00:29,770
神经网络的方法

18
00:00:30,020 --> 00:00:31,260
来直接学习这些带标签的数据

19
00:00:31,550 --> 00:00:34,120
从而给出预测 y=1 或 y=0 呢？

20
00:00:34,900 --> 00:00:35,900
在这段视频中

21
00:00:36,160 --> 00:00:37,170
我就将跟你分享一些

22
00:00:37,350 --> 00:00:38,820
可供参考的方法

23
00:00:39,130 --> 00:00:40,610
关于什么时候应该用

24
00:00:40,720 --> 00:00:42,160
异常检测算法

25
00:00:42,440 --> 00:00:43,500
什么时候用监督学习算法

26
00:00:43,920 --> 00:00:45,380
是更有成效的

27
00:00:47,160 --> 00:00:48,950
这张幻灯片展示的就是

28
00:00:49,010 --> 00:00:50,130
什么时候应该用异常检测

29
00:00:50,900 --> 00:00:52,370
什么时候用监督学习更加有效

30
00:00:52,930 --> 00:00:54,590
两种情况的一个比较

31
00:00:56,030 --> 00:00:57,440
如果你的学习问题

32
00:00:57,560 --> 00:00:58,820
正样本的数量很小

33
00:00:59,720 --> 00:01:01,780
别忘了 样本 y=1

34
00:01:01,890 --> 00:01:03,000
表示的是

35
00:01:03,650 --> 00:01:05,520
异常的样本

36
00:01:06,170 --> 00:01:08,160
那么你也许应该考虑使用异常检测算法

37
00:01:09,260 --> 00:01:10,430
因此 假如有0到20

38
00:01:10,600 --> 00:01:12,740
甚至到50组正样本

39
00:01:13,450 --> 00:01:15,190
通常50个也是很典型的

40
00:01:15,680 --> 00:01:16,810
如果我们有这么小的一组

41
00:01:17,130 --> 00:01:18,340
正样本的话

42
00:01:19,270 --> 00:01:20,170
我们可以把这些正样本

43
00:01:20,510 --> 00:01:21,530
存为交叉验证集

44
00:01:21,840 --> 00:01:24,440
和测试集

45
00:01:24,850 --> 00:01:26,130
相反地

46
00:01:26,510 --> 00:01:28,560
异常检测算法的典型设置

47
00:01:29,340 --> 00:01:30,630
一般应该有一组

48
00:01:31,010 --> 00:01:32,340
比较大量的负样本

49
00:01:33,110 --> 00:01:34,300
也就是正常样本

50
00:01:34,910 --> 00:01:36,710
比如正常的飞机引擎样本

51
00:01:37,720 --> 00:01:38,900
这样我们就可以

52
00:01:39,200 --> 00:01:40,240
用这组大量的负样本

53
00:01:41,470 --> 00:01:42,510
来拟合 p(x) 的模型

54
00:01:43,000 --> 00:01:44,090
所以

55
00:01:44,190 --> 00:01:45,930
在许多异常检测应用中

56
00:01:46,320 --> 00:01:48,510
有一种观点就是

57
00:01:48,760 --> 00:01:50,220
如果你有很少的正样本

58
00:01:50,320 --> 00:01:52,540
但有大量的负样本

59
00:01:52,810 --> 00:01:54,960
在对 p(x) 进行估计

60
00:01:55,220 --> 00:01:57,520
并且拟合那些高斯参数的过程中

61
00:01:58,650 --> 00:02:00,690
我们只需要负样本

62
00:02:00,850 --> 00:02:01,680
因此如果你有很多负样本的话

63
00:02:02,140 --> 00:02:04,310
我们依然可以很好地拟合 p(x)

64
00:02:05,340 --> 00:02:07,090
反过来 对监督学习

65
00:02:07,760 --> 00:02:08,790
一般来讲

66
00:02:09,180 --> 00:02:10,810
我们的正负样本数量

67
00:02:11,050 --> 00:02:12,370
都应该比较大

68
00:02:13,920 --> 00:02:14,970
因此 这是一种

69
00:02:15,070 --> 00:02:16,240
可以从你要解决的问题中看出

70
00:02:16,770 --> 00:02:17,860
你应该使用异常检测

71
00:02:18,240 --> 00:02:20,180
还是监督学习算法的方法

72
00:02:21,750 --> 00:02:24,750
人们对异常检测算法还有另一种认识

73
00:02:25,530 --> 00:02:26,890
对异常检测算法

74
00:02:27,900 --> 00:02:28,890
通常会有很多种不同的

75
00:02:29,040 --> 00:02:30,600
异常的种类

76
00:02:31,280 --> 00:02:31,770
比如飞机引擎的例子

77
00:02:32,040 --> 00:02:34,680
你知道 引起飞机引擎不工作的原因有很多

78
00:02:34,880 --> 00:02:36,980
对吧？很多部件坏了都可能导致引擎故障

79
00:02:38,830 --> 00:02:40,080
因此 如果是这样的话

80
00:02:40,120 --> 00:02:40,940
并且如果你只有很少的

81
00:02:41,140 --> 00:02:43,560
一组正样本

82
00:02:44,430 --> 00:02:46,760
那么一个学习算法

83
00:02:47,580 --> 00:02:48,380
要从你这么少的正样本中

84
00:02:48,740 --> 00:02:50,130
学习出这个异常 是比较困难的

85
00:02:50,180 --> 00:02:51,880
具体来说

86
00:02:52,800 --> 00:02:54,050
未来的异常

87
00:02:54,220 --> 00:02:55,750
可能跟你已经见过的完全不同

88
00:02:56,050 --> 00:02:57,540
所以 可能在你的

89
00:02:57,790 --> 00:02:59,030
正样本的集合里

90
00:02:59,190 --> 00:02:59,740
你可能已经有了5种 或者10种 20种

91
00:02:59,950 --> 00:03:02,960
不同的引擎故障的原因

92
00:03:03,780 --> 00:03:05,600
但可能明天

93
00:03:05,780 --> 00:03:07,110
你就需要检测

94
00:03:07,440 --> 00:03:08,870
一种全新的集合

95
00:03:09,250 --> 00:03:10,620
一种全新的异常种类

96
00:03:10,820 --> 00:03:12,170
一种全新的

97
00:03:12,570 --> 00:03:13,870
你从来都没见过的

98
00:03:14,090 --> 00:03:15,660
引擎故障原因

99
00:03:15,950 --> 00:03:17,010
如果是这样的话

100
00:03:17,550 --> 00:03:18,460
那么这更加说明

101
00:03:18,650 --> 00:03:20,020
你应该对负样本

102
00:03:20,480 --> 00:03:21,770
进行建模 建立这个

103
00:03:21,970 --> 00:03:23,620
高斯模型 p(x)

104
00:03:23,970 --> 00:03:24,950
而不是很费力地

105
00:03:25,290 --> 00:03:26,250
对正样本进行建模

106
00:03:26,640 --> 00:03:27,850
因为你知道 (即便你建了模型)

107
00:03:28,040 --> 00:03:29,310
明天你也许就会遇到

108
00:03:29,420 --> 00:03:32,680
你完全没有见过的异常类型

109
00:03:33,140 --> 00:03:34,640
相对而言

110
00:03:34,790 --> 00:03:36,170
在其他一些问题中

111
00:03:36,600 --> 00:03:37,790
你拥有足够多的正样本

112
00:03:38,730 --> 00:03:40,850
你的算法能够感觉到正样本是什么样的

113
00:03:40,980 --> 00:03:42,860
具体来说

114
00:03:42,960 --> 00:03:44,270
如果你认为未来的正样本

115
00:03:44,870 --> 00:03:45,690
跟训练集中的

116
00:03:46,130 --> 00:03:46,980
很相似的话

117
00:03:47,670 --> 00:03:49,090
那么在这样的条件下

118
00:03:49,230 --> 00:03:51,720
用监督学习算法似乎更加合理

119
00:03:52,550 --> 00:03:53,390
既使用大量的

120
00:03:53,520 --> 00:03:54,760
正样本 也使用

121
00:03:54,930 --> 00:03:56,530
大量的负样本

122
00:03:56,650 --> 00:03:58,980
并且尝试对正负样本进行分类

123
00:04:01,620 --> 00:04:02,780
希望这样讲

124
00:04:02,870 --> 00:04:04,180
你能够明白

125
00:04:04,520 --> 00:04:05,690
当遇到具体的问题时

126
00:04:05,950 --> 00:04:07,800
应该使用异常检测算法

127
00:04:08,110 --> 00:04:09,450
还是监督学习算法

128
00:04:11,110 --> 00:04:12,340
关键的区别就是

129
00:04:12,520 --> 00:04:13,870
在异常检测算法中

130
00:04:14,020 --> 00:04:15,040
我们只有一小撮

131
00:04:15,330 --> 00:04:17,200
正样本

132
00:04:17,240 --> 00:04:18,640
因此学习算法不可能

133
00:04:19,330 --> 00:04:21,810
从这些正样本中学出太多东西

134
00:04:22,430 --> 00:04:23,440
因此取而代之的是

135
00:04:23,890 --> 00:04:25,050
我们使用一组大量的

136
00:04:25,230 --> 00:04:26,420
负样本

137
00:04:27,050 --> 00:04:28,070
这样样本就能学到更多

138
00:04:28,230 --> 00:04:29,300
或者说能从大量的负样本

139
00:04:29,500 --> 00:04:31,730
比如大量的正常引擎样本中 学出 p(x) 模型

140
00:04:32,190 --> 00:04:33,480
另外 我们预留一小部分

141
00:04:33,640 --> 00:04:36,740
正样本来评价我们的算法

142
00:04:37,350 --> 00:04:39,680
既用于交叉验证集 也用于测试集

143
00:04:41,210 --> 00:04:42,380
另外再额外说一点

144
00:04:42,620 --> 00:04:43,970
关于这些不同类型的

145
00:04:44,090 --> 00:04:45,490
异常情况

146
00:04:45,790 --> 00:04:46,910
在前面的一些视频中

147
00:04:47,050 --> 00:04:49,060
我们提到了垃圾邮件的例子

148
00:04:50,020 --> 00:04:51,510
在那些例子中

149
00:04:51,910 --> 00:04:53,450
垃圾邮件的类型其实也有很多种

150
00:04:53,930 --> 00:04:54,750
有的是想卖东西给你

151
00:04:55,030 --> 00:04:57,650
有的是想钓出你的密码

152
00:04:58,470 --> 00:05:01,060
这种就叫钓鱼邮件 还有其他一些类型的垃圾邮件

153
00:05:01,820 --> 00:05:03,490
但对于垃圾邮件的问题

154
00:05:03,930 --> 00:05:05,660
我们通常有足够多的

155
00:05:06,000 --> 00:05:07,400
垃圾邮件的样本

156
00:05:07,490 --> 00:05:08,650
我们能得到绝大多数不同类型的

157
00:05:08,890 --> 00:05:10,200
垃圾邮件 因为我们有大量的

158
00:05:10,410 --> 00:05:11,650
垃圾邮件样本的集合

159
00:05:11,860 --> 00:05:13,050
因此这也是为什么

160
00:05:13,330 --> 00:05:14,800
我们通常把垃圾邮件问题看作是

161
00:05:14,980 --> 00:05:16,510
监督学习问题的原因

162
00:05:16,710 --> 00:05:17,390
虽然垃圾邮件的种类

163
00:05:17,530 --> 00:05:19,230
通常有太多太多

164
00:05:21,890 --> 00:05:23,170
因此 我们可以看看

165
00:05:23,310 --> 00:05:24,940
一些异常检测的应用

166
00:05:25,600 --> 00:05:27,290
和监督学习应用的比较

167
00:05:27,480 --> 00:05:29,280
我们不难发现 对于欺诈检测(fraud detection)

168
00:05:29,410 --> 00:05:31,040
如果你掌握了许多种

169
00:05:31,450 --> 00:05:32,510
不同类型的

170
00:05:32,680 --> 00:05:34,120
诈骗方法

171
00:05:34,170 --> 00:05:35,730
并且相对较小的训练集

172
00:05:35,880 --> 00:05:37,500
很少的一些你网站上

173
00:05:37,920 --> 00:05:40,300
出现的欺诈用户 那我会使用异常检测算法

174
00:05:41,310 --> 00:05:42,520
当然 我要声明一点

175
00:05:42,650 --> 00:05:44,560
如果你是一个大型在线零售商

176
00:05:44,700 --> 00:05:46,810
并且你掌握了

177
00:05:46,930 --> 00:05:48,170
大量的 想要在你的网站上

178
00:05:48,330 --> 00:05:49,230
实施诈骗犯罪的人

179
00:05:49,390 --> 00:05:50,420
也就是说

180
00:05:50,480 --> 00:05:51,340
你有很多 y=1 的样本

181
00:05:51,410 --> 00:05:53,760
那么有时候

182
00:05:53,970 --> 00:05:55,410
欺诈检测的方法也可能会

183
00:05:55,700 --> 00:05:58,030
偏向于使用监督学习算法

184
00:05:58,850 --> 00:06:01,000
但是 如果你

185
00:06:01,210 --> 00:06:02,440
并没有看到许多

186
00:06:02,940 --> 00:06:04,480
在你网站上

187
00:06:04,690 --> 00:06:05,720
进行异常行为的用户样本

188
00:06:05,920 --> 00:06:07,970
那么欺诈检测

189
00:06:08,510 --> 00:06:09,730
通常还是被当做是

190
00:06:09,990 --> 00:06:12,060
一个异常检测算法 而不是一个监督学习算法

191
00:06:14,140 --> 00:06:15,160
还有另外一些例子

192
00:06:15,310 --> 00:06:16,810
我们已经谈到了生产中的应用

193
00:06:16,950 --> 00:06:18,230
我们期待看到更多的正常样本

194
00:06:19,110 --> 00:06:19,840
少出现一些异常情况

195
00:06:20,520 --> 00:06:21,560
但对一些生产过程来说

196
00:06:22,180 --> 00:06:23,900
如果你进行大量的生产作业

197
00:06:23,990 --> 00:06:25,690
并且发现了

198
00:06:25,860 --> 00:06:26,780
比较多的坏的样本

199
00:06:27,230 --> 00:06:29,220
那么这个问题同样也可能

200
00:06:29,790 --> 00:06:31,690
转向一个监督学习问题

201
00:06:32,630 --> 00:06:33,680
但如果你并没有看到

202
00:06:33,950 --> 00:06:35,640
太多的不正常样本

203
00:06:35,830 --> 00:06:38,140
那么还是把它当做异常检测问题来处理

204
00:06:39,180 --> 00:06:40,290
数据中心的监控机器

205
00:06:40,400 --> 00:06:42,450
同样地 前面那些讨论

206
00:06:42,880 --> 00:06:44,050
也适用于这种情况

207
00:06:45,280 --> 00:06:46,650
相对而言

208
00:06:47,070 --> 00:06:48,950
垃圾邮件分类、天气预报

209
00:06:49,510 --> 00:06:50,580
以及癌症诊断的问题

210
00:06:51,200 --> 00:06:52,850
如果你拥有相同数量

211
00:06:52,870 --> 00:06:53,920
的正负样本

212
00:06:54,010 --> 00:06:55,550
或者说既有大量的

213
00:06:55,670 --> 00:06:56,780
正样本 也有大量的

214
00:06:57,030 --> 00:06:57,870
负样本 那么我们还是

215
00:06:58,080 --> 00:07:00,630
倾向于把这些问题当做监督学习

216
00:07:03,400 --> 00:07:04,500
希望这节课能让你

217
00:07:04,580 --> 00:07:05,600
明白一个学习问题的

218
00:07:05,770 --> 00:07:07,050
什么样的特征

219
00:07:07,350 --> 00:07:08,980
能让你把这个问题

220
00:07:09,420 --> 00:07:10,410
当做是一个异常检测

221
00:07:10,810 --> 00:07:12,660
或者是一个监督学习的

222
00:07:14,250 --> 00:07:14,250
问题

223
00:07:14,690 --> 00:07:16,020
另外对于很多技术公司

224
00:07:16,260 --> 00:07:17,820
可能会遇到的一些问题

225
00:07:18,200 --> 00:07:19,780
通常来说

226
00:07:19,860 --> 00:07:20,900
正样本的数量很少

227
00:07:21,510 --> 00:07:23,320
甚至有时候是0

228
00:07:24,060 --> 00:07:25,090
也就是说

229
00:07:25,400 --> 00:07:26,830
出现了太多没见过的

230
00:07:26,980 --> 00:07:28,410
不同的异常类型

231
00:07:28,530 --> 00:07:29,810
那么对于这些问题

232
00:07:29,960 --> 00:07:31,900
通常应该使用的算法就是

233
00:07:32,440 --> 00:07:33,580
异常检测算法

234
00:07:33,790 --> 00:07:35,170
【教育无边界字幕组】翻译：所罗门捷列夫 校对：竹二个 审核：小白_远游