前回のビデオでは アノマリー検出のアルゴリズムを 評価する手順について話した。 そこではラベル付きのデータを アノマリーかそうでないか分かっているサンプルに対して、 y=1か0かで対応させる事で ラベル付けしたデータを用いた。 そこで浮かぶ疑問としては、 このラベル付きデータがあるなら どれがアノマリーで どれがアノマリーじゃない、という事が 分かっているデータがあるのなら、 何故単純に 教師有り学習アルゴリズムを使わないのか？ つまりなんでただロジスティック回帰や ニューラルネットワークを使って ラベル付けされたデータから 直接学習してしまわないのか？ そうしてyが1か0かを予測してしまえばいいのでは？ このビデオでは、どういう時に アノマリー検出アルゴリズムを使い どういう時には 教師有り学習アルゴリズムの使用を検討したほうが 実りが多いのかについて、 いくつかの考え方とガイドラインを お話したい。 このスライドでは、 どういう状況ではアノマリー検出を使った方が良くて どういう時は教師有り学習の方が実りが多いのかを 示している。 もし陽性のサンプルの数が とても少い場合は、 ここでy=1がアノマリーの サンプルだったかだが、 その場合は アノマリー検出のアルゴリズムの使用を検討すべきだ。 つまり0から20個とか、 まぁ50個くらいまでの陽性のサンプルは とても典型的な範囲で、通常は そんなに陽性のサンプル数が 少ない時は、 それらの陽性のサンプルを クロスバリデーションセットと テストセットの為に取っておくのが良かろう。 逆に、典型的な アノマリー検出の状況としては、 相対的にとても大量の 陰性のサンプルがある。 これら正常なサンプル、 これら正常は航空機エンジンなど。 そしてこれらのとても大量の サンプルを使って モデルp(x)のフィッティングを行う事が出来る。 つまり、だいたい アノマリー検出の適用のケースでは 陽性のサンプルが ほんのちょっとしか無くて 陰性のサンプルは大量にある場合だ。 そしてp(x)を推計している時、 ガウス分布のパラメータをフィッティングしている時は 陰性のサンプルしか必要としない。 だからたくさんの陰性のデータがあれば、 p(x)をフィッティングするのは極めてうまくやれる。 逆に教師有り学習の時は、 十分にたくさんの、 陽性と陰性のサンプル両方が あるのがより典型的だ。 これがあなたの問題に対して アノマリー検出アルゴリズムを使うべきか 教師有り学習のアルゴリズムを使うべきかを決めるのに 着目すべきポイントの一つだ。 さて、アノマリー検出のアルゴリズムについて皆が良く思う、もう一つの考え方はこうだ。 アノマリー検出の適用時は、 しばしばたくさんの異なる種類の アノマリーがあるものだ。 航空機エンジンについて考えてみてくれ。 お分かりのように、航空機のエンジンが不良品となるには、実に様々なパターンが考えられる。 様々な物が不良品となり得て、それぞれが航空機エンジンの故障の原因たりえる。 そしてさらに、もし陽性のサンプルが とても少ししか 得られていなければ そのちょっとの陽性のサンプルから アノマリーとはどんな物かをそこから 学習するのは、難しいかもしれない。 そしてさらに、 将来起こりうるアノマリーが ここまで見た物と全く似てないかもしれない。 つまりあなたの集めた 陽性のサンプルは、 5とか10とか20種類の相異なる 航空機のエンジンが、どう壊れるかのパターンを示しているかもしれないが、 だが明日にはひょっとすると、 全く新しい、 新種のアノマリーを、 全く新しい航空機エンジンの 故障の仕方で、 まったく見たこと無いような物を 検出する必要がある。 その場合は 単純に陰性のサンプルを モデリングする方が、 ガウス分布のモデルp(x)で モデリングする方が、より筋が良いだろう。 陽性のサンプルを 必死にモデリングするよりも。 何故なら明日の アノマリーはここまで見た物とは まったく似てないかも知れないのだから。 逆に、他の問題で、 十分な陽性のサンプルを 持っていて、アルゴリズムに 陽性のサンプルとはどんな感じか、という感じが掴めそうなら そしてとりわけ、 もし将来現れるであろう陽性のサンプルが トレーニングセットにある物と 似たような物だろうと思われるなら、 その場合には教師有り学習の アルゴリズムを用いる方がより合理的かもしれない。 それはたくさんの陽性のサンプルを見て たくさんの陰性のサンプルを見て、 そしてそれらを用いて 陽性と陰性を見分けようとする物だ。 以上で、もし特定の問題が 目の前にあった時に アノマリー検出のアルゴリズムの使用を 検討すべきか または教師有り学習のアルゴリズムを検討すべきか、だいたいの感じはつかめたかな。 キーとなる重要な違いは アノマリー検出では、 陽性のサンプルが ちょっとしか無いから そんなちょっとの物から学習アルゴリズムが 多くを学ぶなんてそもそも不可能なのだ。 だから代わりにやる事としては、 たくさんの陰性のサンプルを とってきて、それについてたくさん学習し、 p(x)を陰性のサンプルだけから、 例えば正常な航空機エンジンだけから 学習する。 そして少ししかない陽性のサンプルを 我らのアルゴリズムを評価する為に クロスバリデーションセットかテストセットにとっておく。 これらたくさんの異なるアノマリーについて 補足しておくと、 以前のビデオでは eメールのスパムについて 議論した。 それらの例でも、 たくさんの異なる種類のスパムメールが実際にある。 スパムメールは物をあなたに 売りつけようとする物もあるし、スパムメールはあなたのパスワードを盗もうとする場合もある。 これはフィッシングメールと呼ばれる。
他にも様々なスパムメールがある。 だがスパムの問題では、 普通は調べる事が出来る十分な数の スパムが手に入る。 これら異なる種類のほとんどのスパムメールを 入手出来る。何故なら我らは 大量のスパムメールを持ってるからだ。 そしてだからこそ 普通スパムの問題を 教師有り学習の問題とみなすのだ。 たくさんの種類の スパムがあるにも関わらず。 つまり、実際の応用において アノマリー検出と教師有り学習を 比較してみると、 欠陥の検出において、 もし様々な種類の 欠陥とみなしたい物が ありそうなら、 そして相対的に少しのトレーニングセットしか、 詐欺行為をしているユーザーがあなたのwebサイトにはちょっとしかいなければ その時は私はアノマリー検出のアルゴリズムを使うだろう。 つまりこんな時、たとえば あなたがとても大きな オンラインの小売商だったとして、 実際にたくさんの人が 詐欺行為を働こうと しているとする。 つまり実際たくさんの y=1となるサンプルがあるとすると、 そういう場合など、時には詐欺の検出は 現実には教師有り学習へと変化する場合がありうる。 だがもしあなたが あなたのwebサイトにおいて 奇妙な行動に出るユーザーのサンプルが そんなには見られないのなら、 こちらの方がありがちだが、この場合は詐欺検出は アノマリー検出として扱う事になる、 教師有り学習では無く。 他の例でも、製造業については 既に話したが、望ましいのは たくさんの正常なサンプルと そんなに多くないアノマリーを見る、という状態だが、 ある製造工程では もし大量の製造を 行なっていて、 既にたくさんの不良品のサンプルが 見られているなら、その製造も 教師有り学習アルゴリズムに変化しうる。 でも過去の製造結果に そんなにたくさんの不良品のサンプルが 見られていないなら、私だったらこれをアノマリー検出で扱うね。 データセンターでのマシーンのモニタリングでも 同種の議論が 適用出来る。 一方eメールのスパム分類、 天気予報、ガンの分類などでは、 だいたい同等の数の 陽性と陰性のサンプルがあるなら、 陽性と陰性のサンプルを たくさん 得ているなら これら全てを教師有り学習の問題と みなす傾向にある。 以上で問題の どんな性質が それをあなたが アノマリー検出の問題と扱うか、 または教師有り学習の問題と扱うかを 決めているかについて、 感じがつかめただろうか。 様々な技術の会社において、 直面する問題の多くでは、 本当にちょっとの 陽性のサンプルしか無かったり、 時にはゼロ個の 陽性のサンプルしかなかったり、 あまりにもたくさんの種類の まだ見ぬアノマリーが存在したりする。 そういう種類の問題では とてもしばしば 用いられる学習アルゴリズムは アノマリー検出のアルゴリズムだ。