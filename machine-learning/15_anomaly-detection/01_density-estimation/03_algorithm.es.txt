En el último vídeo hablamos acerca de la distribución Gaussiana. En este video aplicaremos eso para desarrollar un algoritmo de detección de anomalías, digamos que tenemos su conjunto de entrenamiento sin valor asignado de "m" ejemplos y cada uno de esos ejemplos será una variable en Rn, de modo que su conjunto de entrenamiento podrían ser vectores de dirección de los últimos motores de aviones "m" fabricados o podrían ser funciones de usuarios "m" o algo más. La forma en que vamos a tratar la detección de anomalías es que vamos a modelar p(x) del conjuntos de datos. Vamos a tratar de averiguar cuáles son las variables alta probabilidad, cuáles son tipos de variables de menor probabilidad. Entonces, "x" es un vector y lo que vamos a hacer es modelar p(x), como probabilidad de x1, que es del primer componente de "x", por la probabilidad de x2 que es la probabilidad de la segunda función por la probabilidad de la tercera variable, y así sucesivamente hasta la probabilidad de la función final de xn. Ahora voy a dejar espacio aquí porque voy a escribir algo en un minuto. Entonces, ¿cómo modelamos cada uno de estos términos, p(x1), p(x2) y así sucesivamente? Lo que haremos será asumir que la función, x1, se distribuye según una distribución Gaussiana, con cierta media, que usted quiere escribir como la letra griega «Mu» 1 y cierta varianza, que escribiré como «sigma» cuadrada 1, entonces p(x1) va a ser una distribución de probabilidad Gaussiana, con "mi 1" media y varianza «sigma» al cuadrado 1. De manera similar, voy a asumir que, x2 es distribuida según el modelo Gaussiano, eso es lo que representa esta pequeña tilde, significa distribución según el modelo Gaussiano con media «Mu» 2 y ««sigma»» al cuadrado, así que se distribuye de acuerdo con una Gaussiana diferente, que tiene un conjunto diferente de parámetros, «Mu» 2, «sigma» al cuadrado2. Y, del mismo modo, ya sabe, x3 es todavía otra Gaussiana, así que esto puede tener una media diferente y una desviación estándar diferente a las otras variables y así sucesivamente, hasta xn. Y ese es mi modelo. Sólo como un comentario para aquellos que son expertos en estadísticas, resulta que esta ecuación que acabo de escribir, en realidad corresponde a una suposición de independencia en los valores de las variables de x 1 a xn. Pero en la práctica resulta que el algoritmo de este fragmento, funciona bien, ya sea que estas variables estén o no en cualquier lugar cerca de la independencia y aunque la suposición de independencia no se mantenga, este algoritmo funciona muy bien. En caso de que no conozca esos términos, sólo usé supuestos de independencia y así sucesivamente, no se preocupe por eso. Usted será capaz de entender e implementar este algoritmo de manera correcta y ese comentario realmente era sólo para los expertos en estadística. Finalmente, con el fin de terminar, permítame tomar esta expresión y escribirla de forma un poco más reducida. Entonces, vamos a escribir que este producto de j=1 a través de "n" de p(xj) parametrizada por "mi j", «sigma» cuadrada "j". Este gracioso símbolo aquí, es la «pi» mayúscula del alfabeto griego, ese símbolo raro allí corresponde a tomar el producto de un conjunto de valores. Y así, se familiariza con la notación sumatoria, así que la suma de "i" igual a 1 a través de n, de "i". Esto significa 1 + 2 + 3 más punto, punto, punto, hasta "n". Donde este símbolo raro aquí, este símbolo de producto, el producto de i=1 a través de "n" de "i".  Entonces esto significa que, es igual a la suma excepto que ahora estamos multiplicando. Esto se convierte en 1 x 2 x3 hasta "n" y al usar esta notación de producto, este producto de j= 1 a trav´´es de "n" de esta expresión es más compacto, esta es una manera más corta de escribir este producto de todos esos términos allá arriba. Puesto que estamos  tomando esta p(xj), dados los términos "mi j", «sigma» cuadrada "j" y los multiplicamos juntos, por cierto, el problema de la estimación de esta distribución p(x), a veces se conoce como el problema de la estimación de la densidad. Por lo tanto, ese es el título de la diapositiva, al reunir todo esto, se forma un algoritmo de detección de anomalías. El primer paso es elegir variables o encontrar variables "xi"que pensamos que pueden ser indicativas de ejemplos anómalos. A lo que me refiero con eso es, tratar de encontrar variables, de modo que cuando haya un usuario inusual en su sistema que puede estar haciendo cosas fraudulentas, o cuando en el ejemplo del motor de avión, ya sabe, hay algo curioso, algo extraño en uno de los motores de avión, elija variables xi, que crea que podrían tomar inusualmente grandes valores, o inusualmente valores pequeños, que den la apariencia de un ejemplo anómalo. De manera más general, sólo trate de elegir las variables que describen las propiedades generales de las cosas sobre las que está recolectando datos. A continuación, dado un sistema de entrenamiento de "m", ejemplos con valores no asignados, x1 a xm, luego ajuste los parámetros, «Mu» 1 a «Mu» n y «sigma» cuadrada 1 a «sigma» cuadrada "n", así que estas fórmulas fueron similares a las fórmulas que teníamos en el video anterior, que íbamos a usar para estimar cada uno de estos parámetros y para dar una interpretación,«Mu» "j" que es mi valor promedio de la variable "j", «Mu» "j" entra en este término p(xj), parametrizado por «Mu» "j" y «sigma» cuadrada "j". Esto indica que "mi j" sólo toma la media sobre mi conjunto de valores de entrenamiento de la variable "j". Y, sólo por mencionar, que hace esto, usted calcula estas fórmulas para j=1 hasta "n". Así que use estas fórmulas para estimar «Mu» 1, para estimar «Mu» 2 y así sucesivamente hasta «Mu» n y de forma similar para  «sigma» cuadrada, y también es es posible inventar versiones vectorizadas de éstos. Así es que si piensa en «Mu» como un vector, entonces, si «Mu» es un vector, tenemos «Mu» 1, «Mu» 2, hasta "mi n" después se puede escribir una versión vectorizada de ese conjunto de parámetros, de este modo, la suma de i=1 por medio de n, x(i). Esta fórmula que acabo de escribir estima esta "xi" como los vectores de dirección que estiman «Mu» para todos los valores de "n" de forma simultánea. También es posible encontrar una fórmula vectorizada para estimar «sigma» cuadrada "j". Por último, cuando le den un nuevo ejemplo, cuando tenga un nuevo motor de avión y quiera saber si el motor de este avión es anómalo, lo que tenemos que hacer es calcular p(x), que es la probabilidad de este nuevo ejemplo. Entonces, p(x) es igual a este producto y lo que usted implementa, lo que calcula es esta fórmula y donde, esto de aquí es sólo la fórmula para la probabilidad Gaussiana, así usted calcular esto y finalmente si esta probabilidad es muy pequeña, entonces marca esto como una anomalía. Aquí hay un ejemplo de una aplicación de este método. Digamos que tenemos este conjunto de datos trazado en la parte superior izquierda de esta diapositiva, si se fija, bueno, vamos a ver la función de x1. si observa este grupo de datos, parece que en promedio, las variables x1 tienen una media de aproximadamente 5 y la desviación estándar, si sólo mira los valores de x1 de este conjunto de datos tiene una desviación estándar de quizá 2. Así que esa es «sigma» 1, parece que x2, ya sabe, los valores de las las variables, tal como se miden en el eje vertical, pareciera que tiene un valor promedio de aproximadamente 3, y una desviación estándar de aproximadamente 1. Si toma este conjunto de datos y si estima "mi 1", mi 2", «sigma» 1, «sigma» 2 esto es lo que obtiene. Y otra vez, estoy escribiendo «sigma» aquí, estoy pensando en desviaciones estándar, pero la fórmula de la diapositiva anterior, en realidad dio las estimaciones de los cuadrados de las cosas: «sigma» cuadrada 1 y «sigma» cuadrada 2. Sólo tenga cuidado si está usando «sigma» 1, «sigma» 2, «sigma» cuadrada 1 o «sigma» cuadrada 2. Entonces, «sigma» cuadrada 1, por supuesto, sería igual a 4, por ejemplo, como el cuadrado de 2. En imágenes se muestra que p(x1) parametrizada por «Mu» 1  y «sigma» al cuadrado 1, y p(x2) parametrizada por «Mu» 2 y «sigma» cuadrada 2, luciría como estas dos distribuciones aquí. Resulta que si tuviéramos que trazar p(x), ¿no?, que es el producto de estas dos cosas, en realidad puede obtener un gráfico de superficie que tiene este aspecto. Este es un trazo de p(x) donde la altura por encima de este, donde la altura de esta superficie en un punto particular, dados los valores en particular de x1, x2 de x2, si x1 es igual a 2, x igual a 2, ese es este punto y la altura de esta superficie 3D esa es p(x). Así que p(x), que es la altura de este diagrama, es literalmente p(x1) parametrizada por «Mu»12, «sigma» al cuadrado 1, por p(x2) parametrizada por «Mu» 2 «sigma» cuadrada 2. Ahora, así es como ajustamos los parámetros a estos datos. Vamos a ver si tenemos un par de ejemplos nuevos, tal vez tengo un nuevo ejemplo aquí, ¿se tratará de una anomalía o no? o, tal vez tenga un ejemplo distinto, quizá tenga un segundo ejemplo diferente allí. Entonces, ¿es una anomalía o no? La forma en que hacemos esto, es que estableceríamos un valor para «épsilon», vamos decir que he elegido «épsilon»= 0.02. Diré más adelante cómo elegimos «épsilon» pero vamos a tomar este primer ejemplo, déjeme nombrar esto como ejemplo "x1 prueba" y nombraré al segundo ejemplo como "x2 prueba" Lo que hacemos es calcular p(x1) de "x1 prueba", así que utilizamos esta fórmula para calcularlo y esto parece un valor muy grande. En particular, esto es mayor o igual a «épsilon» y entonces esta es una muy alta probabilidad, al menos más grande que «épsilon», entonces diremos "x1 prueba" no es una anomalía. Considerando que, si usted calcula p(x2 prueba) bueno, es sólo un valor mucho menor. Entonces si esto es menor a épsilon, diremos que de hecho si es una anomalía porque es mucho menor a «épsilon» que elegimos. Y de hecho, podría mejorarlo aquí, lo que realmente muestra esto es que, si se fija en el diagrama de superficie 3D, está indicando que todos los valores de x1 y x2 que tienen una gran altura por encima de la superficie, corresponden a un ejemplo no anómalo, a un ejemplo correcto o normal. Mientras que todos los puntos lejos de aquí, todos los puntos fuera tienen una probabilidad muy baja, entonces vamos a marcar esos puntos como anómalos, y así se va a definir alguna region, que tal vez se vea así, de modo que todo lo que está fuera de esto, lo marca como anómalo, mientras que las cosas dentro de esta elipse que acabo de dibujar, se consideran ejemplos normales, no anómalos o no anormales. Entonces este ejemplo de "x2 prueba" está fuera de esa región, por lo que tiene una probabilidad muy pequeña, entonces lo consideramos un ejemplo anómalo. En este vídeo hablamos acerca de cómo estimar p(x), la probabilidad de x, con el propósito de desarrollar un algoritmo de detección de anomalías. En este vídeo también nos adentramos en un proceso completo para obtener conjuntos de datos, estuvimos ajustando los parámetros, haciendo cálculos de parámetros. Obtuvimos los parámetros «Mu» y «sigma», y tomamos nuevos ejemplos para decidir si los nuevos ejemplos eran anómalos o no. En los próximos videos seguiremos profundizando en este algoritmo y hablaré un poco más acerca de cómo hacer que en realidad funcione bien.