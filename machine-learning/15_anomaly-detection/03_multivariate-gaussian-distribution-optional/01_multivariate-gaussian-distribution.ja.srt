1
00:00:00,500 --> 00:00:01,550
このビデオとこの次のビデオで、

2
00:00:02,040 --> 00:00:03,470
ここまでに開発してきたアノマリー検出のアルゴリズムの

3
00:00:03,760 --> 00:00:05,880
考えられる一つの拡張を

4
00:00:06,140 --> 00:00:08,270
お話しよう。

5
00:00:09,020 --> 00:00:11,970
この拡張は、多変量ガウス分布と

6
00:00:12,100 --> 00:00:13,480
呼ばれる物を使う。

7
00:00:13,770 --> 00:00:14,970
そしてそれはある長所があり、

8
00:00:15,160 --> 00:00:16,790
そしてある短所もある。

9
00:00:17,070 --> 00:00:20,610
そしてそれは、前のアルゴリズムで捉えられなかったアノマリーを検出出来る事がある。

10
00:00:21,740 --> 00:00:23,730
この動機付けを理解する為に、具体例から始めよう。

11
00:00:25,620 --> 00:00:28,410
ここにプロットしたようなラベル無しデータがあるとする。

12
00:00:29,060 --> 00:00:30,190
そしてデータセンターの

13
00:00:30,340 --> 00:00:32,320
マシンのモニタリングの例を

14
00:00:32,890 --> 00:00:34,890
使っていく事にする。
データセンターのコンピュータをモニタリングする。

15
00:00:35,290 --> 00:00:36,170
つまり私の二つのフィーチャーは

16
00:00:36,220 --> 00:00:37,070
x1がCPUロードで、

17
00:00:37,250 --> 00:00:39,280
x2が例えばメモリの使用量。

18
00:00:41,160 --> 00:00:42,160
そこで二つのフィーチャー、

19
00:00:42,340 --> 00:00:43,330
x1とx2に対して、

20
00:00:43,580 --> 00:00:45,960
ガウス分布でモデリングすると、

21
00:00:46,200 --> 00:00:47,430
これがx1フィーチャーによる

22
00:00:47,610 --> 00:00:49,040
プロットで、

23
00:00:49,210 --> 00:00:50,370
これがx2フィーチャーによるプロットだ。

24
00:00:50,980 --> 00:00:51,880
ここにガウス分布を

25
00:00:51,910 --> 00:00:52,640
フィッティングすると、

26
00:00:52,760 --> 00:00:56,050
こんな感じのガウス分布が得られるだろう。

27
00:00:56,730 --> 00:00:57,750
これがp(x1)で、

28
00:00:57,860 --> 00:01:00,350
これはパラメータの

29
00:01:00,690 --> 00:01:02,130
ミュー1とシグマ1に

30
00:01:02,440 --> 00:01:04,740
依存している。

31
00:01:04,880 --> 00:01:06,120
そしてこれがメモリ使用量、

32
00:01:06,240 --> 00:01:07,020
そのガウス分布は例えば

33
00:01:07,560 --> 00:01:09,910
こんな感じ。これがp(x2)で、

34
00:01:10,760 --> 00:01:12,500
それはミュー2とシグマ二乗2に依存する。

35
00:01:12,590 --> 00:01:14,660
さて、以上が

36
00:01:14,870 --> 00:01:16,340
アノマリー検出のアルゴリズムが

37
00:01:16,790 --> 00:01:17,850
x1とx2をモデリングする方法だ。

38
00:01:19,900 --> 00:01:21,160
ここで、テストセットに

39
00:01:21,260 --> 00:01:22,330
こんな手本が

40
00:01:22,410 --> 00:01:24,010
あったとする。

41
00:01:25,540 --> 00:01:26,600
この緑のバッテンの位置、

42
00:01:27,310 --> 00:01:29,160
つまりx1の値がだいたい0.4で、

43
00:01:29,360 --> 00:01:31,220
x2の値がだいたい1.5くらいの位置。

44
00:01:31,300 --> 00:01:34,430
今、データを見てみると、

45
00:01:34,660 --> 00:01:35,780
ぱっと見た感じ

46
00:01:35,960 --> 00:01:36,780
多くのデータは

47
00:01:37,140 --> 00:01:38,800
この範囲に存在しているので、

48
00:01:38,940 --> 00:01:40,400
この緑のバッテンは

49
00:01:41,110 --> 00:01:43,510
観測されているデータのどれとも、かなり離れている。

50
00:01:43,840 --> 00:01:44,870
これはアノマリーとして

51
00:01:45,210 --> 00:01:46,790
提起されるべきに見える。

52
00:01:46,970 --> 00:01:48,660
つまり、私のデータにおいては、

53
00:01:48,790 --> 00:01:49,930
私の正常な手本のデータでは、

54
00:01:50,320 --> 00:01:51,430
CPUロードと

55
00:01:51,510 --> 00:01:52,680
メモリ使用量は、

56
00:01:52,770 --> 00:01:54,330
お互いに線形に

57
00:01:54,680 --> 00:01:56,100
上昇する傾向にあるように見える。

58
00:01:56,560 --> 00:01:57,720
つまり、たくさんのCPUを

59
00:01:57,940 --> 00:01:59,000
使っているマシンがあれば、

60
00:01:59,150 --> 00:02:00,460
そのマシンのメモリ使用量もおそらく高い。

61
00:02:00,830 --> 00:02:02,930
一方でこの例、

62
00:02:03,320 --> 00:02:05,910
この緑の例では、

63
00:02:06,040 --> 00:02:07,140
CPUロードはとても低いが、

64
00:02:07,280 --> 00:02:08,280
メモリ使用量は

65
00:02:08,490 --> 00:02:09,310
とても高い。

66
00:02:09,430 --> 00:02:10,820
こんな物はトレーニングセットでは見られなかった物だ。

67
00:02:10,980 --> 00:02:12,150
これはアノマリーだとみなすべきだろう。

68
00:02:13,190 --> 00:02:15,300
だが、アノマリー検出のアルゴリズムが何をするか、見てみよう。

69
00:02:15,570 --> 00:02:16,750
CPUロードに関しては、

70
00:02:16,850 --> 00:02:17,990
だいたいこの辺となる、0.5とか。

71
00:02:18,280 --> 00:02:20,700
これはリーズナブルに高い確率の範囲で、

72
00:02:20,900 --> 00:02:21,910
これまで見た手本の集団から

73
00:02:22,120 --> 00:02:23,350
それ程離れた場所では無い。

74
00:02:23,650 --> 00:02:25,230
一方、メモリ使用量に関しては、

75
00:02:26,160 --> 00:02:28,320
ここの点は0.5のあたりだが、

76
00:02:29,030 --> 00:02:29,900
一方でメモリ使用量は、

77
00:02:30,030 --> 00:02:32,340
1.5くらいで、それはここ。

78
00:02:32,680 --> 00:02:34,600
これもまた、

79
00:02:34,730 --> 00:02:35,850
ガウス分布の尻尾の方ではあるが、

80
00:02:35,980 --> 00:02:37,310
でもこの値とこの値は、観測されている

81
00:02:37,550 --> 00:02:38,830
その他のたくさんの手本と比べても、

82
00:02:39,210 --> 00:02:41,180
そんなに違う物では無い。

83
00:02:41,430 --> 00:02:43,020
つまりp(x1)は

84
00:02:43,210 --> 00:02:44,530
かなり大きくなる、

85
00:02:45,550 --> 00:02:46,030
リーズナブルな程度には大きくなるだろうし、

86
00:02:46,290 --> 00:02:47,730
p(x2)もリーズナブルな程度には大きい。

87
00:02:47,980 --> 00:02:49,030
つまり、この右側のプロットを見ると、

88
00:02:49,910 --> 00:02:51,230
この、ここの点は、

89
00:02:51,410 --> 00:02:52,530
そんなに悪くは見えないし、

90
00:02:52,830 --> 00:02:54,440
そしてこのプロットを見ると

91
00:02:54,720 --> 00:02:56,690
ここのバッテンを見ると、そんなに悪くも見えない。

92
00:02:57,050 --> 00:02:58,780
つまり、もっとメモリ使用量が多い手本も

93
00:02:58,980 --> 00:03:00,730
ある訳だし、また、

94
00:03:01,030 --> 00:03:02,270
もっと少ないCPU使用量の手本もある。

95
00:03:02,860 --> 00:03:04,780
つまり、この手本はそんなにアノマリーっぽくは見えない。

96
00:03:05,940 --> 00:03:07,380
つまり、アノマリー検出のアルゴリズムは

97
00:03:07,680 --> 00:03:10,090
この点をアノマリーだとフラグ付けするのに失敗するだろう。

98
00:03:10,550 --> 00:03:12,220
我らのアノマリー検出のアルゴリズムが

99
00:03:12,360 --> 00:03:13,610
やっている事は、

100
00:03:13,880 --> 00:03:15,070
結局の所、

101
00:03:15,200 --> 00:03:16,700
この青い楕円が

102
00:03:16,900 --> 00:03:18,060
高い確率の範囲を示しているという事を

103
00:03:18,210 --> 00:03:19,380
認識していないで、

104
00:03:19,490 --> 00:03:21,290
ここの手本が、高い確率だと

105
00:03:21,720 --> 00:03:23,430
考える。

106
00:03:23,680 --> 00:03:24,980
そしてこの隣の円は、

107
00:03:26,170 --> 00:03:27,280
一段低い確率となり、

108
00:03:27,370 --> 00:03:28,950
そしてここの手本は、

109
00:03:29,220 --> 00:03:31,040
さらに低い確率となり、そして、

110
00:03:31,150 --> 00:03:32,070
ここの緑のバッテンは、

111
00:03:32,420 --> 00:03:33,430
かなり高い確率となってしまう。

112
00:03:34,490 --> 00:03:35,510
そして具体的には、

113
00:03:35,990 --> 00:03:37,740
この領域は全て、

114
00:03:38,000 --> 00:03:40,400
私が円でくくってる直線上の点は全て、

115
00:03:40,580 --> 00:03:43,390
だいたい同じ確率だ、と考える。

116
00:03:44,160 --> 00:03:45,810
そして、この辺の外れた何かは

117
00:03:46,790 --> 00:03:50,910
実際にはこの辺よりは

118
00:03:51,080 --> 00:03:53,130
もっと低い確率だ、という事を認識出来ていない。

119
00:03:55,060 --> 00:03:56,080
そこで、これを修正する為に、

120
00:03:56,270 --> 00:03:57,300
修正版のアノマリー検出の

121
00:03:57,580 --> 00:03:58,930
アルゴリズムを

122
00:03:58,990 --> 00:04:01,030
開発していこう、

123
00:04:01,430 --> 00:04:02,520
多変量ガウス分布とか、多変量正規分布と

124
00:04:02,580 --> 00:04:05,880
呼ばれる物を用いて。

125
00:04:07,330 --> 00:04:08,120
これが、我らがやる事だ。

126
00:04:08,810 --> 00:04:10,270
我らはフィーチャーとして

127
00:04:10,470 --> 00:04:11,680
Rnのxを持つ。

128
00:04:11,910 --> 00:04:14,180
p(x1), p(x2)と別々にする代わりに、

129
00:04:14,570 --> 00:04:15,630
p(x)、という風に

130
00:04:15,800 --> 00:04:16,840
全部をいっぺんにモデリングする。

131
00:04:17,010 --> 00:04:18,970
つまり全部を一度に、p(x)をモデリングする。

132
00:04:20,300 --> 00:04:21,550
さて、多変量ガウス分布の

133
00:04:21,830 --> 00:04:24,140
パラメータとしては、まずミュー、

134
00:04:24,630 --> 00:04:25,770
これはベクトル。そしてシグマ、

135
00:04:26,490 --> 00:04:28,450
これはn掛けるn行列で、共分散行列とも呼ばれる。

136
00:04:29,640 --> 00:04:30,870
そしてこれはPCAの時に

137
00:04:31,010 --> 00:04:32,220
使った共分散行列と

138
00:04:32,430 --> 00:04:33,560
同様の物だ。

139
00:04:34,080 --> 00:04:35,200
主成分分析の

140
00:04:35,280 --> 00:04:36,700
アルゴリズムの時の。

141
00:04:37,860 --> 00:04:38,970
だが完全を期して、

142
00:04:39,070 --> 00:04:39,880
多変量ガウス分布の式を

143
00:04:40,930 --> 00:04:42,390
書いてみよう。

144
00:04:42,820 --> 00:04:44,030
さて、xの確率は、

145
00:04:44,140 --> 00:04:45,100
パラメータのミューとシグマで

146
00:04:46,090 --> 00:04:47,500
パラメトライズされていて、

147
00:04:47,640 --> 00:04:49,280
そのxの確率は

148
00:04:49,360 --> 00:04:50,100
イコール、

149
00:04:50,430 --> 00:04:52,260
もう一度言うが、この式を暗記する必要は

150
00:04:52,580 --> 00:04:54,810
まったく、これっぽっちも無い。

151
00:04:56,030 --> 00:04:56,780
使う必要がある時に

152
00:04:57,010 --> 00:04:58,160
調べれば十分だ。

153
00:04:58,340 --> 00:04:59,130
だがこれが、xの確率が

154
00:04:59,690 --> 00:05:01,230
どうなるか、だ。

155
00:05:03,000 --> 00:05:04,680
ふんふん、転置の、シグマの逆行列に、

156
00:05:05,220 --> 00:05:06,300
x マイナスの ミュー。

157
00:05:07,400 --> 00:05:08,850
そしてここのこれ、

158
00:05:10,390 --> 00:05:11,510
シグマの絶対値、

159
00:05:11,680 --> 00:05:13,140
ここのこれ、

160
00:05:13,410 --> 00:05:14,430
この記号を書くと、

161
00:05:14,600 --> 00:05:17,220
これはシグマの行列式(determinant)と呼ばれる物で、

162
00:05:18,150 --> 00:05:19,620
これは行列に対する、数学的な関数だ。

163
00:05:20,210 --> 00:05:21,740
そしてあなたは、行列の行列式が何かを

164
00:05:21,960 --> 00:05:22,820
実際にしっている必要は

165
00:05:23,240 --> 00:05:24,250
全くない。

166
00:05:24,780 --> 00:05:25,770
あなたが実際に

167
00:05:25,860 --> 00:05:27,180
知る必要があるのは、

168
00:05:27,320 --> 00:05:29,380
それをOctaveで計算するには

169
00:05:29,760 --> 00:05:31,820
コマンドdet(Sigma)を使う、

170
00:05:33,570 --> 00:05:33,570
という事だけだ。

171
00:05:34,010 --> 00:05:36,210
よし。もう一度確認しておこう。

172
00:05:36,300 --> 00:05:38,240
この式において、これらのシグマ、

173
00:05:38,730 --> 00:05:41,250
これらは単なるn掛けるn行列だ。

174
00:05:41,850 --> 00:05:43,150
これは和の記号じゃない。

175
00:05:43,260 --> 00:05:45,680
そしてこのシグマは、n掛けるn行列。

176
00:05:46,710 --> 00:05:47,780
さて、以上がp(x)の式だ。

177
00:05:48,010 --> 00:05:50,500
だが、もっと興味深い事としては、

178
00:05:50,820 --> 00:05:52,030
あるいはもっと重要な事としては、

179
00:05:53,940 --> 00:05:55,610
p(x)は実際に、どんな感じになるのだろうか？

180
00:05:56,190 --> 00:05:57,450
多変量のガウス分布の例を

181
00:05:58,020 --> 00:06:00,690
幾つか見ていこう。

182
00:06:02,350 --> 00:06:03,380
さて、二次元の例を

183
00:06:03,500 --> 00:06:04,700
考えよう。

184
00:06:04,820 --> 00:06:06,550
n=2なら、

185
00:06:06,710 --> 00:06:08,160
二つのフィーチャー、x1とx2を持つ。

186
00:06:09,250 --> 00:06:10,540
ミューをイコール0に

187
00:06:10,650 --> 00:06:11,800
セットして、

188
00:06:12,330 --> 00:06:14,030
シグマをこの行列としよう。

189
00:06:14,200 --> 00:06:16,710
対角成分が1で、非対角成分が0。

190
00:06:17,600 --> 00:06:19,980
この行列はまた、単位行列と呼ばれる事もある。

191
00:06:21,350 --> 00:06:22,470
この場合、pのxは

192
00:06:22,590 --> 00:06:24,950
こんな見た目となる。

193
00:06:25,240 --> 00:06:27,430
そしてこの図で

194
00:06:27,600 --> 00:06:29,380
私が示しているのは、

195
00:06:29,500 --> 00:06:30,900
ある特定のx1の値と

196
00:06:31,240 --> 00:06:32,860
ある特定のx2の値の時に、

197
00:06:32,970 --> 00:06:34,680
この表面の高さ、

198
00:06:34,810 --> 00:06:36,470
これがpのxの値だ。

199
00:06:36,970 --> 00:06:38,330
そしてこのパラメータの

200
00:06:38,470 --> 00:06:39,520
設定では、

201
00:06:40,610 --> 00:06:42,100
x1とx2がイコール0の時

202
00:06:42,300 --> 00:06:43,620
もっとも高くなる、

203
00:06:44,010 --> 00:06:45,710
つまりそこがガウス分布のピークとなり、

204
00:06:46,950 --> 00:06:48,760
そして確率分布は、

205
00:06:48,970 --> 00:06:51,330
こんな感じの二次元ガウス分布として、

206
00:06:51,510 --> 00:06:53,590
あるいはこの二次元のベル型の平面として減衰していく。

207
00:06:55,080 --> 00:06:56,400
この下には、同じ事を

208
00:06:56,610 --> 00:06:58,230
代わりに等高線プロットを用いて

209
00:06:58,330 --> 00:07:00,970
プロットしてみた、等高線は様々な色を使う事で表現される。

210
00:07:01,150 --> 00:07:02,020
つまりこの真中の、

211
00:07:02,530 --> 00:07:04,210
赤が激しく集中している所は、

212
00:07:04,280 --> 00:07:06,260
もっとも高い値に対応している。

213
00:07:06,850 --> 00:07:08,230
そして黄色くなっている所は

214
00:07:08,790 --> 00:07:10,470
値がもうちょっと低くなっている所で、

215
00:07:10,700 --> 00:07:11,830
シアン色になってる所は

216
00:07:12,060 --> 00:07:13,230
さらに値が低くなっている所で、

217
00:07:14,000 --> 00:07:15,440
そしてこの深い青は、もっとも低い値となっている所だ。

218
00:07:15,450 --> 00:07:17,010
つまり、全く同じ図を

219
00:07:17,240 --> 00:07:19,410
真上から見て、色を使ってプロットした物となっている。

220
00:07:21,390 --> 00:07:22,510
さて、この分布では、

221
00:07:23,830 --> 00:07:25,010
確率の大半は

222
00:07:25,300 --> 00:07:27,440
0,0のそばにあり、

223
00:07:27,600 --> 00:07:28,630
そして0, 0から外に出て行くと、

224
00:07:28,710 --> 00:07:32,450
x1とx2の確率は下がっていく。

225
00:07:36,000 --> 00:07:37,220
ここでパラメータの幾つかを

226
00:07:37,310 --> 00:07:38,630
変更していき、

227
00:07:38,770 --> 00:07:40,150
何が起こるか見ていこう。

228
00:07:40,940 --> 00:07:42,420
シグマを変えてみよう。

229
00:07:42,590 --> 00:07:44,720
シグマをちょっと縮めてみよう。

230
00:07:44,870 --> 00:07:46,350
シグマは

231
00:07:46,580 --> 00:07:47,710
共分散行列なので、

232
00:07:47,820 --> 00:07:49,030
フィーチャーx1, x2の分散、または

233
00:07:49,120 --> 00:07:50,640
変わりやすさを測った物だ。

234
00:07:50,720 --> 00:07:52,080
だからシグマを縮めると、

235
00:07:52,400 --> 00:07:53,430
得られるのは、、、

236
00:07:53,780 --> 00:07:54,290
得られるのは、

237
00:07:54,400 --> 00:07:56,320
このコブの幅が減少し、

238
00:07:57,760 --> 00:07:59,310
高さもちょっとだけ

239
00:07:59,550 --> 00:08:00,620
増加する。何故なら、

240
00:08:01,090 --> 00:08:03,080
平面の下の体積は1だから。

241
00:08:03,130 --> 00:08:04,400
つまり平面の下の体積の

242
00:08:04,950 --> 00:08:06,230
積分結果は、イコール1だ。

243
00:08:06,580 --> 00:08:08,000
何故なら確率分布の積分は

244
00:08:08,690 --> 00:08:10,080
1にならなくてはいけないから。

245
00:08:10,800 --> 00:08:11,650
だがもし分散を縮めると、

246
00:08:12,660 --> 00:08:14,290
それはシグマ二乗を

247
00:08:14,810 --> 00:08:15,870
縮める事に相当し、

248
00:08:16,740 --> 00:08:20,080
より狭い分布が得られる、そしてその背の高さはちょっとだけ高くなる。

249
00:08:20,860 --> 00:08:22,150
そして見て分かるように、

250
00:08:22,580 --> 00:08:27,200
同心の楕円もちょっとだけ縮む。

251
00:08:27,340 --> 00:08:28,730
一方で、対照的に、もしシグマの対角成分を

252
00:08:29,770 --> 00:08:31,000
2, 2に増加させると、

253
00:08:31,110 --> 00:08:32,020
するとこれは単位行列の2倍となり、

254
00:08:32,220 --> 00:08:34,370
もっと幅広くて、もっと平坦な

255
00:08:34,510 --> 00:08:35,880
ガウス分布が得られる。

256
00:08:36,150 --> 00:08:38,190
つまり、この幅はもっと広くなる。

257
00:08:38,930 --> 00:08:39,800
これは見づらいが、

258
00:08:40,020 --> 00:08:41,090
これもまだベル型のコブになっていて、

259
00:08:41,210 --> 00:08:42,540
ただ凄い平坦になっているだけだ、

260
00:08:42,620 --> 00:08:44,470
それはより幅広くなった、

261
00:08:44,590 --> 00:08:45,720
つまり、x1とx2の分散、あるいは変わりやすさは

262
00:08:45,830 --> 00:08:48,690
単により広くなった。

263
00:08:50,520 --> 00:08:50,980
もうちょっと例を挙げておこう。

264
00:08:51,670 --> 00:08:53,930
今度は、一度にシグマの要素の一方だけを

265
00:08:54,070 --> 00:08:55,490
変更していこう。

266
00:08:55,840 --> 00:08:58,080
シグマのこっちを0.6に

267
00:08:58,140 --> 00:09:00,020
こっちを1にしてみよう。

268
00:09:01,340 --> 00:09:02,380
こうすると、

269
00:09:02,610 --> 00:09:04,240
最初のフィーチャーx1の

270
00:09:05,780 --> 00:09:06,960
分散が減少し、同時に

271
00:09:07,770 --> 00:09:08,890
フィーチャーx2の分散は

272
00:09:08,960 --> 00:09:11,530
同一に保たれている。

273
00:09:12,160 --> 00:09:15,150
すると、このパラメータの設定では、こんな物をモデリング出来る。

274
00:09:15,670 --> 00:09:16,910
x1はより小さな分散となり、

275
00:09:17,580 --> 00:09:19,120
x2はより大きな分散となる。

276
00:09:20,080 --> 00:09:20,800
他方、もし私が

277
00:09:21,120 --> 00:09:22,900
この行列、2, 1を

278
00:09:23,090 --> 00:09:24,390
セットすると、

279
00:09:24,560 --> 00:09:25,900
今度は以下のような手本を

280
00:09:26,230 --> 00:09:27,470
モデリングする事が出来る。それは

281
00:09:28,850 --> 00:09:30,590
x1が広い範囲の

282
00:09:30,830 --> 00:09:31,930
値をとり、

283
00:09:32,220 --> 00:09:34,870
一方x2は相対的に狭い範囲の値を、取る、というような。

284
00:09:35,070 --> 00:09:37,060
そしてその事は、この図にも

285
00:09:37,270 --> 00:09:38,040
反映されている。ここでは、

286
00:09:38,750 --> 00:09:40,530
分布はx1から離れるに連れて

287
00:09:40,830 --> 00:09:42,670
よりゆっくりと

288
00:09:42,820 --> 00:09:43,940
減衰していて、

289
00:09:44,180 --> 00:09:45,380
そしてx2が0から離れると

290
00:09:45,640 --> 00:09:48,080
急激に減衰している。

291
00:09:49,190 --> 00:09:50,710
そして同様に、

292
00:09:50,800 --> 00:09:52,320
代わりに

293
00:09:53,010 --> 00:09:54,490
行列のこの要素を変更すると、

294
00:09:54,660 --> 00:09:55,570
前のスライドと似ているが、

295
00:09:57,390 --> 00:09:58,860
違いとしては、

296
00:09:59,450 --> 00:10:00,900
ここでいじっている所は、

297
00:10:01,240 --> 00:10:03,010
x2がとても小さい範囲の

298
00:10:03,170 --> 00:10:04,460
値をとるようになるという事で、

299
00:10:05,190 --> 00:10:06,840
つまりここでは、

300
00:10:07,200 --> 00:10:08,740
これが0.6だと、

301
00:10:09,810 --> 00:10:10,610
x2がオリジナルの例よりも

302
00:10:10,760 --> 00:10:12,930
より小さな範囲を取るようになるという事に気づく。

303
00:10:14,010 --> 00:10:15,310
一方で、もしシグマを

304
00:10:15,680 --> 00:10:17,320
イコール2にセットしたら、

305
00:10:17,410 --> 00:10:20,580
それはx2がもっと幅広い範囲の値を取る、という事だ。

306
00:10:22,780 --> 00:10:23,570
ここで、多変量ガウス分布の

307
00:10:23,880 --> 00:10:24,950
クールな事の一つには、

308
00:10:25,190 --> 00:10:26,690
データ同士の相関を

309
00:10:26,880 --> 00:10:28,050
モデリングするのに

310
00:10:28,330 --> 00:10:30,230
使う事が出来る、という事がある。

311
00:10:30,410 --> 00:10:31,930
つまり、多変量ガウス分布を用いて、

312
00:10:32,060 --> 00:10:33,510
例えばx1とx2が

313
00:10:33,610 --> 00:10:34,940
互いに高く相関する傾向にある、という事実を

314
00:10:35,070 --> 00:10:36,760
モデリング出来る。

315
00:10:37,640 --> 00:10:38,880
具体的には、

316
00:10:39,540 --> 00:10:40,720
この共分散行列の

317
00:10:41,340 --> 00:10:42,390
非対角成分を変更する事で、

318
00:10:42,950 --> 00:10:45,250
異なる種類のガウス分布を得る事が出来る。

319
00:10:46,610 --> 00:10:48,250
つまり、

320
00:10:48,340 --> 00:10:49,590
非対角成分の要素を0.5から0.8に

321
00:10:50,090 --> 00:10:51,300
増加させると、

322
00:10:51,580 --> 00:10:53,080
この分布が得られる。

323
00:10:53,380 --> 00:10:54,590
これはこの、x=yの直線に沿った

324
00:10:55,100 --> 00:10:57,480
より狭い範囲に山があるような分布。

325
00:10:57,700 --> 00:10:59,100
つまり、ここの等高線は、

326
00:10:59,160 --> 00:11:00,610
xとyがともに増加する傾向にある、

327
00:11:00,730 --> 00:11:03,010
と主張していて、

328
00:11:03,290 --> 00:11:04,500
x1が大きくてx2も大きい、という時と

329
00:11:04,640 --> 00:11:06,550
x1が小さくてx2も小さい、

330
00:11:06,790 --> 00:11:08,140
という時は

331
00:11:08,260 --> 00:11:09,560
大きな確率と

332
00:11:09,890 --> 00:11:11,160
なっている。

333
00:11:11,490 --> 00:11:12,480
あるいはその両者の間も高い確率となっている。

334
00:11:13,110 --> 00:11:14,700
そしてこの要素、0.8が

335
00:11:15,130 --> 00:11:16,280
大きくなると、

336
00:11:16,490 --> 00:11:18,410
この種の狭い領域に

337
00:11:18,660 --> 00:11:20,570
全ての確率が存在するような

338
00:11:20,770 --> 00:11:22,870
ガウス分布が得られ、

339
00:11:24,350 --> 00:11:26,200
xはだいたいイコールyとなる。

340
00:11:26,420 --> 00:11:27,530
これはとても背が高く、

341
00:11:28,020 --> 00:11:30,290
薄い分布で、

342
00:11:30,670 --> 00:11:32,570
だいたいこの直線に沿った、

343
00:11:33,860 --> 00:11:34,940
xがyと近い領域を中心とした

344
00:11:35,010 --> 00:11:36,860
直線に沿った。

345
00:11:37,130 --> 00:11:38,350
以上が、これらの要素を

346
00:11:38,810 --> 00:11:40,360
正に設定した時だ。

347
00:11:40,970 --> 00:11:42,120
逆に、もしこれらの値を

348
00:11:42,460 --> 00:11:43,530
負の値にセットすると、

349
00:11:44,350 --> 00:11:46,340
これを-0.5から-0.8まで

350
00:11:46,380 --> 00:11:47,920
減少させていくと、

351
00:11:48,060 --> 00:11:49,360
以下のようなモデルが得られる：

352
00:11:49,870 --> 00:11:50,930
確率の多くを

353
00:11:51,620 --> 00:11:53,930
いわゆるx1とx2が負の相関となっている範囲に

354
00:11:54,010 --> 00:11:55,420
置くようなモデル。

355
00:11:55,710 --> 00:11:57,330
つまり、確率のほとんどが、

356
00:11:57,480 --> 00:11:58,420
今度はこの範囲に存在し、

357
00:11:58,810 --> 00:11:59,910
そこはx1がだいたいイコール -x2

358
00:12:00,190 --> 00:12:01,700
となっている、x1 = x2の

359
00:12:01,890 --> 00:12:03,370
代わりに。

360
00:12:04,180 --> 00:12:05,460
つまり、これは、いわゆる

361
00:12:05,610 --> 00:12:08,050
x1とx2の間の負の相関を

362
00:12:10,300 --> 00:12:10,650
捉えている。

363
00:12:11,010 --> 00:12:12,550
以上で、

364
00:12:12,750 --> 00:12:13,640
あなたも多変量ガウス分布が

365
00:12:13,750 --> 00:12:15,230
捉える事が出来る、様々な分布が、

366
00:12:15,650 --> 00:12:17,400
感覚的につかめただろうか。

367
00:12:18,680 --> 00:12:20,430
ここまでの所、我らは

368
00:12:20,730 --> 00:12:22,200
共分散行列のシグマを変化させてきたが、

369
00:12:22,910 --> 00:12:23,880
他にも出来る事として、

370
00:12:24,030 --> 00:12:26,090
平均のパラメータ、ミューを

371
00:12:26,300 --> 00:12:27,730
変えていく、という事がある。

372
00:12:28,370 --> 00:12:29,740
もともとは、ミューはイコール

373
00:12:30,270 --> 00:12:31,190
0, 0だった。

374
00:12:31,250 --> 00:12:32,820
つまり分布はx1=0とx2=0を

375
00:12:33,270 --> 00:12:34,650
中心として分布していた。

376
00:12:35,050 --> 00:12:35,980
つまり分布のピークは

377
00:12:36,070 --> 00:12:38,530
ここだ。

378
00:12:38,950 --> 00:12:40,430
一方、ミューの値を変えていくと、

379
00:12:40,610 --> 00:12:42,120
分布のピークが

380
00:12:42,360 --> 00:12:43,700
変わっていって、

381
00:12:43,910 --> 00:12:45,770
もしミューがイコール、 0, 0.5なら、

382
00:12:45,920 --> 00:12:47,100
ピークはちょうど

383
00:12:47,270 --> 00:12:49,470
x1=0でx2=0.5の所にあり、

384
00:12:49,810 --> 00:12:51,430
つまり分布の

385
00:12:51,980 --> 00:12:53,400
ピーク、あるいは中心は、

386
00:12:53,710 --> 00:12:55,260
シフトする。

387
00:12:56,470 --> 00:12:57,770
そしてもしミューが1.5, -0.5なら、

388
00:12:58,340 --> 00:13:00,050
ふたたび同様に、

389
00:13:01,170 --> 00:13:03,350
分布のピークは

390
00:13:03,890 --> 00:13:05,490
今度は別の場所に

391
00:13:05,620 --> 00:13:06,750
シフトする。

392
00:13:07,670 --> 00:13:09,710
そこはx1が1.5で、

393
00:13:09,910 --> 00:13:11,020
x2が-0.5の点に

394
00:13:11,350 --> 00:13:12,710
対応した場所。

395
00:13:13,290 --> 00:13:15,180
つまり、ミューのパラメータを変えていく事で、

396
00:13:15,730 --> 00:13:17,840
分布全体の中心をシフトする事になる。

397
00:13:18,450 --> 00:13:19,670
これら全ての

398
00:13:19,780 --> 00:13:21,270
別々の図を見る事で、

399
00:13:21,410 --> 00:13:22,440
多変量のガウス分布で

400
00:13:22,700 --> 00:13:24,850
捉える事の出来る、確率分布の

401
00:13:25,070 --> 00:13:28,000
感じがつかめたかな。

402
00:13:28,800 --> 00:13:29,800
そしてそのキーとなる利点としては、

403
00:13:29,990 --> 00:13:30,930
それを用いると

404
00:13:31,130 --> 00:13:32,240
二つの別々のフィーチャーが

405
00:13:32,750 --> 00:13:33,840
正の相関を持っている、とか負の相関を持っている、という事が期待される時に

406
00:13:33,970 --> 00:13:36,560
それらを捕捉出来るようになる、という事だ。

407
00:13:37,790 --> 00:13:39,030
次のビデオでは、

408
00:13:39,260 --> 00:13:40,760
多変量ガウス分布を、

409
00:13:41,670 --> 00:13:43,290
アノマリー検出に適用する。