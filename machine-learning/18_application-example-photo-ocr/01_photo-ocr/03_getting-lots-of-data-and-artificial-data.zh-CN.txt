我不止一次的提到 要想获得一个比较高效的 机器学习系统 其中一种最可靠的办法是 选择一个低偏差的学习算法 然后用一个巨大的训练集来训练它 但你从哪儿得到那么多的训练数据呢？ 其实在机器学习中 有一个很棒的想法 叫做“人工数据合成”（artificial data synthesis） 这个概念不针对某一个具体的问题 要解决某个具体的问题 通常还是依赖某个具体的思想 方法和观点 但如果你把这个概念 应用到你的机器学习问题中 你有时就能用 一种很容易的方法 来为学习算法获取大量的训练集数据 人工数据合成的概念 通常包含两种不同的变体 第一种是 我们白手起家 来创造新的数据 第二种是 我们已经有了一小部分 带标签的训练集 我们可以扩大这个训练集 就是说用一个小的训练集 将它扩充为一个 大的训练集 这节课中 我们将对这两种方法进行介绍 为了介绍人工数据合成的概念 让我们还是用之前用过的 照片OCR流水线中 的字母识别问题 我们输入一个图像数据 然后想识别出是什么字母 假如我们可以在别处 收集到一大堆标签数据 这就是这堆数据 在这个例子中 我选择的是正方形长宽比的图像 也就是我们选用正方形的图像块 目标就是对任意一个图像块 我们要能识别出 图像中心的那个字符 同时 为了方便 我把这些图像都视为灰度图像 而不是彩色图像 实际上用彩色的图像 对这个问题的解决也起不了多大作用 所以对这个图像块 我们会识别出中心的字符是一个T 而考虑这个图像块 我们会将它识别为一个S 而对这个图像块 我们会将它识别为一个I 等等 所有这些 就是我们的原始图像 我们怎样获得一个更大的训练集呢 现代计算机通常都有一个 很大的字体库 如果你使用一个文字处理软件 你就会有所有这些字体 或者别的很多很多字体 已经储存在字体库中 这取决于你用的是哪个文字处理软件 同样地 如果你登陆一些的网站 你依然会发现大量的 免费的字体库可供你下载 通常有成百上千种 不同类型的字体样式 所以 如果你想要获得 更多的训练样本 其中一种方法是你可以 采集同一个字符的不同种字体 然后将这些字符 加上不同的随机背景 比如你可以取这个字母C 然后把它粘贴到一个随机背景前面 如果你这样做的话 你现在就有了一个 关于字母C的训练样本 因此在一段时间的重复劳动之后 你知道 要合成这些看起来可靠的数据 还是要花点功夫的 但如果你做完这些工作以后 你就得到了一个合成后的训练集 就像右图所示 右图中每一个图像实际上都是一个合成后的图像 你先得到一种字体 也许是从网上随便下载的 然后你把这个字符的图像 或者一系列字符的图像 粘贴到其他随机的 背景图像前面 然后应用某个模糊操作 模糊的意思是 让图像变形 比如均匀 等比例缩放 或者一些旋转操作等等 在完成这些操作后 你就得到了这个合成后的训练集 就是右边所示的 而这项工作 要完成这项工作 还是需要仔细考虑 才能得到比较真实的合成数据 如果你搞得很草率的话 你获得的合成数据很可能就不是那么好 这取决于你合成的方法 但如果你仔细看这些合成数据的话 你会发现它们跟真实数据还是非常接近 因此通过使用合成的数据 你实际上已经获得了 无限的训练样本 这就是人工数据合成 所以如果你使用这种 合成数据的话 你实际上也就有了 无限的有标签数据 你可以用它来进行监督学习 解决这个字符识别的问题 这便是一种人工数据合成的实例 你基本上是在 完全创造新的数据 完全创造新的图像数据 人工数据合成的 第二种方法是使用 你已经有的样本 我们选取一个 真实的样本 也许是一个真实的图像 然后你添加别的数据 来扩大你的训练集 这里这幅图像是一个字母A 来自于一个真实的图像 不是一个合成的图像 我在图像上加了一些 灰色的网格 方便描述 实际上是没有这些格子的 因此你要做的就是 取出这个字母A 取出这个图像 进行人工扭曲 或者人工变形 这样从一个图像A 就能生成 16种新的样本 所以用这种方法 你可以把一个很小的 带标签训练集 突然一下扩大 得到更多的训练样本 同样地 要把这个概念投入应用 还是需要仔细考虑的 比如要考虑 什么样的变形是合理的 或者说 怎样才是合理的方法 来扩大你的训练集 对这个特定的 字母识别的例子 引入人工扭曲的方法 可能是个自然的选择 但对于其他一些机器学习应用来说 可能别的变形方法会更加有效 接下来我再演示另一个实例 一个完全不同的领域 语音识别 语音识别的问题是 假如说你有一段音频片段 你希望通过对这段音频的学习 识别出这段音频中 出现了哪些单词 我们来听一下其中一组有标签的训练样本 假如我们现在有一组 带标签的训练样本 是某个人念一组单词的声音 我们现在播放这段音频 0 1 2 3 4 5 好了 这是有个人 在那儿从0数到5 因此你想要 应用某个学习算法 识别出那段音频中的单词 那么 我们应该如何扩大数据呢？ 其中一种方法是 为这组数据引入额外的音频变形 这里我要增加一些背景声音 来仿真一个很嘈杂的电话连线 你会听见嘟嘟的声音 那就是这个音轨 跟说话者无关 现在开始播放 0 1 2 3 4 5 好的 这样你就能 听这段音频片段 然后识别出声音 这就好像是另一个有用的训练样本 接下来是另一个训练样本 嘈杂的环境 0 1 2 3 4 5 就好像有车开过去 或者有人走过的声音 还有最后一种 因此 从最初的 最干净清晰的音频片段 也就是最开始无杂质的 一个人从0数到5的声音 我们可以自动地合成一系列 额外的训练样本 这样我们就把一组训练样本 扩大到4组不同的训练样本 好的 让我把最后这段放完 0 1 2 3 4 5 因此有了一组带标签的样本 一开始我们收集到了 一组带标签的样本 一个人从0数到5的声音 然后通过合成一些额外的干扰 引入不同的背景声音 我们就把这一组训练样本 扩大为许多组不同的样本 也不需要费多大劲 只需要自动地为纯净的音频片段 添加这些不同的背景声音 我想对人工合成数据中 引入变形的方法提一点注意事项 如果你想要自己试着做的话 那么你选择要引入的干扰或变形 要能代表你可能会在 测试集中看到的 噪音源或干扰项 所以 对于字符识别这个例子 这种扭曲的方法 事实上还是很合理的 因为像这种扭曲的 图像A的情况 我们确实有可能 在测试集中会遇到 比如这个胖胖的A 还有右上角的这个 我们可以想象会遇到这种写法 而对于音频 我们会希望识别语音 即使是在连线不通畅的情况下 或者是有各种背景杂音的时候 因此对于音频识别 我们同样也需要合成 那些有代表性的样本 那些我们想要分类 并且希望正确识别的样本 相对而言 为你的数据添加一些纯随机的噪声 通常来讲是没什么用的 我不确定你从这里能否看出 但在这里我做的是 这四幅图像中 每一个图像的每一个像素 我都加了一些 随机高斯噪声 所以对每个像素点 也就是像素点的亮度 就只是加了一些高斯随机噪声 因此这是完全没有意义的对吧？ 因此 除非你觉得你会在 你的测试集中 遇到这些像素的噪声 否则的话这些随机的噪声 是无意义的 起不来多大作用 但是人工数据合成的过程 怎么说呢 它并没有什么技巧可言 有时候你只能一遍遍地尝试 然后观察效果 但你在确定需要添加 什么样的变形时 你一定要考虑好 你添加的那些额外的变形量 是有意义的 能让你产生的训练样本 至少在某种程度上 是具有一定的代表性 能代表你可能会在测试集中看到的某种图像 最后 总结一下这节视频 我还想多说一点 关于这种 通过人工数据合成 获得大量数据的方法 同往常一样 在花费大量精力 考虑如何产生大量人工训练样本之前 通常最好应该 先保证你已经有了一个 低偏差的分类器 这样得到大量的数据 才真的会起作用 标准的方法是 画出学习曲线 然后确保你 已经有了一个低偏差 或者高方差的分类器 或者如果你没有 得到一个低偏差的分类器 你还可以尝试另一种方法 那就是增大 分类器的特征数 或者在神经网络中 增大隐藏层单元数 直到你得到一个 偏差比较小的分类器 直到这时 你再来考虑建立 大量的人工训练集 所以你一定要避免的是 花了几个星期的时间 或者几个月的工夫 考虑好了怎么样 能获得比较好的 人工合成数据 然后才意识到 即使获得了大量的训练数据 自己的学习算法的表现 依然没有提高多少 这就是我对你的一点建议 在你花费大量精力 获得大量人工训练集数据之前 建议你应该 先做这样一个测试 第二 当我在解决机器学习问题时 通常我会问我的团队 或者我的学生 我们要付出多少工作量 来获得10倍于我们现有的数据量 每当我面对一个 新的机器学习应用问题 我总会先跟团队坐在一起 讨论这个问题 我曾经一次又一次地 问过这个问题 但让我经常感到 有一点吃惊的是 他们的回答都是 这并不是什么难事 最多花上几天时间 我们就能给一个机器学习问题 获得十倍于我们 现有数据量的数据 而且通常来说 如果你能得到10倍的数据量 那么你一般都能让你的学习算法表现更好 因此 如果你加入 某个产品设计小组 要设计某个 机器学习的应用产品 那么这也是一个很好的问题 你可以问问自己 问问团队 也不必太惊讶 说不定几分钟的头脑风暴以后 你的团队就会想出一种方法 真的一下子能获得 10倍的数据量 这样的话 我想你会成为这个团队的英雄 因为有了10倍的数据 你通过学习这么多的数据 一定会获得更好的学习表现 有很多办法你可以尝试 在本课中我们主要关注人工数据合成 这既包括从零开始 生成新数据 比如使用随机的字体等等 也包括第二种思路 那就是在现有的样本中 引入一些噪声或变形 来扩大现有的训练样本 有很多获取 大量数据的方法 是你自己收集 或者标记数据 因此我通常进行的 一种计算是 问问自己 需要花多少分钟 或者多少小时 来获得一定量的样本数 所以我就坐下来 然后算一算 假如我需要花 10秒的时间来标记一个样本 假设对于 我们的应用 我们现在已经有了1,000组带标签的样本 所以10乘以1,000 等于10,000 等于10,000 获取大量数据的 第二种方法是 自己动手收集和标记数据 我的意思是 通常我会坐下来 然后做一个计算 算一算需要花多少时间 或者说多少小时 我或者别人 要花多少小时 多少天时间 坐下来 收集到10倍于 我们现有数据量的数据 通过我们自己收集数据标记数据的方法 举例来讲 假如说我们的机器学习应用 现在已经有1,000组样本 m=1000 我们要做的就是 对自己提问 要收集并且标记一个样本 我需要花多久 有时候可能 会花你10秒钟 来标记一个 新的样本 因此如果我想要10倍的数据 我要做个计算 如果获得一个样本需要10秒的话 那如果我想要10倍的数据 那么我需要10,000个样本 那么计算一下 我需要花多少时间 才能手工地标记10,000个样本 如果标记一个样本需要花10秒的话 因此 如果你算一下的话 通常 我会看到很多团队 表现得相当惊讶 所需要的时间那么少！ 有时候需要两三天 有时候需要几天 很多时候我都发现 这些团队都表现得 非常惊讶 原来要获得这么多数据 只需要这么短的时间 就能让你的学习算法 在表现上获得一个 巨大的提高 当然 如果你成功 做到了这些 你将成为你们开发组的英雄 不管你在什么组开发什么产品 因为这绝对是一种 能让算法表现更好的方法 第三点也是最后一点 另一种很好的办法是 我们称之为"众包" (crowd sourcing) 的办法 现在已经有一些网站 或者一些服务机构 能让你通过网络 雇一些人替你完成 标记大量训练数据的工作 通常都很廉价 因此 这种众包的方法 或者叫 众包的数据标记 很明显这种方法 就像学术文献一样 它也是很复杂的 同时取决于标记人的可靠性 也许世界上有 成百上千的标记人 用很低的收入帮你 为数据加上标签 就像我刚才说的 这也是一种选择而已 可能“亚马逊土耳其机器人”（Amazon Mechanical Turk） 就是当前最流行的 一个众包选择 要让它工作 要想获得比较高质量的标签 通常还不是一件容易的事 需要花一定的功夫 但这也是一种 可供选择的方法 如果你能廉价地 在网上雇佣一些人 来帮你做这件事儿的话 在这段视频中 我们谈到了 人工数据合成的概念 这既包括 从无到有地创造新的数据 我们用到了随机字体的例子 也包括 扩大训练数据的办法 通过对已有的标签样本 引入新的扭曲或变形 来制造新的标签样本 最后 我希望你 通过这段视频 要记住的一点是 如果你要解决某个机器学习问题 通常有两件事情值得好好考虑 第一是用学习曲线 进行合理性检查 保证使用更多的数据能有效果 第二点是 自己坐下来 认真地想一想 想要得到现有数据的 10倍数据量 需要花费多少工作量 有时候你会非常惊讶于 你算出来的结果 也许只需要几天 几个星期的时间 就能让你的学习算法 的表现有巨大的提高【教育无边界字幕组】翻译：所罗门捷列夫 校对：竹二个 审核：Naplessss