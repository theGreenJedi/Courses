1
00:00:00,680 --> 00:00:01,740
このビデオでは

2
00:00:01,900 --> 00:00:02,960
大きなマージンによる分類の

3
00:00:03,210 --> 00:00:04,680
背後にある数学について、ちょっと話しておきたい。

4
00:00:05,960 --> 00:00:08,390
このビデオはオプショナルです。だからどうぞご自由にスキップしちゃって下さい。

5
00:00:09,260 --> 00:00:10,380
このビデオでは、また、

6
00:00:10,650 --> 00:00:11,980
サポートベクターマシンの

7
00:00:12,460 --> 00:00:13,830
最適化問題が、どのように

8
00:00:13,940 --> 00:00:15,540
大きなマージン分類器を導くのかについての

9
00:00:15,860 --> 00:00:17,150
より良い直感も与えたいと思う。

10
00:00:21,180 --> 00:00:22,530
始めるにあたって

11
00:00:22,600 --> 00:00:23,730
まずベクトルの内積について

12
00:00:23,970 --> 00:00:26,490
幾つかの性質を思い出しておこう。

13
00:00:28,310 --> 00:00:29,280
2つのベクトル、uとvが

14
00:00:29,900 --> 00:00:32,180
あったとする。こんな感じの。

15
00:00:32,950 --> 00:00:34,180
つまりどちらも二次元ベクトルだ。

16
00:00:35,460 --> 00:00:36,940
そしてu転置のvが

17
00:00:37,440 --> 00:00:39,550
どんな風になるか見てみよう。

18
00:00:40,160 --> 00:00:42,180
u転置 v はまた、

19
00:00:42,300 --> 00:00:43,720
ベクトルuとvとの

20
00:00:44,490 --> 00:00:45,880
内積、とも言われる。

21
00:00:48,360 --> 00:00:49,960
二次元のベクトルを使う事で

22
00:00:50,380 --> 00:00:51,940
この図にプロットする事が出来る。

23
00:00:52,760 --> 00:00:53,860
さて、これが

24
00:00:54,040 --> 00:00:55,850
ベクトルuとしよう。

25
00:00:55,960 --> 00:00:56,930
これの意味する所は、

26
00:00:57,110 --> 00:00:59,160
水平軸上で、

27
00:00:59,360 --> 00:01:00,820
何かしらの値u1を取り、

28
00:01:01,560 --> 00:01:03,280
そして垂直軸上では

29
00:01:03,350 --> 00:01:04,820
その高さは

30
00:01:05,100 --> 00:01:06,360
何かしらの値u2を取る、

31
00:01:07,340 --> 00:01:08,530
これがベクトルuの

32
00:01:08,990 --> 00:01:12,580
第二成分である、という事。

33
00:01:12,860 --> 00:01:13,760
ここで、得ておくと良い

34
00:01:14,040 --> 00:01:15,430
一つの量として、

35
00:01:16,500 --> 00:01:17,540
ベクトルuのノルムがある。

36
00:01:17,860 --> 00:01:19,390
これらの、左と右の両方にある

37
00:01:19,540 --> 00:01:20,380
二重線が、

38
00:01:20,800 --> 00:01:22,610
uのノルム、言い換えると長さを表す。

39
00:01:22,730 --> 00:01:23,930
つまりこれは単に、

40
00:01:24,200 --> 00:01:27,330
ベクトルuのユークリッド距離を表すに過ぎない。

41
00:01:27,410 --> 00:01:30,800
そして、

42
00:01:31,350 --> 00:01:33,600
ピタゴラスの定理により、

43
00:01:33,940 --> 00:01:35,420
イコール u1の二乗に

44
00:01:35,620 --> 00:01:37,300
足すことの u2の二乗、

45
00:01:37,530 --> 00:01:40,190
これをルートを取る。

46
00:01:40,300 --> 00:01:42,780
そしてこれはベクトルuの長さで、それは実数だ。

47
00:01:43,730 --> 00:01:44,750
この長さ、

48
00:01:45,080 --> 00:01:46,120
ここのこのベクトルの

49
00:01:46,220 --> 00:01:48,900
長さ。

50
00:01:49,680 --> 00:01:50,490
ここに今書いた矢印の長さ、

51
00:01:50,760 --> 00:01:52,990
これがuのノルムだ。

52
00:01:56,020 --> 00:01:57,300
さてここで、戻って、ベクトルvを見てみよう、

53
00:01:57,450 --> 00:01:59,660
何故なら内積を計算したいのだから。

54
00:02:00,430 --> 00:02:01,380
さて、vもまた何らかの

55
00:02:01,520 --> 00:02:03,150
別のベクトルで、

56
00:02:03,310 --> 00:02:06,900
何らかの値、v1とv2がある。

57
00:02:08,340 --> 00:02:10,490
だからベクトルvも

58
00:02:10,880 --> 00:02:15,050
こんな感じに、vベクトル。

59
00:02:16,920 --> 00:02:18,260
ここで、戻って、

60
00:02:18,640 --> 00:02:19,880
uとvの内積を計算する方法を

61
00:02:20,400 --> 00:02:21,610
見てみよう。

62
00:02:21,860 --> 00:02:23,320
それはこんなやり方で出来る。

63
00:02:24,010 --> 00:02:25,780
ベクトルvに対して

64
00:02:26,200 --> 00:02:28,440
それをベクトルu上に射影しよう。

65
00:02:28,550 --> 00:02:29,700
つまり、直角に

66
00:02:29,930 --> 00:02:31,900
射影する、

67
00:02:31,970 --> 00:02:33,700
あるいは90度に射影する、そしてそれを

68
00:02:33,920 --> 00:02:35,490
u上に下ろす。

69
00:02:36,650 --> 00:02:37,410
そしてやるべき事は、

70
00:02:38,130 --> 00:02:39,480
この赤い線、たった今引いたこれの

71
00:02:40,210 --> 00:02:41,520
長さを測る。

72
00:02:41,720 --> 00:02:42,620
この赤い線の長さを

73
00:02:42,730 --> 00:02:44,670
pと呼ぶ事にしよう。

74
00:02:45,530 --> 00:02:46,830
するとpはベクトルvを

75
00:02:46,890 --> 00:02:48,230
ベクトルuに射影した時の

76
00:02:49,670 --> 00:02:51,670
長さ、大きさである。

77
00:02:51,790 --> 00:02:54,380
ここに書き記しておこう。

78
00:02:54,560 --> 00:02:55,600
つまりpは

79
00:02:57,500 --> 00:03:02,150
ベクトルvを

80
00:03:02,260 --> 00:03:05,800
ベクトルuに射影した時の

81
00:03:05,920 --> 00:03:08,210
長さである。

82
00:03:08,430 --> 00:03:10,510
そして内積である u転置 vは

83
00:03:10,790 --> 00:03:12,710
p掛ける uのノルム、あるいは長さに

84
00:03:12,870 --> 00:03:13,540
等しくなる、

85
00:03:13,840 --> 00:03:16,330
という事を

86
00:03:16,430 --> 00:03:18,020
示す事が

87
00:03:18,110 --> 00:03:21,130
出来る。

88
00:03:21,460 --> 00:03:23,400
つまり、これは内積を計算する一つの方法である。

89
00:03:24,070 --> 00:03:25,590
そして実際に幾何学を用いると

90
00:03:25,780 --> 00:03:27,160
pが何なのか、uのノルムが何なのかを

91
00:03:27,330 --> 00:03:29,280
知る事が出来る。

92
00:03:29,900 --> 00:03:30,690
この結果は

93
00:03:31,050 --> 00:03:32,330
内積の別の計算方法と

94
00:03:32,680 --> 00:03:33,840
同じ答えとなるべきだ。

95
00:03:34,860 --> 00:03:34,860
でしょ？

96
00:03:35,070 --> 00:03:36,140
それは uの転置 vで、

97
00:03:36,280 --> 00:03:38,150
u転置 は

98
00:03:39,000 --> 00:03:40,930
u1, u2。

99
00:03:41,090 --> 00:03:42,650
これは1x2 行列。それに

100
00:03:43,220 --> 00:03:45,250
かけることのv。

101
00:03:45,620 --> 00:03:46,930
つまり、これは実際に

102
00:03:47,490 --> 00:03:50,630
u1 v1 足す事の u2 v2 を与える。

103
00:03:51,700 --> 00:03:53,140
つまり、線形代数の定理として

104
00:03:53,310 --> 00:03:55,010
これら二つの式は

105
00:03:55,180 --> 00:03:56,880
同じ答えとなる。

106
00:03:57,890 --> 00:03:58,720
ところで、uの転置 vは、

107
00:03:59,290 --> 00:04:01,010
v転置 uとも

108
00:04:01,320 --> 00:04:03,490
等しい。

109
00:04:03,650 --> 00:04:04,510
だから同様のプロセスを反対に行えば、

110
00:04:05,050 --> 00:04:06,860
vをuに射影する代わりに

111
00:04:07,120 --> 00:04:08,130
uをvに射影出来て、

112
00:04:08,520 --> 00:04:09,940
同様のプロセスだが

113
00:04:10,160 --> 00:04:12,410
uとvの役割を反転させると、

114
00:04:13,170 --> 00:04:14,390
実際にも同じ数字を得る、

115
00:04:14,710 --> 00:04:16,900
その数字がなんであれ。

116
00:04:17,540 --> 00:04:18,790
この等式で何が起こっているのかを

117
00:04:18,990 --> 00:04:20,850
もう少し明らかにしておく。

118
00:04:21,030 --> 00:04:21,920
uのノルムは実数で

119
00:04:22,100 --> 00:04:25,260
pもまた実数だ。

120
00:04:25,760 --> 00:04:28,720
だから u転置 v は、

121
00:04:29,410 --> 00:04:32,350
単なる二つの実数の、普通の掛け算で、

122
00:04:33,040 --> 00:04:34,440
pの長さ 掛ける uのノルム。

123
00:04:35,580 --> 00:04:36,960
最後に一つ細かい話を。

124
00:04:37,190 --> 00:04:38,240
pのノルムを見る時には、

125
00:04:38,330 --> 00:04:40,250
pは実際は符合つきだ。

126
00:04:41,350 --> 00:04:43,240
それはプラスにもマイナスにもなりうる。

127
00:04:44,350 --> 00:04:45,530
ようするに、

128
00:04:45,650 --> 00:04:46,740
ベクトルuが

129
00:04:47,170 --> 00:04:49,360
このようなベクトルだとして、

130
00:04:49,640 --> 00:04:51,360
vがこんなベクトルだとすると、

131
00:04:52,380 --> 00:04:53,890
つまりuとvのなす角が

132
00:04:54,130 --> 00:04:55,770
90度より大きければ、

133
00:04:56,620 --> 00:04:57,960
vをu上に射影すると、

134
00:04:58,270 --> 00:05:00,220
得られる射影は

135
00:05:00,420 --> 00:05:01,590
こんな感じとなり、

136
00:05:01,720 --> 00:05:03,860
これがpの長さとなる。

137
00:05:04,110 --> 00:05:05,490
そしてこの場合、

138
00:05:05,670 --> 00:05:06,900
u転置 vは

139
00:05:07,670 --> 00:05:09,510
基本的には、依然として

140
00:05:09,660 --> 00:05:11,720
p掛ける uのノルム、となるが、

141
00:05:11,800 --> 00:05:14,070
しかしこの場合は、

142
00:05:14,200 --> 00:05:16,600
pが負になる所だけが違う。

143
00:05:19,150 --> 00:05:20,990
つまり、内積においては、

144
00:05:21,320 --> 00:05:22,540
uとvのなす角が

145
00:05:22,790 --> 00:05:23,820
90度未満の時は、

146
00:05:24,100 --> 00:05:26,480
pは赤い線の正の長さとなり、

147
00:05:27,130 --> 00:05:28,420
一方でここの角度が

148
00:05:28,720 --> 00:05:29,640
90度以上の時は、

149
00:05:30,000 --> 00:05:31,890
ここのpは

150
00:05:32,130 --> 00:05:33,880
マイナスの長さ、

151
00:05:34,130 --> 00:05:37,260
マイナスの、ここの線分の長さとなる。

152
00:05:37,650 --> 00:05:38,750
つまり、二つのベクトルの内積は

153
00:05:38,900 --> 00:05:40,130
マイナスになる事がある、

154
00:05:40,820 --> 00:05:42,900
もしなす角が90度より大きければ。

155
00:05:43,770 --> 00:05:45,100
以上がベクトルの内積が

156
00:05:45,310 --> 00:05:46,490
どう機能するかだ。

157
00:05:46,930 --> 00:05:47,960
これらのベクトルの内積の

158
00:05:48,280 --> 00:05:49,610
性質を用いて、

159
00:05:49,840 --> 00:05:51,880
ここのサポートベクターマシンの

160
00:05:52,400 --> 00:05:54,490
最適化の目的関数を理解しよう。

161
00:05:54,630 --> 00:05:58,620
これが以前に見た、サポートベクターマシンの

162
00:05:58,650 --> 00:06:00,900
最適化の目的関数だ。

163
00:06:01,100 --> 00:06:02,070
このスライドの目的の為に

164
00:06:02,120 --> 00:06:04,520
一つ単純化しておこう、

165
00:06:04,910 --> 00:06:08,220
つまり、目的関数を分析しやすくする為に

166
00:06:08,670 --> 00:06:10,110
切片項を

167
00:06:10,270 --> 00:06:14,160
無視する事にする。
つまりシータ0を無視する、つまりイコール0とする。

168
00:06:16,510 --> 00:06:22,950
またプロットしやすいように、n、つまりフィーチャーの数を2とする。

169
00:06:23,980 --> 00:06:24,710
つまり、x1とx2だけとする。

170
00:06:26,510 --> 00:06:27,980
ここで、目的関数を見てみよう。

171
00:06:28,470 --> 00:06:29,910
SVMの目的関数を。

172
00:06:30,160 --> 00:06:32,130
フィーチャーは二つだけなので、

173
00:06:32,630 --> 00:06:33,710
何故ならn=2だから、

174
00:06:34,170 --> 00:06:35,340
これは以下のように書ける：

175
00:06:36,130 --> 00:06:37,900
1/2の

176
00:06:38,040 --> 00:06:40,080
シータ1の二乗 足すことの シータ2の二乗、と。

177
00:06:40,620 --> 00:06:42,870
何故なら我らは、二つのパラメータだけ、シータ1とシータ2だけしか持たないから。

178
00:06:45,240 --> 00:06:46,730
そしてこれをちょっと書き換える。

179
00:06:46,940 --> 00:06:47,900
これを、1/2の

180
00:06:48,090 --> 00:06:49,980
シータ1の二乗に

181
00:06:50,190 --> 00:06:51,860
足す事の シータ2の二乗、

182
00:06:52,050 --> 00:06:54,160
そしてこれらのルートを取る。

183
00:06:54,820 --> 00:06:55,760
こんな事が出来る理由というのは、

184
00:06:56,100 --> 00:06:58,990
任意の数wに対して、

185
00:07:00,830 --> 00:07:02,480
wを二乗して、

186
00:07:02,570 --> 00:07:03,930
それ全体のルートを取ると、それはちょうどwと等しくなるから。

187
00:07:04,080 --> 00:07:05,650
つまり、ルートして二乗は

188
00:07:05,840 --> 00:07:07,250
同じ物を返す。

189
00:07:08,600 --> 00:07:09,500
ここで気づく事として、

190
00:07:09,730 --> 00:07:11,870
この中の項は、

191
00:07:12,290 --> 00:07:13,450
シータのノルムと

192
00:07:14,530 --> 00:07:16,460
言い換えるとベクトルシータの長さと

193
00:07:16,690 --> 00:07:18,250
等しい。

194
00:07:18,430 --> 00:07:20,020
そしてそれによって意味する事は、

195
00:07:20,200 --> 00:07:21,640
ベクトルシータをこんな風に

196
00:07:21,700 --> 00:07:22,590
書き下すと、

197
00:07:23,080 --> 00:07:24,320
つまり、シータ1, シータ2,と書くと、

198
00:07:25,260 --> 00:07:26,260
するとこの今赤で下線を引いた

199
00:07:26,690 --> 00:07:28,230
この項は、これは正確に

200
00:07:28,640 --> 00:07:30,480
ベクトルシータの長さ、ノルムである。

201
00:07:30,900 --> 00:07:32,180
前のスライドにあった、

202
00:07:32,950 --> 00:07:35,050
ベクトルのノルムの定義に等しい。

203
00:07:36,140 --> 00:07:37,040
そして実際に、これは

204
00:07:37,400 --> 00:07:38,320
ベクトルシータの長さに

205
00:07:38,370 --> 00:07:39,760
等しい。たとえあなたが

206
00:07:40,020 --> 00:07:41,620
シータ0, シータ1, シータ2で書いても、

207
00:07:42,280 --> 00:07:45,230
ここで仮定したようにシータ0が0だから、

208
00:07:45,860 --> 00:07:46,770
または単にこれはシータ1, シータ2の長さでもあるが、

209
00:07:46,900 --> 00:07:48,680
このスライドではシータ0を

210
00:07:48,830 --> 00:07:50,450
無視するのだったから、

211
00:07:50,940 --> 00:07:52,710
シータをこんな風に

212
00:07:53,150 --> 00:07:54,730
シータの、このシータ1, シータ2のノルムを

213
00:07:54,960 --> 00:07:56,360
こんな風に

214
00:07:56,720 --> 00:07:58,480
書いてみよう。

215
00:07:58,620 --> 00:08:00,180
だが、この数学は

216
00:08:00,260 --> 00:08:01,220
どっちでも成立する。

217
00:08:01,460 --> 00:08:03,790
シータ0を含めようとも、無視しようとも。

218
00:08:03,970 --> 00:08:05,870
だからこれは以下の導出には、影響しない。

219
00:08:07,630 --> 00:08:09,120
そして最終的に、これは

220
00:08:09,390 --> 00:08:11,440
私の最適化の目的関数が

221
00:08:11,750 --> 00:08:13,100
1/2のシータのノルムの二乗に

222
00:08:13,190 --> 00:08:14,610
等しい事を意味する。

223
00:08:16,190 --> 00:08:17,230
つまりサポートベクターマシンがやる事の全ては、

224
00:08:17,530 --> 00:08:19,010
最適化の目的関数として、

225
00:08:19,910 --> 00:08:21,500
パラメータベクトルのシータの

226
00:08:21,590 --> 00:08:23,100
ノルムの二乗、つまり長さの二乗を

227
00:08:23,470 --> 00:08:24,840
最小化しようと試みる。

228
00:08:28,330 --> 00:08:29,160
ここで私はこれらの項を見て、

229
00:08:29,370 --> 00:08:30,790
シータ転置 xを見て、

230
00:08:31,090 --> 00:08:33,670
それらが何をやっているのかをもっと良く理解していこう。

231
00:08:34,230 --> 00:08:36,600
さて、パラメータベクトルのシータが与えられたとして、

232
00:08:36,930 --> 00:08:39,880
手本のxが与えられたとすると、これは何に等しいだろうか？

233
00:08:40,820 --> 00:08:42,120
前のスライドでは、

234
00:08:42,230 --> 00:08:44,070
u転置 v とはどんな物なのかを見ていった、

235
00:08:44,870 --> 00:08:45,850
uとvは別のベクトル。

236
00:08:46,110 --> 00:08:47,880
そこで我らはそれらの定義を

237
00:08:48,130 --> 00:08:50,340
持ってきて、シータとx(i)に

238
00:08:50,980 --> 00:08:52,300
uとvの役割を

239
00:08:52,410 --> 00:08:53,310
させてみよう。

240
00:08:54,400 --> 00:08:57,430
するとどんな絵となるかを見てみよう。

241
00:08:57,860 --> 00:08:59,160
さて、プロットし、、、さて、たった一つの

242
00:08:59,430 --> 00:09:01,130
トレーニング手本を見てみるとする。

243
00:09:01,230 --> 00:09:03,360
陽性の手本が一つあるとして、

244
00:09:03,720 --> 00:09:05,050
その場所に十字を描いておくとする。

245
00:09:05,800 --> 00:09:09,310
これを手本x(i)としよう。

246
00:09:09,500 --> 00:09:10,970
それが実際に意味する事は、

247
00:09:12,100 --> 00:09:13,510
横軸にある値、x(i) 1、

248
00:09:14,450 --> 00:09:16,210
そして縦軸に

249
00:09:17,140 --> 00:09:19,620
ある値x(i) 2を

250
00:09:21,240 --> 00:09:22,290
プロットした、という事。

251
00:09:22,650 --> 00:09:24,070
これがトレーニング手本のプロットの仕方だった。

252
00:09:25,400 --> 00:09:27,160
そして、ここまでの所、

253
00:09:27,320 --> 00:09:28,310
これが実際にはベクトルであるとは考えてこなかったが、

254
00:09:28,570 --> 00:09:29,600
これは本当は

255
00:09:29,650 --> 00:09:30,910
原点、0, 0から

256
00:09:31,610 --> 00:09:33,520
このトレーニング手本の位置までの

257
00:09:34,560 --> 00:09:36,210
ベクトルだ。

258
00:09:37,830 --> 00:09:39,460
そして今、パラメータベクトルが

259
00:09:39,980 --> 00:09:41,850
あるとして、

260
00:09:42,080 --> 00:09:43,620
それも同様にベクトルとして

261
00:09:43,800 --> 00:09:45,720
プロットする。

262
00:09:46,390 --> 00:09:48,410
どういう事かというと、シータ1をここに、

263
00:09:49,100 --> 00:09:53,530
シータ2をここにプロットすると、

264
00:09:56,230 --> 00:09:57,050
内積である シータ転置 x(i) は

265
00:09:57,290 --> 00:09:58,940
どうなるだろうか？

266
00:09:59,220 --> 00:10:01,240
以前の手法を用いると、

267
00:10:01,990 --> 00:10:03,360
それを計算する方法は、

268
00:10:04,310 --> 00:10:06,170
手本に対して、

269
00:10:06,320 --> 00:10:08,710
それをパラメータベクトルのシータの上に射影する。

270
00:10:09,830 --> 00:10:10,700
そして次にこの線分の

271
00:10:10,950 --> 00:10:13,070
長さを見る、

272
00:10:13,680 --> 00:10:14,660
今赤で描いているこの長さだ。

273
00:10:15,090 --> 00:10:16,500
そしてこれを、

274
00:10:16,670 --> 00:10:19,480
p上付き添字iと呼ぼう、

275
00:10:20,330 --> 00:10:21,330
これはi番目のトレーニング手本の

276
00:10:21,610 --> 00:10:22,920
パラメータベクトル、シータに対する

277
00:10:24,860 --> 00:10:25,540
射影を表す。

278
00:10:26,900 --> 00:10:28,140
すると我らが得るのは、

279
00:10:28,350 --> 00:10:30,790
シータ転置 x(i) は

280
00:10:30,920 --> 00:10:32,830
前のスライドにあった、

281
00:10:32,960 --> 00:10:34,210
以下に等しい。

282
00:10:34,430 --> 00:10:35,350
これは p掛ける

283
00:10:36,560 --> 00:10:40,000
ベクトルシータのノルム、長さに

284
00:10:40,090 --> 00:10:42,090
等しくなる。

285
00:10:43,410 --> 00:10:44,690
そしてこれはもちろん、

286
00:10:44,750 --> 00:10:46,660
シータ1 x1 足すことの シータ2 x2

287
00:10:47,920 --> 00:10:50,610
に等しくなる。

288
00:10:50,810 --> 00:10:52,360
つまりこれらはそれぞれどれも、

289
00:10:52,680 --> 00:10:54,080
シータとx(i)の内積を計算する

290
00:10:54,180 --> 00:10:56,160
同じように正統な方法である。

291
00:10:57,780 --> 00:10:57,780
オーケー。

292
00:10:58,140 --> 00:10:59,040
すると何だろう？

293
00:10:59,280 --> 00:11:00,770
これの意味する所は、

294
00:11:01,020 --> 00:11:02,890
この制約条件、シータ転置 x(i) が

295
00:11:03,130 --> 00:11:05,330
1以上か-1以下という条件、

296
00:11:06,110 --> 00:11:06,860
この意味する所は、

297
00:11:06,970 --> 00:11:07,830
制約に使われている式を

298
00:11:08,610 --> 00:11:12,000
p(i) 掛ける x が1以上、

299
00:11:12,320 --> 00:11:13,500
に置き換える事が出来る。

300
00:11:13,680 --> 00:11:16,280
何故なら シータ転置 x(i) は

301
00:11:16,400 --> 00:11:19,470
p(i)掛けることの シータのノルムに等しいから。

302
00:11:21,250 --> 00:11:23,080
つまり、以上を最適化の目的関数に書きこむと、

303
00:11:23,910 --> 00:11:24,870
これが得られる、

304
00:11:25,130 --> 00:11:26,290
ここでは

305
00:11:27,090 --> 00:11:28,400
シータ転置 x(i)の代わりに、

306
00:11:28,620 --> 00:11:30,920
今度は p(i)掛けるシータのノルム となっている。

307
00:11:31,970 --> 00:11:32,970
そして、思い出そう、

308
00:11:33,090 --> 00:11:34,240
前に見てみたように、

309
00:11:34,460 --> 00:11:36,310
この最適化の目的関数は、

310
00:11:36,510 --> 00:11:38,130
1/2掛けるシータのノルムの二乗、

311
00:11:38,500 --> 00:11:39,910
とも書けるのだった。

312
00:11:41,730 --> 00:11:43,490
では下にあるような

313
00:11:44,210 --> 00:11:45,550
トレーニング手本を

314
00:11:45,700 --> 00:11:47,100
考えてみよう、

315
00:11:47,450 --> 00:11:49,620
そしてここでも、シータ0が0と等しいという

316
00:11:50,180 --> 00:11:51,340
単純化を継続する。

317
00:11:52,030 --> 00:11:54,810
サポートベクターマシンがどんな決定境界を選ぶかを見てみよう。

318
00:11:55,860 --> 00:11:57,710
ここにそんな選択肢の一つがある。

319
00:11:57,870 --> 00:11:59,190
サポートベクターマシンが仮に

320
00:11:59,340 --> 00:12:01,750
この決定境界を選んだ、と仮定してみよう。

321
00:12:02,690 --> 00:12:05,110
これはとても良い選択という訳では無さそうだ。何故ならマージンがとても小さいから。

322
00:12:05,530 --> 00:12:08,210
この決定境界はトレーニング手本のとても近くを通ってる。

323
00:12:09,810 --> 00:12:12,360
何故サポートベクターマシンがこれを行わないかを見ていこう。

324
00:12:14,130 --> 00:12:15,420
このパラメータの選択において、

325
00:12:16,410 --> 00:12:18,280
パラメータベクトルは実際に

326
00:12:19,030 --> 00:12:21,250
決定境界と90度の角度をなす事が

327
00:12:21,760 --> 00:12:23,350
証明出来る。

328
00:12:24,060 --> 00:12:25,440
つまり、この緑の決定境界は

329
00:12:26,250 --> 00:12:27,550
この方向を向いたパラメートルベクトルのシータに

330
00:12:27,920 --> 00:12:29,650
対応している。

331
00:12:30,730 --> 00:12:32,280
ところで、シータ0がイコール0だという

332
00:12:32,510 --> 00:12:34,120
単純化は、単に

333
00:12:34,300 --> 00:12:35,410
決定境界が原点、ここの(0, 0)を

334
00:12:35,910 --> 00:12:37,960
通らないといけない、という事を意味しているに過ぎない。

335
00:12:38,330 --> 00:12:40,350
ではここで、

336
00:12:40,690 --> 00:12:41,780
これが最適化の目的関数に対して

337
00:12:41,840 --> 00:12:43,590
何を意味しているかを見ていこう。

338
00:12:45,260 --> 00:12:46,420
この手本がここにあったとする。

339
00:12:47,460 --> 00:12:48,560
これが私の最初の手本、

340
00:12:50,480 --> 00:12:50,650
x(1)だとしよう。

341
00:12:51,690 --> 00:12:52,630
この手本のパラメータシータに対する

342
00:12:53,320 --> 00:12:54,870
射影を見てみると、

343
00:12:56,180 --> 00:12:56,520
これが射影となる。

344
00:12:57,660 --> 00:12:59,230
つまりこの赤い線分。

345
00:13:00,450 --> 00:13:01,720
これはイコールp1だ。

346
00:13:02,380 --> 00:13:04,650
そしてこれは極めて小さい。でしょ？

347
00:13:05,860 --> 00:13:08,590
そして同様に、このここの手本を見ると、

348
00:13:09,610 --> 00:13:10,710
これをx2とすると、

349
00:13:11,170 --> 00:13:12,620
これが二番目の手本という事だが、

350
00:13:13,880 --> 00:13:16,620
この手本のシータに対する射影を見てみよう。

351
00:13:18,080 --> 00:13:18,170
お分かりの通り、

352
00:13:18,440 --> 00:13:20,460
これをマゼンタで描く事にすると、

353
00:13:21,600 --> 00:13:23,690
この小さなマゼンタの線分、

354
00:13:24,000 --> 00:13:25,820
これがp(2)となる。

355
00:13:26,070 --> 00:13:27,370
これが二番目の手本を

356
00:13:27,770 --> 00:13:28,870
パラメータベクトルシータに

357
00:13:30,100 --> 00:13:32,650
射影した物で、それはこんな感じになる。

358
00:13:33,870 --> 00:13:34,250
つまり、この小さな射影の

359
00:13:35,270 --> 00:13:35,270
線分は、極めて小さくなってしまう。

360
00:13:36,850 --> 00:13:38,420
p(2)は実際には負の数だから、p(2)は

361
00:13:38,560 --> 00:13:42,490
反対の向きになる。

362
00:13:43,710 --> 00:13:45,250
このベクトルは

363
00:13:45,560 --> 00:13:47,130
パラメータベクトルから90度より

364
00:13:47,270 --> 00:13:48,980
大きな角度となるので、0以下となる。

365
00:13:50,280 --> 00:13:51,580
すると分かる事は、

366
00:13:51,850 --> 00:13:54,880
これらの項、p(i)は

367
00:13:55,200 --> 00:13:57,230
極めて小さな数となるという事だ。

368
00:13:58,210 --> 00:13:59,080
つまり最適化の目的関数を見ると、

369
00:13:59,110 --> 00:14:01,650
陽性の手本に対しては

370
00:14:02,490 --> 00:14:04,860
p(i)掛ける シータのノルムが

371
00:14:05,220 --> 00:14:07,590
1以上である必要があるが、

372
00:14:08,670 --> 00:14:10,640
ここのp(i)、

373
00:14:10,860 --> 00:14:12,140
ここのp(1)が

374
00:14:12,770 --> 00:14:14,160
とても小さければ、

375
00:14:14,410 --> 00:14:15,580
シータのノルムは

376
00:14:15,650 --> 00:14:18,420
とても大きくならないといけない。でしょ？

377
00:14:19,830 --> 00:14:20,840
p(1) が小さくて、

378
00:14:21,790 --> 00:14:23,110
p(1)掛けるシータのノルムを

379
00:14:23,410 --> 00:14:24,600
1以上に

380
00:14:24,920 --> 00:14:25,890
したいのだから、

381
00:14:26,400 --> 00:14:27,300
この条件を真にする

382
00:14:27,510 --> 00:14:28,440
唯一の方法は、

383
00:14:28,650 --> 00:14:29,750
この二つの数が大きくなるには、

384
00:14:30,020 --> 00:14:31,120
p(1)が小さいとするなら、

385
00:14:31,240 --> 00:14:32,980
シータのノルムが大きくなる必要がある。

386
00:14:34,150 --> 00:14:36,450
同様に陰性の手本に対しては、

387
00:14:36,650 --> 00:14:38,560
p(2) 掛けることの

388
00:14:39,750 --> 00:14:41,070
シータのノルムが、

389
00:14:41,350 --> 00:14:44,990
-1未満で

390
00:14:45,160 --> 00:14:46,910
なくてはならない。

391
00:14:47,760 --> 00:14:48,540
そしてこの手本に対しては

392
00:14:48,710 --> 00:14:50,200
p(2)は極めて小さい

393
00:14:50,260 --> 00:14:51,520
負の数である事を既に見た。

394
00:14:52,040 --> 00:14:53,290
だからその条件が満たされる

395
00:14:53,420 --> 00:14:54,490
唯一の方法も、同様に、

396
00:14:54,530 --> 00:14:56,730
シータのノルムが大きくなる、という事だ。

397
00:14:57,010 --> 00:14:59,630
だが我らが行っている

398
00:14:59,790 --> 00:15:00,900
最適化の目的関数は、

399
00:15:01,290 --> 00:15:02,400
以下のような条件を満たした

400
00:15:02,540 --> 00:15:03,840
シータの組を探すという事だった：

401
00:15:04,170 --> 00:15:05,320
その条件とはシータのノルムが

402
00:15:05,550 --> 00:15:07,100
小さくなる、という物、つまり、

403
00:15:07,830 --> 00:15:09,040
これはパラメータベクトルのシータにとって

404
00:15:09,330 --> 00:15:10,070
良い方向では

405
00:15:10,610 --> 00:15:14,160
無さそうだ。

406
00:15:14,450 --> 00:15:15,510
これと比較して、別の決定境界を見てみよう。

407
00:15:17,040 --> 00:15:19,500
今度は、このSVMはこんな決定境界を

408
00:15:20,510 --> 00:15:21,280
選んだとしよう。

409
00:15:22,870 --> 00:15:23,980
こんどは随分と違う絵となる。

410
00:15:24,420 --> 00:15:25,890
これが決定境界だとすると、

411
00:15:26,190 --> 00:15:27,380
それに対応したシータの方向は

412
00:15:27,450 --> 00:15:28,770
こうなる。

413
00:15:29,210 --> 00:15:30,920
さて、この決定境界、

414
00:15:31,000 --> 00:15:32,110
垂直な直線に、

415
00:15:32,300 --> 00:15:33,560
対応した決定境界は、

416
00:15:34,470 --> 00:15:35,960
線形代数を用いて

417
00:15:36,190 --> 00:15:37,880
証明する事が出来るのだが、

418
00:15:38,070 --> 00:15:39,140
この緑の決定境界を得る方法は、

419
00:15:39,460 --> 00:15:41,190
それと直角の

420
00:15:41,390 --> 00:15:42,620
シータベクトルを持てば良い。

421
00:15:43,610 --> 00:15:44,470
そしてあなたのデータを

422
00:15:44,560 --> 00:15:45,570
ベクトルシータに

423
00:15:45,710 --> 00:15:47,540
射影した物を見ると、

424
00:15:48,800 --> 00:15:50,010
前と同様にこの手本を

425
00:15:50,010 --> 00:15:52,620
手本x(1)とすると、

426
00:15:52,890 --> 00:15:54,600
これをシータに射影すると、

427
00:15:55,410 --> 00:15:59,110
これがp(1)となる。

428
00:16:00,650 --> 00:16:02,410
この長さがp(1)。

429
00:16:03,750 --> 00:16:05,820
別の手本、この手本にも

430
00:16:06,260 --> 00:16:08,620
同様の射影を

431
00:16:08,840 --> 00:16:11,300
行って、

432
00:16:11,410 --> 00:16:12,580
この長さ、

433
00:16:12,780 --> 00:16:14,680
ここが、p(2)となり、

434
00:16:15,610 --> 00:16:17,880
これは0未満となる。

435
00:16:18,830 --> 00:16:19,940
そして見て分かるように、

436
00:16:20,480 --> 00:16:22,490
ここでのp(1)とp(2)、

437
00:16:23,810 --> 00:16:24,740
これら射影の長さは、

438
00:16:24,780 --> 00:16:26,800
もっと大きくなっている。

439
00:16:27,440 --> 00:16:28,460
だから、この制約、

440
00:16:28,890 --> 00:16:30,700
p(1) シータのノルム が

441
00:16:30,800 --> 00:16:33,040
1以上、という制約が

442
00:16:33,230 --> 00:16:35,670
ここでも満たされている必要があるとすると、p(1)はいまやもっと大きくなったので

443
00:16:36,580 --> 00:16:39,110
ノルムは小さくなれる。

444
00:16:41,960 --> 00:16:43,090
すると、この意味する所は、

445
00:16:43,210 --> 00:16:44,320
決定境界を、

446
00:16:44,730 --> 00:16:45,760
左に示したような物では無く右側に示したような物を

447
00:16:46,010 --> 00:16:47,610
選ぶ事によって、

448
00:16:47,850 --> 00:16:49,000
SVMはパラメータシータのノルムを

449
00:16:49,080 --> 00:16:50,560
もっと小さくする事が出来る。

450
00:16:50,840 --> 00:16:52,420
すると、シータのノルムを

451
00:16:52,550 --> 00:16:54,080
小さくする事が出来ると、

452
00:16:54,260 --> 00:16:55,140
それはシータのノルムの二乗も

453
00:16:55,590 --> 00:16:57,080
小さくなるので、

454
00:16:57,210 --> 00:16:58,130
それこそが、SVMが

455
00:16:58,710 --> 00:17:00,920
右側の仮説の方を選ぶであろう理由となる。

456
00:17:02,800 --> 00:17:04,260
そしてこのようにして、

457
00:17:05,580 --> 00:17:07,160
SVMは大きなマージンの分類の効果を

458
00:17:07,500 --> 00:17:09,550
生み出す。

459
00:17:10,700 --> 00:17:11,620
例えば、この緑の直線を見ると、

460
00:17:11,820 --> 00:17:13,250
この緑の仮説を見ると、

461
00:17:13,490 --> 00:17:14,990
我らは、陽性と陰性の手本の

462
00:17:15,070 --> 00:17:16,250
シータに対する射影を

463
00:17:17,190 --> 00:17:18,780
大きくしたい。

464
00:17:19,200 --> 00:17:20,360
これを真に保つ、唯一の方法は、

465
00:17:20,710 --> 00:17:23,490
緑の線を囲むとすると、

466
00:17:24,950 --> 00:17:27,710
この大きなマージンが存在する事、

467
00:17:27,880 --> 00:17:31,460
この陽性と陰性の手本を分離する時に

468
00:17:33,970 --> 00:17:37,240
大きなギャップが存在する事、

469
00:17:38,020 --> 00:17:40,740
実際にこのギャップの大きさ、

470
00:17:41,080 --> 00:17:42,050
このマージンの大きさは、

471
00:17:43,040 --> 00:17:44,900
実際にp(1)、p(2)、p(3)などの

472
00:17:45,060 --> 00:17:47,730
値である。

473
00:17:47,890 --> 00:17:48,970
つまりこのマージンを大きくする事で、

474
00:17:49,480 --> 00:17:51,270
これらp(1)、p(2)、p(3)などを

475
00:17:51,470 --> 00:17:53,650
大きくしようとする事で、

476
00:17:53,830 --> 00:17:55,520
SVMは結果として

477
00:17:55,670 --> 00:17:56,860
シータのノルムを小さくする事が出来る、

478
00:17:56,960 --> 00:17:59,450
そしてそれこそが目的関数でやろうとしていた事だった。

479
00:18:00,250 --> 00:18:01,290
こんな訳で、サポートベクターマシンは

480
00:18:01,960 --> 00:18:03,300
分類器のマージンを

481
00:18:03,790 --> 00:18:05,510
広げる事になる、何故なら、

482
00:18:05,640 --> 00:18:07,570
それはp(1)のノルム、

483
00:18:07,720 --> 00:18:08,910
それは決定境界から手本までの距離だが、

484
00:18:09,060 --> 00:18:10,450
それを最大化しようとするからだ。

485
00:18:14,360 --> 00:18:16,450
最後に、我らはこれらの導出を

486
00:18:17,200 --> 00:18:18,590
全てパラメータのシータ0が、イコール0という

487
00:18:18,750 --> 00:18:21,150
単純化の元で行なってきた。

488
00:18:21,860 --> 00:18:23,440
その効果を簡単に

489
00:18:23,560 --> 00:18:25,380
伝えておく。

490
00:18:25,540 --> 00:18:26,560
シータ0が0と等しい時というのは、

491
00:18:26,830 --> 00:18:28,280
それの意味する所は、

492
00:18:28,460 --> 00:18:29,770
決定境界をいつも、

493
00:18:30,200 --> 00:18:31,510
原点を通る物だけで

494
00:18:31,750 --> 00:18:33,640
決めるという事に対応する。

495
00:18:33,800 --> 00:18:35,510
こんな風に原点を通る。

496
00:18:35,710 --> 00:18:37,980
もしシータ0に、0以外の値を

497
00:18:38,080 --> 00:18:39,540
許すとすると、

498
00:18:39,870 --> 00:18:41,190
その意味する所は、

499
00:18:41,380 --> 00:18:43,120
原点を通らない決定境界も

500
00:18:43,390 --> 00:18:45,730
試していくという事を意味する。今ここに描いたような物も、だ。

501
00:18:46,380 --> 00:18:47,940
これの完全な証明を

502
00:18:48,010 --> 00:18:49,540
する気は無いが、

503
00:18:49,650 --> 00:18:50,600
まさにそっくりの

504
00:18:51,060 --> 00:18:52,720
大きなマージンの証明が

505
00:18:52,780 --> 00:18:54,240
ほとんど同様に成立する。

506
00:18:54,390 --> 00:18:56,100
そして、ここまで長々と

507
00:18:56,850 --> 00:18:57,830
やってきた議論を

508
00:18:58,030 --> 00:18:59,400
一般化出来て、

509
00:18:59,870 --> 00:19:01,540
シータ0が非ゼロでも、

510
00:19:01,840 --> 00:19:03,690
SVMが試みるのはーー

511
00:19:03,960 --> 00:19:06,940
この最適化の目的関数を持つ時に、

512
00:19:08,200 --> 00:19:09,620
これもふたたび、Cがとても大きい場合に

513
00:19:09,720 --> 00:19:11,570
対応するが、

514
00:19:14,010 --> 00:19:15,110
ここでも、シータ0が0で無くても

515
00:19:15,290 --> 00:19:16,510
このサポートベクターマシンは

516
00:19:16,810 --> 00:19:18,420
同様に陽性と陰性の

517
00:19:18,620 --> 00:19:19,750
手本を分離するような、

518
00:19:20,100 --> 00:19:21,360
大きなマージンの分離を

519
00:19:21,640 --> 00:19:22,650
探そうとする、という事を

520
00:19:23,040 --> 00:19:24,060
示す事が出来る。

521
00:19:24,630 --> 00:19:28,200
以上が、サポートベクターマシンが

522
00:19:28,420 --> 00:19:31,060
どのように大きなマージンの分類器であるのか、の説明だ。

523
00:19:32,920 --> 00:19:34,020
次のビデオでは、

524
00:19:34,190 --> 00:19:35,080
これらのSVMの考え方の

525
00:19:35,400 --> 00:19:36,480
幾つかを用いて、

526
00:19:36,710 --> 00:19:37,980
それを複雑な

527
00:19:38,190 --> 00:19:39,200
非線型の分類器を構築する為に

528
00:19:39,900 --> 00:19:41,370
適用していく方法を見ていこう。