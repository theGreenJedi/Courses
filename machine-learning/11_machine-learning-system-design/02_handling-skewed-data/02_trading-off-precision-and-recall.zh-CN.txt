在之前的课程中 我们谈到 查准率和召回率 作为遇到偏斜类问题 的评估度量值 在很多应用中 我们希望能够保证 查准率和召回率的相对平衡 在这节课中 我将告诉你应该怎么做 同时也向你展示一些 查准率和召回率 作为算法评估度量值的 更有效的方式 回忆一下 这是查准率和召回率的定义 我们在上一节中讲到的 让我们继续用 癌症分类的例子 如果病人患癌症 则y=1 反之则y=0 假设我们用 逻辑回归模型训练了数据 输出概率在0-1之间的值 因此 我们预测y=1 如果h(x) 大于或等于0.5 预测值为0 如果方程输出值 小于0.5 这个回归模型 能够计算查准率和召回率 但是现在 假如我们希望 在我们非常确信地情况下 才预测一个病人得了癌症 因为你知道 如果你告诉一个病人 告诉他们你得了癌症 他们会非常震惊 因为这是一个 非常坏的消息 而且他们会经历一段 非常痛苦的治疗过程 因此我们希望 只有在我们非常确信的情况下 才告诉这个人他得了癌症 这样做的一种方法 是修改算法 我们不再将临界值 设为0.5 也许 我们只在 h(x)的值大于或等于0.7 的情况下 才预测y=1 因此 我们会告诉一个人 他得了癌症 在我们认为 他有大于等于70%得癌症的概率情况下 如果你这么做 那么你只在 非常确信地情况下 才预测癌症 那么你的回归模型 会有较高的查准率 因为所有你准备 告诉他们 患有癌症的病人 所有这些人 有比较高的可能性 他们真的患有癌症 你预测患有癌症的病人中 有较大比率的人 他们确实患有癌症 因为这是我们 在非常确信的情况下做出的预测 与之相反 这个回归模型会有较低的召回率 因为 当我们做预测的时候 我们只给很小一部分的病人预测y=1 现在我们把这个情况夸大一下 我们不再把临界值 设在0.7 我们把它设为0.9 我们只在至少90%肯定 这个病人患有癌症的情况下 预测y=1 那么这些病人当中 有非常大的比率 真正患有癌症 因此这是一个高查准率的模型 但是召回率会变低 因为我们希望能够正确检测患有癌症的病人 现在考虑一个不同的例子 假设我们希望 避免遗漏掉患有癌症的人 即我们希望避免假阴性 具体地说 如果一个病人实际患有癌症 但是我们并没有告诉他患有癌症 那这可能造成严重后果 因为 如果我们告诉病人他们没有患癌症 那么 他们就不会接受治疗 但是如果 他们患有癌症 我们又没有告诉他们 那么他们就根本不会接受治疗 那么 这么可能造成严重后果 病人丧失生命 因为我们没有告诉他患有癌症 他没有接受治疗 但事实上他又患有癌症 这种i情况下 我们希望预测y=1 我们希望 预测病人患有癌症 这样 他们会做进一步的检测 然后接受治疗 以避免他们真的患有癌症 在这个例子中 我们不再设置高的临界值 我们会设置另一个值 将临界值 设得较低 比如0.3 这样做 我们认为 他们有大于30%的几率 患有癌症 我们以更加保守的方式 告诉他们患有癌症 因此他们能够接受治疗 在这种情况下 我们会有一个 较高召回率的模型 因为 确实患有癌症的病人 有很大一部分 被我们正确标记出来了 但是 我们会得到较低的查准率 因为 我们预测患有癌症的病人比例越大 那么就有较大比例的人其实没有患癌症 顺带一提 当我在给 别的学生讲这个的时候 令人惊讶的是 有的学生问 怎么可以从两面来看这个问题 为什么我总是 只想要高查准率或高召回率 但是这看起来可以使两边都提高 但是我希望 算法是正确的 更普遍的一个原则是 这取决于你想要什么 你想要高查准率 低召回率 还是高召回率 低查准率 你可以预测y=1 当h(x)大于某个临界值 因此 总的来说 对于大多数的回归模型 你得权衡查准率和召回率 当你改变 临界值的值时 我在这儿画了一个 临界值 你可以画出曲线 来权衡查准率 和召回率 这里的一个值 反应出一个较高的临界值 这个临界值可能等于0.99 我们假设 只在有大于99%的确信度的情况下 才预测y=1 至少 有99%的可能性 因此这个点反应高查准率 低召回率 然而这里的一个点 反映一个较低的临界值 比如说0.01 毫无疑问 在这里预测y=1 如果你这么做 你最后会得到 很低的查准率 但是较高的召回率 当你改变临界值 如果你愿意 你可以画出回归模型的所有曲线 来看看你能得到的查准率和召回率的范围 顺带一提 查准率-召回率曲线可以是各种不同的形状 有时它看起来是这样 有时是那样 查准率-召回率曲线的形状 有很多可能性 这取决于回归模型的具体算法 因此这又产生了 另一个有趣的问题 那就是 有没有办法自动选取临界值 或者 更广泛地说 如果我们有不同的算法 或者不同的想法 我们如何比较不同的查准率和召回率呢？ 具体来说 假设我们有三个 不同的学习算法 或者这三个不同的学习曲线 是同样的算法 但是临界值不同 我们怎样决定哪一个算法是最好的 我们之前讲到的 其中一件事就是 评估度量值的重要性 这个概念是 通过一个具体的数字 来反映你的回归模型到底如何 但是查准率和召回率的问题 我们却不能这样做 因为在这里我们有两个可以判断的数字 因此 我们经常会 不得不面对这样的情况 如果我们正在试图比较算法1 和算法2 我们最后问自己 到底是0.5的查准率与 0.4的召回率好 还是说 0.7的查准率与 0.1的召回率好 或者每一次 你设计一个新算法 你都要坐下来思考 到底0.5 0.4好 还是说 0.7 0.1好 我不知道 如果你最后这样坐下来思考 这回降低 你的决策速度 思考到底哪些改变是有用的 应该被融入到你的算法 与此相反的是 如果我们有一个评估度量值 一个数字 能够告诉我们到底是算法1好还是算法2好 这能够帮助我们 更快地决定 哪一个算法更好 同时也能够更快地帮助我们 评估不同的改动 哪些应该被融入进算法里面 那么 我们怎样才能 得到这个评估度量值呢？ 你可能会去尝试的 一件事情是 计算一下查准率和召回率的平均值 用 P 和 R 来表示查准率和召回率 你可以做的是 计算它们的平均值 看一看哪个模型有最高的均值 但是这可能 并不是一个很好的解决办法 因为 像我们之前的例子一样 如果我们的回归模型 总是预测 y=1 这么做你可能得到非常高的召回率 得到非常低的查准率 相反地 如果你的模型 总是预测y=0 就是说 如果很少预测y=1 对应的 设置了一个高临界值 最后 你会得到非常高的 查准率和非常低的召回率 这两个极端情况 一个有非常高的临界值 一个有非常低的临界值 它们中的任何一个都不是一个好的模型 我们可以通过 非常低的查准率 或者非常低的召回率 判断这不是一个好模型 如果你只是使用(P+R)/2 算法3的这个值 是最高的 即使你可以通过 使用总是预测y=1这样的方法 来得到这样的值 但这并不是一个好的模型 对吧 你总是预测y=1 这不是一个有用的模型 因为它只输出y=1 那么算法1和 算法2 比算法3更有用 但是在这个例子中 查准率和召回率的平均值 算法3是最高的 因此我们通常认为 查准率和召回率的平均值 不是评估算法的一个好的方法 相反地 有一种结合查准率和召回率的不同方式 叫做F值 公式是这样 在这个例子中 F值是这样的 我们可以通过 F值来判断 算法1 有最高的F值 算法2第二 算法3是最低的 因此 通过F值 我们会在这几个算法中选择算法1 F值 也叫做F1值 一般写作F1值 但是人们一般只说F值 它的定义 会考虑一部分 查准率和召回率的平均值 但是它 会给查准率和召回率中较低的值 更高的权重 因此 你可以看到F值的分子 是查准率和召回率的乘积 因此如果查准率等于0 或者召回率等于0 F值也会 等于0 因此它结合了查准率和召回率 对于一个较大的F值 查准率 和召回率都必须较大 我必须说 有较多的公式 可以结合查准率和召回率 F值公式 只是 其中一个 但是出于历史原因 和习惯问题 人们在机器学习中使用F值 这个术语F值 没有什么特别的意义 所以不要担心 它到底为什么叫做F值或者F1值 但是它给了你 你需要的有效方法 因为无论是查准率等于0 还是召回率等于0 它都会得到一个很低的F值 因此 如果要得到一个很高的F值 你的算法的查准率和召回率都要接近于1 具体地说 如果P=0或者 R=0 你的F值也会等于0 对于一个最完美的F值 如果查准率等于1 同时召回率 也等于1 那你得到的F值 等于1乘以1 除以2再乘以2 那么F值 就等于1 如果你能得到最完美的查准率和召回率 在0和1中间的值 这经常是 回归模型最经常出现的分数 在这次的视频中 我们讲到了如何 权衡查准率和召回率 以及我们如何变动 临界值 来决定我们希望预测y=1 还是y=0 比如我们 需要一个 70%还是90%置信度的临界值 或者别的 来预测y=1 通过变动临界值 你可以控制权衡 查准率和召回率 之后我们讲到了F值 它权衡查准率和召回率 给了你一个 评估度量值 当然 如果你的目标是 自动选择临界值 来决定 你希望预测y=1 还是y=0 那么一个比较理想的办法是 试一试不同的 临界值 试一下 不同的临界值 然后评估这些不同的临界值 在交叉检验集上进行测试 然后选择哪一个临界值 能够在交叉检验集上 得到最高的F值 这是自动选择临界值的较好办法 较好办法 【教育无边界字幕组】翻译:御姐sama 校对/审核:所罗门捷列夫