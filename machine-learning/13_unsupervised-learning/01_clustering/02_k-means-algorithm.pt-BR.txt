Em problemas de agrupamento nos é fornecido um conjunto de dados não rotulados e  gostaríamos de ter um algoritmo que automaticamente agrupe os dados em subconjuntos coerentes ou em agrupamentos coerentes para nós. O algoritmo das K-médias é de longe o mais popular e o algoritmo de agrupamento mais utilizado. Neste vídeo vou demonstrar o algoritmo das K-médias e como ele funciona. O algoritmo de agrupamento das K-médias é melhor explicado com figuras. Digamos que eu queira pegar um conjunto de dados não rotulados, como este mostrado aqui, e deseje agrupar os dados em dois grupos. Se eu executar o algoritmo de agrupamento das K-médias, isto é o que vou fazer. O primeiro passo é inicializar aleatoriamente dois pontos, chamados de centróides dos grupos. Assim, estas duas cruzes aqui, serão chamadas de centróides do grupo. Eu tenho duas delas porque eu quero agrupar meus dados em dois grupos. O K-médias é um algoritmo iterativo e realiza dois passos. O primeiro é um passo de  atribuição de grupo e o segundo é  um passo de  movimentação do centróide. Vou explicar o que isso significa. O primeiro dos dois passos no laço do K-média é este passo de atribuição de grupo. O que isso significa é que ele visitará cada um dos exemplos, ou seja, cada um desses pontos verdes mostrados aqui e, dependendo deles estarem mais próximos do centróide vermelho ou do centróide azul, ele atribuirá cada um dos pontos de dados a um dos dois centróides dos grupos. Especificamente, o que quero dizer é que ele visitará o conjunto de dados e colorirá cada um dos pontos de vermelho ou de azul, dependendo do ponto estar mais próximo do centróide vermelho ou do centróide azul, como fiz neste diagrama aqui. Isto conclui o passo de atribuição de grupo. A outra parte do K-médias, no laço do K-médias, é o passo de movimentação do centróide. O que faremos aqui é pegar os dois centróides dos grupos, ou seja, a cruz vermelha e a cruz azul, e movê-las para a média dos pontos coloridos com a mesma cor. O que farei então é olhar em todos os pontos vermelhos e calcular a média das posições de todos os pontos vermelhos e depois mover o centróide vermelho para lá. Repetimos o mesmo para o centróide azul -- olhe todos os pontos azuis e calcule a média deles. Depois mova o centróide azul para lá. Vou fazer isso agora. Moveremos os centróides dos grupos desta forma. Agora eu os movi para suas novas médias. O vermelho moveu para cá e o azul moveu para lá e o vermelho moveu para cá. Agora vamos retornar para um outro passo de atribuição de grupo e cá estamos novamente olhando todos os exemplos não rotulados e dependendo deles estarem mais próximos aos centróides vermelho ou azul, eu os colorirei de vermelho ou de azul. Eu atribuirei cada ponto a um dos dois centróides de grupo. Note que as cores de alguns pontos mudaram. E, de novo, eu darei mais um passo de movimentação do centróide. Calcularei a média de todos os pontos azuis, depois a média de todos os pontos vermelhos e moverei meus centróides dessa forma. Vamos fazer isso novamente. Farei mais um passo de atribuição de grupo. Assim, eu coloro cada ponto de vermelho ou de azul, com base no que está mais próximo e depois dou mais um passo de movimentação do centróide e acabamos. Se você continuar executando mais iterações do K-médias, a partir daqui os centróides dos grupos não mudarão mais e as cores dos pontos não mudarão mais. mais. E assim, é neste ponto que o K-médias convergiu e fez um trabalho muito bom ao encontrar os dois agrupamentos destes dados. Vamos escrever o algoritmo das K-médias mais formalmente. O algoritmo das K-médias recebe duas entradas. Uma é um parâmetro K, que é o número de agrupamentos que se quer encontrar nos dados. Depois eu direi como nós tentaremos escolher k, mas por ora, digamos que já decidimos que queremos um certo número de grupos e diremos ao algoritmo quantos agrupamentos pensamos existir no conjunto de dados. O K-médias também recebe como entrada este tipo de conjunto de treinamento não rotulado contendo somente os x's e, como este é um aprendizado não supervisionado, não temos mais os rótulos dos y's. Para o aprendizado não supervisionado do K-médias, eu usarei a convenção de que x(i) é um vetor de dimensão n, razão pela qual meus exemplos de treinamento são agora vetores de dimensão n e não de dimensão n mais 1. Isto é o que o algoritmo das K-médias faz. O primeiro passo é inicializar aleatoriamente os K centróides dos agrupamentos, os quais chamaremos de μ1, μ2 até μk. No diagrama anterior, os centróides dos agrupamentos correspondem à posição da cruz vermelha e à posição da cruz azul. Como tínhamos apenas dois centróides, poderíamos chamar a cruz vermelha de μ1 e e a cruz azul de μ2. Em geral poderemos ter K centróides ao invés de apenas dois. Depois, o laço interno do K-médias faz o seguinte, faremos o seguinte repetidamente: Primeiro, para cada um dos exemplos de treinamento, eu definirei esta variável c(i) como um índice de 1 a K do centróide do agrupamento mais próximo de x(i). Assim, este é o meu passo de atribuição de grupo onde pegamos cada um dos meus exemplos e colorimos de vermelho ou de azul, dependendo de qual centróide está maix próximo. Assim, c(i) será um número de 1 a K K que me dirá se o x(i) está mais próximo da cruz vermelha ou da cruz azul. Uma outra forma de escrever isto é, para calcular c(i), pegarei o i-ésimo exemplo x(i) e medirei a distância dele a cada um dos meus centróides. Isto é o μ com o k minúsculo, pois o K maiúsculo é o número total de centróides. Eu usarei o k minúsculo aqui para indexar sobre os diferentes centróides. Assim, c(i) minimizará sobre todos os valores de k e encontrará o valor de k que minimiza esta distância entre x(i) e o centróide do agrupamento, depois disto, o valor de k que minimiza isto será usado como o valor de c(i). Assim, aqui está uma outra forma de escrever o que c(i) é. Se eu calcular a norma entre x(i) menos μk, ela será a distância entre meu i-ésimo exemplo de treinamento x(i) e o centróide μk do agrupamento, este aqui, escrito com k minúsculo. O K maiúsculo será usado para denotar o número total centróides dos agrupamentos. Esse k minúsculo é um número entre um e o K maiúsculo. Eu apenas estou usando o k minúsculo para indexar sobre os diferentes centróides. Assim, isto é a distância entre o exemplo e centróide do agrupamento. O que farei é encontrar o valor de k, o k minúsculo, que minimize isto e assim o valor de k que minimiza isso será o valor que usarei para definir c(i). Por convenção, eu escrevi a distância entre x(i) e o centróide do agrupamento, como sendo a distância quadrática. Podemos pensar em c(i) pegando o centróide do agrupamento com a menor distância quadrática em relação a meu exemplo de treinamento x(i). Naturalmente, minimizar a distância quadrática ou minimizar a distância deveria resultar no mesmo valor de c(i). Normalmente elevamos ao quadrado aqui, apenas seguindo a convenção usada por pessoas que utilizam o K-médias. Isto termina o passo de atribuição de grupo. O outro laço do K-médias realiza o passo de movimentação do centróide. E o que ele faz é pegar cada um dos centróides dos agrupamentos, tal que para k minúsculo variando de 1 a K faça μk igual à média dos pontos atribuídos ao agrupamento. Como um exemplo concreto, digamos que um dos meus centróides, digamos o centróide dois, tenha os exemplos de treinamento um, cinco, seis e dez atribuídos a ele. Isso quer dizer que c(1) é igual a dois, c(5) é igual a dois, c(6) é igual a dois, e similarmente c(10) é igual a dois, certo? Se recebermos isto do passo de atribuição de grupos, então isso significa que os exemplos um, cinco, seis e dez foram atribuídos ao centróide dois. Assim, neste passo de movimentação do centróide, o que estou fazendo é somente calcular a média destas quatro coisas. Ou seja, somar x(1) com x(5), x(6) e x(10). Agora, para tomar a média deles, como tenho quatro pontos atribuídos a este centróide, basta dividir a somatória por quatro. Agora μ2 será um vetor de dimensão n, pois cada um desses exemplos x1, x5, x6 e x10, cada um deles é um vetor com dimensão n, e eu os somarei juntos e depois dividirei por quatro, pois tenho quatro pontos atribuídos a este centróide,  eu concluo meu passo de movimentação de centróides, para o meu centróide μ2. Isto tem como efeito mover μ2 para a média dos quatro pontos listados aqui. Vamos falar agora sobre o número de agrupamentos. Seja μk a média dos pontos atribuídos ao agrupamento. Mas o que acontece se existir um centróide com nenhum ponto, com zero pontos atribuídos a ele? Nesse caso, a coisa mais comum a fazer é apenas eliminar esse centróide. Se fizermos isto, ficamos com K menos um agrupamentos ao invés de K agrupamentos. Às vezes, se você de fato precisar de K agrupamentos, então a outra coisa a ser feita se você tem um centróide com nenhum ponto atribuído a ele, é apenas reinicializar aleatoriamente esse centróide. Mas, é mais comum apenas eliminar um agrupamento se em algum lugar, durante o K-médias, existir um agrupamento com nenhum ponto atribuído a ele. Embora isso possa ocorrer, na prática, não é muito comum. Esse é o algoritmo das K-médias. Antes de encerrar este vídeo só quero comentar sobre uma outra aplicação comum do K-médias em problemas com agrupamentos não muito bem separados. O que eu quero dizer é Até agora temos retratado o K-médias aplicando-o a conjuntos de dados como aqueles mostrados aqui, onde temos três agrupamentos bem separados, e queremos um algoritmo capaz de encontrar talvez os 3 agrupamentos para nós. No entanto, com bastante frequência o K-médias é também aplicado a conjuntos de dados parecidos com este aqui, onde pode ser que não existam agrupamentos bem separados. Este é um exemplo de aplicação -- dimensionamento de camisetas. Digamos que você seja um fabricante de camisetas que foi até a população para a qual deseja vender as camisetas e você deseja vender as camisetas e exemplos da altura e peso das pessoas naquela população e, como sabemos, a altura e o peso tendem a ser correlacionados positivamente. Talvez você obtenha com um conjunto de dados como este, contendo uma amostra ou conjunto de exemplos dos pesos e alturas de diferentes pessoas. Digamos que você queira dimensionar suas camisetas. Digamos que eu queira confeccionar e vender camisetas de três tamanhos, pequeno, médio e grande. Que tamanho deveria ser a minha menor camiseta? Quão grande deveria ser a média? E  qual tamanho eu deveria confeccionar as minhas camisetas grandes? Uma forma de se fazer isto poderia ser executar o algoritmo de agrupamento K-médias sobre esse conjunto de dados mostrado a direita e talvez o que o K-médias fará é agrupar todos esses pontos em um agrupamento e agrupar todos estes pontos em um segundo agrupamento e agrupar todos aqueles pontos em um terceiro agrupamento. Assim, embora os dados de antemão não pareciam ter, encontramos 3 agrupamentos bem separados, o K-médias conseguiu separar os dados em múltiplos agrupamentos para você. Então o que você pode fazer é olhar para a primeira população de pessoas e, observando-as, prestando atenção na altura e peso, tentar confeccionar uma camisa pequena tal que ela sirva bem nas pessoas da primeira população e depois seguir a mesma ideia ao confeccionar camisetas médias ou grandes. O que vimos foi, de fato, um exemplo de segmentação de mercado, onde estamos usando o K-médias para dividir o mercado em 3 segmentos diferentes. Assim, você pode confeccionar um produto separadamente, ou seja, camisetas pequenas, médias ou grandes que tentam se adequar bem às necessidades de cada uma das três subpopulações separadamente. Esse é o algoritmo das K-médias. Nesse ponto, você deveria saber como implementar o algoritmo das K-médias e pô-lo para funcionar em alguns problemas. Nos próximos vídeos, o que quero fazer é entrar nos detalhes finos do K-médias e falar um pouco fazê-la funcionar realmente bem.