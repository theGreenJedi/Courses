En este video me gustaría hablar de un último detalle del algoritmo de agrupamiento K-means que es cómo elegir el número de agrupamientos o cómo elegir el valor del parámetro “K” mayúscula. Para ser sincero, no existe una manera de responder a esto o de hacerlo automáticamente y, por mucho, la manera más común de elegir el número de agrupamientos es seleccionarlos manualmente observando los gráficos o el resultado del algoritmo de agrupamiento o algo por el estilo. Pero, seguido me preguntan cómo elijo el número de agrupamientos, así que quiero decirles las tendencias actuales acerca de esto aunque la manera más común es elegir el número de agrupamientos a mano. Una gran parte de la razón por la cual no siempre es sencillo elegir el número de agrupamientos es que el número de agrupamientos en los datos datos es generalmente ambiguo. Si observan este conjunto de datos, algunos de ustedes verán cuatro agrupamientos. Esto sugeriría que “K” es igual a 4. Otros pueden ver dos agrupamientos y el valor de “K” sería 2. Quizá otros vean 3 agrupamientos. Al mirar un conjunto de datos como este, el número real de agrupamientos me parece verdaderamente ambiguo y no creo que haya una respuesta correcta. Esto es parte del aprendizaje supervisado. No tenemos valores asignados y no siempre hay una respuesta obvia. Esto es lo que hace más difícil tener un algoritmo automático para elegir el número de agrupamientos que tenemos. Cuando la gente habla de las maneras de elegir el numero de agrupamientos, uno de los métodos de los que hablan se llama el Método Elbow. Permítanme platicarles un poco acerca de él y luego mencionar algunas de sus ventajas y desventajas. En el Método Elbow, lo que intentamos hacer es variar “K”, que es el número total de agrupamientos. Ejecutaremos K-means con un agrupamiento. Esto significa que todo se agrupa en un solo agrupamiento y que se calcula la función de costos o la distorsión “J” y se trazará aquí. Ahora ejecutaremos K-means con dos agrupamientos y quizá incluyamos agentes iniciales múltiples aleatorios, o no. Como sabes, con dos agrupamientos deberíamos, con suerte, obtener una distorsión más pequeña y trazarla aquí. Luego ejecutaré k-means con tres agrupamientos y esperaré obtener una distorsión más pequeña y trazarla aquí. Ahora lo haré con cuatro, cinco, seis, etc. Terminaremos con una curva que muestra cómo disminuye la distorsión a medida que aumentamos los agrupamientos. Es una curva que se ve así. Si observas esta curva del Métod Elbow puedes ver la figura de un codo humano. Así es, esta es una analogía al brazo humano donde si te imaginas un brazo humano, este sería el hombro, esta la articulación del codo y la mano estaría aquí al final. Con el Método Elbow (de codo) te encontrarás con este tipo de patrones en los que la distorsión disminuye rápidamente de 1 a 2 y de 2 a 3 y luego llegas a un codo en el 3. Posteriormente la distorsión baja lentamente. Pareciera que usar tres agrupamientos es un buen número porque está en la curva del codo, ¿cierto? La distorsión baja rápidamente hasta “K” igual a 3 y después baja muy lentamente después. Elijamos, entonces “K” igual a 3. Si aplicas el Método Elbow y obtienes un trazo que se ve así, tienes un buen resultado y sería una manera razonable de elegir el número de agrupamientos. Resulta que el Método Elbow no se utiliza muy seguido. Una de las razones de esto es que si utilizas este método en un problema de agrupamiento, muy seguido acabaremos con una curva que es más ambigua. Quizá algo como esto. En esta curva quizá no haya un codo claro y parece que la distorsión baja continuamente. Quizá 3 sea un buen número, pero también 4. 5 no está mal. Si haces esto en la práctica y tu trazo es como el de la izquierda, está muy bien. Te da una respuesta clara pero, también, puedes terminar con un trazo como el de la derecha en el que no es claro cuál es la ubicación del codo. Se vuelve más difícil elegir un número de agrupamientos con este método. El resumen rápido del Método Elbow es que vale la pena intentarlo pero no necesariamente tendría altas expectativas de que funcione en un problema en particular. Finalmente, hay otra manera de elegir el valor de “K”. Seguido, la gente ejecuta el algoritmo K-means para un propósito posterior o para un propósito futuro. Quizá quieras utilizar K-means para realizar una segmentación de mercado como en el ejemplo de las tallas de camisetas que explicamos. Quizá quieres K-means para organizar mejor el agrupamiento de una computadora o un agrupamiento de aprendizaje para algún otro propósito. Si ese proceso futuro, como la segmentación de mercado, te da una métrica de evaluación, una mejor manera de determinar el número de agrupamientos es ver qué tan bien servirán los diferentes números de agrupamientos en el proceso futuro. Aquí les pondré un ejemplo específico. Utilizaré de nuevo el ejemplo de las camisetas y decidiré si quiero hacer camisetas de tres tallas. Entonces, “K” es igual a 3. Tendré camisetas pequeñas, medianas y grandes. También puedo elegir “K” igual a 5 para incluir las tallas extra chica, chica, mediana grande y extra grande. Puedes tener 3 tallas o 5 tallas. También podemos tener cuatro tallas de camisetas, pero mostraré tres y cinco aquí para simplificar esta diapositiva. Si ejecuto K-means con “K” igual a 3, quizá termine con mi talla chica aquí, la mediana esta en el medio y la grande arriba. Sin embargo, si ejecuto K-means con 5 agrupamientos, quizá tendré abajo las camisetas extra chicas, después las chicas, luego las medianas, después las grandes y aquí las extra grandes. Lo bueno de este ejemplo es que nos da otra manera de elegir si queremos 3 o 4 o 5 agrupamientos. Lo que puedes hacer, en particular, es pensar en esto desde el punto de vista del negocio de venta de camisetas y preguntarte: Si tengo cinco segmentos, ¿qué tan bien le quedarán mis camisetas a mis clientes? y, por lo tanto, ¿cuántas camisetas puedo vender? ¿Qué tan felices quedarán mis clientes? Tiene sentido ver esto desde la perspectiva del negocio de camisetas en cuanto a si quiero tener más tallas para que les queden mejor a mis clientes o si quiero tener menos tallas para fabricar menos tallas de camisetas y venderlas más baratas a mis clientes. El negocio de venta de camisetas puede darte la manera de decidir entre tres o cinco agrupamientos. Esto te da un ejemplo de un propósito futuro como el problema de decidir cuántas camisetas fabricar, y de cómo eso te puede dar una evaluación métrica para elegir el número de agrupamientos. Para aquellos que estén que están haciendo los ejercicios del programa, si observan el programa de ejercicios de esta semana relativo a K-means encontrarán el ejemplo del uso de K-means para la compresión de imágenes. Si intentas elegir cuántos agrupamientos utilizar para ese problema, puedes usar la métrica de evaluación de la compresión de imágenes para elegir el número de agrupamientos “K”. ¿Qué tan bien quieres que se vea la imagen en contraste con qué tanto quieres comprimir el tamaño de la imagen? Si haces el ejercicio de programación, lo que acabo de decir te resultará más coherente. Como resumen, generalmente, el número de agrupamientos “K” aún se elige manualmente por intervención o entendimiento humano. Una manera de intentar elegirlo es con el Método Elbow, pero yo no recomendaría esperar que funcione bien. Creo que la mejor manera de pensar es cómo elegir el número de agrupamientos es preguntarse cuál es el propósito para ejecutar K-means y luego pensar cuál es el número de agrupamientos K que sirve el propósito, cualquiera que este sea, por el cual ejecutas el algoritmo K-means.