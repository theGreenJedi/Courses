在这段视频中 我想讨论一下 K-均值聚类的最后一个细节 我想选择聚类数目的更好方法是 或者说是如何去选择 参数大写K的值 说实话 这个问题上没有一个 非常标准的解答 或者能自动解决它的方法 目前用来决定聚类数目的 最常用的方法 仍然是通过看可视化的图 或者看聚类算法的输出结果 或者其他一些东西来手动地决定聚类的数目 但是 我确实经常被别人问到 这样的问题 你是如何来选择聚类的数目的 我只能告诉你一些 人们现在对这个问题的思考 人们现在对这个问题的思考 尽管最为常见的方法 实际上仍是手动选择 聚类的数目 选择聚类的数目 可能不总是那么容易 可能不总是那么容易 大部分原因是 数据集中有多少个聚类通常是模棱两可的 看到这样一个数据集 有些人可能会看到 四个聚类 那么这就意味着需要使用 K=4 或者有些人可能 会看到两个聚类 这就意味着 K=2 可能其他人会看到3个聚类 那么 看到这样一个数据集 那么 看到这样一个数据集 在我看来它的真实的类别数 实际上确实是模棱两可的 所以我并不认为这里有一个正确答案 这就是无监督学习的一部分 没有给我们标签 所以不会总有一个清晰的答案 这是为什么 做一个能够自动选择 聚类数目的算法 是非常困难的原因之一 当人们讨论 选择聚类数目的方法时 可能会提及一个叫做 肘部法则 (Elbow Method) 的方法 现在我来介绍一下它 之后会提及到它的一些优点和缺点 那么对于肘部法则 我们所需要做的是改变K的值 也就是聚类类别的总数 我们用K值为1来运行K-均值聚类算法 这就意味着 所有的数据都会分到一个类里 然后计算代价函数 或者说计算畸变J 并将其画在这儿 然后我们选用两个聚类 来运行K-均值聚类算法 可能用了多个随机的初始中心 也可能没用 那么 有两个聚类的话 我们很可能得到 一个较小的畸变值 把它画在这儿 然后用三个聚类来运行K-均值聚类 你很有可能得到更小的畸变值 把它画在这儿 之后再让聚类数目等于4 5来运行K-均值聚类 最后我们就能 得到一条曲线 它展示了随着聚类数量的增多 畸变值是如何下降的 我们可能会得到一条这样的曲线 看到这条曲线 肘部法则会说 “我们来看这个图 这里看起来是一个很清楚的肘点” 对吧 这就类比于人的手臂 对吧 这就类比于人的手臂 如果你想象一下 伸出你的手臂 那么这就是你的肩关节 这就是你的肘关节 我想你的手就在末端这里 这就是肘部法则 你会发现这样一种模式 K从1变化到2 再从2到3时 畸变值迅速下降 然后在3的时候 到达一个肘点 此后畸变值就下降得非常慢 这样看起来 也许使用3个类 是聚类数目的正确选择 这是因为那个点 是曲线的肘点 就是说畸变值快速地下降 直到K等于3这个点 在这之后就下降得非常慢 那么我们就选K等于3 当你应用肘部法则的时候 如果你得到了一个 像这样的图 那么这非常好 这是一种用来 选择聚类个数的合理方法 而事实证明肘部法则 并不那么常用 其中一个原因是 如果你把这种方法 用到一个聚类问题上 事实上你最后得到的曲线 通常看起来 是更加模棱两可的 也许就像这样 如果你看这条曲线 我不知道 也许没有一个清晰的肘点 而畸变值像是连续下降的 也许3是一个好选择 也许4是一个好选择 也许5也不差 那么如果 你在实际应用中使用了这个 如果你的图像左边这个的话 那么就太好了 它给你一个清晰的答案 但是通常来说 你最后得到的图 是像右边的这样的 肘点的位置 并不明确 这使得用这个方法 来选择聚类数目变得较为困难 简单小结一下肘部法则 它是一个值得尝试的方法 但是我不会期待 它在任何问题上都有很高的表现 它在任何问题上都有很高的表现 最后 有另外一种方法 来考虑如何选择K的值 来考虑如何选择K的值 通常人们使用 K-均值聚类算法 是为了某些后面的用途 或者说某种下游的目的 而要求得一些聚类 也许你会用K-均值聚类算法 来做市场分割 如我们之前谈论的T恤尺寸的例子 也许你会用K-均值聚类来让 电脑的聚类变得更好 或者可能为了某些别的目的学习聚类 等等 或者可能为了某些别的目的学习聚类 等等 如果那个后续 下游的目的 比如市场分割 那能给你一个评估标准 那么通常来说 决定聚类数量的 更好的办法是 看不同的聚类数量能为 后续下游的目的提供多好的结果 我们来看一个具体的例子 我们再看一下 T恤尺寸这个例子 我想要决定 我是需要3种T恤尺寸么吗？ 所以我选择 K=3 我可能有小号 中号 大号三类T恤 或者我可以选择 K=5 或者我可以选择 K=5 那么我可能有 特小号 小号 中号 大号 和特大号尺寸的T恤 所以 你可能有3种 4种 或者5种T恤尺寸 我们也可以有4种T恤尺寸 但是我为了使这张幻灯片更简洁一些 但是我为了使这张幻灯片更简洁一些 只展示3种和5种这两个情况 因此如果我用 K=3 来运行K-均值聚类 我得到的结果可能是 这是小号 这是中号 这是大号 这是小号 这是中号 这是大号 然而 如果我用5个聚类 来运行K-均值聚类的话 我得到的结果可能是 那些是超小号T恤 这些是小号 那些是超小号T恤 这些是小号 这些是中号 这些是大号 这些是超大号 这个例子的好处是 它会给我们 选择聚类数目是3 4还是5 选择聚类数目是3 4还是5 的另一种方法 具体来说 你要做的是 从T恤生意的角度 来思考这个事情 然后问 “如果我有5个分段 那么我的T恤有多适合我的顾客？ 那么我的T恤有多适合我的顾客？ 我可以卖出多少T恤？ 我的顾客将会有多高兴呢？” 从T恤生意的角度去考虑 其中真正有意义的是 也就是我是需要 更多的T恤尺寸 来更好地满足我的顾客 还是说我需要 更少的T恤尺寸 我制造的T恤尺码就更少 我就可以将它们更便宜地卖给顾客 因此T恤的销售业务的观点 可能会提供给你一个 决定采用3个类还是5个类的方法 以上就是一个例子 后续下游目的 比如这个问题里的 决定生产什么样的T恤 怎样给我们一个 选择聚类数量的评价标准 对于那些在做 编程练习的同学来说 你去看一下这周的 K-均值聚类相关的编程练习 那是一个将K-均值用于图片压缩的例子 如果你想要选择 对这个问题 应该使用多少个聚类 我们可以再一次用 图片压缩的评估标准 来选择聚类数目K 你想要图片 看起来有多好 还是你想要将图片 压缩到多小 如果你做编程练习的话 到那时就能理解 我刚才所说的了 总结一下 大部分时候 聚类数目仍然是通过 手动 人工输入或我们的洞察力来决定 一种可以尝试的方法是 使用肘部法则 使用肘部法则 但是我不会总是 期望它能表现得好 我想选择聚类数目的更好方法是 我想选择聚类数目的更好方法是 去问一下你运行K-均值聚类 是为了什么目的？ 然后想一想 聚类的数目是多少 才适合你运行K-均值聚类的后续目的 才适合你运行K-均值聚类的后续目的【教育无边界字幕组】 翻译：星星之火 校对：竹二个 审核：Naplessss