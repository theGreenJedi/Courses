在大多数我们已经学到的 监督学习算法中 类似于线性回归 逻辑回归  以及更多的算法 所有的这些 算法都有一个优化目标函数 或者某个代价函数需要通过算法进行最小化 事实上 K均值也有 一个优化目标函数或者 需要最小化的代价函数 在这个视频中 我会 告诉大家这个优化目标函数是什么 我这么做有两方面的目的 具体来说 首先 了解什么是 K均值的优化目标函数 这将能帮助我们 调试学习算法 确保K均值算法 是在正确运行中 第二个也是最重要的一个目的是 在之后的视频中我们将讨论 我们该怎样运用这个来 帮助K均值找到更好的簇 并且避免局部最优解 不过我们在这节课之后的视频中 才会涉及到 另外顺便提一下 当K均值正在运行时 我们将对两组变量进行跟踪 首先是 c(i) 它表示的是 当前的样本 x(i) 所归为 的那个簇的索引或者序号 另外一组变量 我们用 μk 来表示 第 k 个簇的 聚类中心 (cluster centroid) 顺便再提一句 K均值中我们用大写 K 来表示簇的总数 用小写 k 来表示 聚类中心的序号 因此 小写 k 的范围 就应该是1到大写K之间 除此以外 还有另一个符号 我们用 μc(i) 来表示 x(i) 所属的那个簇 的聚类中心 我再稍微多解释一下 这个符号 假如说 x(i) 被划为了 第5个簇 这是什么意思呢？ 这个意思是 x(i) 的序号 也就是 c(i) 等于5 因为 c(i) = 5 表示的就是 x(i) 这个样本 被分到了第五个簇 因此 μ 下标 c(i) 就等于  μ5 因为 c(i) 就是5 所以 这里的 μc(i) 就是第5个簇的聚类中心 而也正是我的样本 x(i) 所属的第5个簇 有了这样的符号表示 现在我们就能写出 K均值聚类算法的 优化目标了 以下便是 K均值算法需要 最小化的代价函数 J 参数是 c(1) 到 c(m) 以及 μ1 到 μk 随着算法的执行过程 这些参数将不断变化 右边给出了优化目标 也就是所有的 1/m 乘以 i = 1 到 m 个项的求和 这里我用红色框出了这部分 也即每个样本 x(i) 到 x(i) 所属的 聚类簇的中心 距离的平方值 下面 我来解释一下 这是训练样本 x(i) 的位置 这是 x(i) 这个样本被划分到的 聚类簇的中心的位置 我们在图上解释一下 如果这是 x1 x2 并且如果这个点 是我的第 i 个样本 x(i) 那么 也就是说这个值等于 x(i) 并且 x(i) 被分到了 某一个聚类中心 我用一个叉来表示这个聚类中心 所以 如果我们假设 这个聚类中心是 μ5 也就是说 假如 x(i) 被分到第五个聚类簇 那么这个距离平方值 也就是点 x(i) 和 x(i) 被分配到的聚类中心的 距离的平方值 那么 K均值算法 要做的事情就是 它将找到参数 c(i) 和 μi 也就是说 找到能够最小化 代价函数 J 的 c 和 μ 这个代价函数 在K均值算法中 有时候也叫做 失真代价函数(distortion cost function) 再解释详细点 这是K均值算法 这跟我们之前得到的 算法是一样的 这个算法的第一步 就是聚类中心的分配 在这一步中 我们要把每一个点 划分给各自所属的聚类中心 可以用数学证明 这个聚类簇的划分步骤 实际上就是在 对代价函数 J 进行最小化 关于参数 c(1) c(2) 等等 一直到 c(m) 而保持最近的聚类中心 μ1 到 μk 固定不变 因此 第一步要做的 其实不是改变 聚类中心的位置 而是选择 c(1) c(2) 一直到 c(m) 来最小化这个代价函数 或者说失真函数 J 不难从数学的角度证明 但我在这里就不做了 但应该还是比较容易理解 这个过程就是把这些点 划分到离它们最近的 那个聚类中心 因为这样才会使得 点到对应聚类中心的距离最短 然后 另一部分 K-均值算法的第二步 这一部分的任务是 聚类中心的的移动 我依然不会证明这一步 但实际上是可以 在数学上来证明这一点 也就是说这一步 是选择了能够 最小化 J 的 μ 的值 也就是说 最小化代价函数 J 关于 这里的 wrt 表示 with respect to (关于) 因此是最小化 J 关于所有聚类中心的位置 μ1 到 μK 因此 K均值算法 实际上是把这两组变量 在这两部分中 分割开来考虑 分别最小化 J 首先是 c 作为变量 然后是 μ 作为变量 那么 K均值的工作就是 首先关于 c 求 J 的最小值 然后关于 μ 求 J 的最小值 然后反复循环 这就是 K均值算法 现在 我们已经理解了 K均值算法的原理 就是最小化代价函数 J 的过程 我们也可以用这个原理 来试着调试我们的学习算法 保证我们对 K均值算法的实现过程 是正确的 好的 这节课我们介绍了 K均值算法 其核心就是 对代价函数 J 的优化过程 代价函数 J 也被称为失真函数 我们可以用这个知识 来调试K均值算法 证明算法是否正在收敛 是否正在正常工作 在下一节视频中 我们将一起看看 如何帮助K均值找到更好的簇 同时避免局部最优解 【教育无边界字幕组】翻译：柳桦 校对/审核：所罗门捷列夫