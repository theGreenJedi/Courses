1
00:00:00,200 --> 00:00:01,390
このビデオでは、

2
00:00:01,570 --> 00:00:02,780
最後に残った一つの

3
00:00:03,350 --> 00:00:04,950
K-meansについての詳細である

4
00:00:05,450 --> 00:00:06,680
どうやってクラスタの数を選ぶのか、

5
00:00:06,770 --> 00:00:07,890
またはパラメータの大文字Kを

6
00:00:08,290 --> 00:00:09,160
どうやって選ぶのか、という事を議論する。

7
00:00:10,230 --> 00:00:12,310
正直に言うと、

8
00:00:12,390 --> 00:00:13,690
これについての素晴らしい解答は

9
00:00:13,760 --> 00:00:15,420
存在していない。

10
00:00:15,680 --> 00:00:17,150
これを自動で解決するような方法も。

11
00:00:17,820 --> 00:00:18,930
現在の所、もっとも一般的な

12
00:00:19,110 --> 00:00:20,380
クラスタ数の選び方は

13
00:00:20,520 --> 00:00:22,040
可視化した結果を見てか、

14
00:00:22,710 --> 00:00:24,380
クラスタアルゴリズムの結果を見てか、その他何かを見て、

15
00:00:24,450 --> 00:00:26,070
手動で選ぶという方法だ。

16
00:00:27,340 --> 00:00:28,270
だがどうやってクラスタ数を選ぶか

17
00:00:28,600 --> 00:00:29,460
という質問を

18
00:00:29,650 --> 00:00:30,510
ほんとに良く受けるので、

19
00:00:30,810 --> 00:00:31,930
現在のところの

20
00:00:32,240 --> 00:00:33,650
人々のこの件に関する考えを

21
00:00:33,850 --> 00:00:35,020
お話したい。

22
00:00:35,230 --> 00:00:36,480
といっても一番

23
00:00:36,740 --> 00:00:38,060
一般的に使われている方法は

24
00:00:38,180 --> 00:00:40,130
クラスタの総数を手動で選ぶ、という物だろうが。

25
00:00:42,230 --> 00:00:43,680
何故クラスタの総数を

26
00:00:43,800 --> 00:00:45,020
選ぶのがいつも簡単にはいかないかというと、

27
00:00:45,390 --> 00:00:46,530
その理由の大部分は

28
00:00:46,640 --> 00:00:47,940
そもそもにデータに幾つのクラスタがあるのか、というのは

29
00:00:48,190 --> 00:00:51,920
曖昧な事があるからだ。

30
00:00:52,940 --> 00:00:53,890
このデータセットを見てくれ。

31
00:00:54,080 --> 00:00:55,110
何人かは4つのクラスタに

32
00:00:55,380 --> 00:00:56,830
見えるかもしれない、その場合は

33
00:00:57,020 --> 00:00:59,440
K=4を提案する事になる。

34
00:00:59,620 --> 00:01:00,650
またある人々には

35
00:01:00,870 --> 00:01:02,620
二つのクラスタに見えるかもしれない。

36
00:01:02,730 --> 00:01:04,460
その場合はK=2を提案する事になる。

37
00:01:04,870 --> 00:01:06,630
または3つのクラスタに見えるかもしれない。

38
00:01:08,070 --> 00:01:09,710
つまり、こんなデータセットを

39
00:01:09,820 --> 00:01:10,750
見てみる場合、

40
00:01:10,920 --> 00:01:12,390
クラスタの総数は、

41
00:01:12,810 --> 00:01:14,560
これは本質的に曖昧に見える。

42
00:01:14,690 --> 00:01:17,160
そして一つの正しい正解があるようには思えない。

43
00:01:18,100 --> 00:01:19,500
これは教師無し学習という物の一部だ。

44
00:01:20,250 --> 00:01:21,450
ラベルが与えられていないので、

45
00:01:21,550 --> 00:01:23,950
明確な答えがいつもあるとは限らない。

46
00:01:24,830 --> 00:01:25,730
そしてこれが、

47
00:01:25,850 --> 00:01:26,710
幾つのクラスタが望ましいかを

48
00:01:27,340 --> 00:01:28,530
自動で決めるアルゴリズムを作るのが

49
00:01:29,160 --> 00:01:30,860
より難しい理由の一つである。

50
00:01:32,100 --> 00:01:33,250
人々がクラスタの総数を

51
00:01:33,320 --> 00:01:34,270
選ぶ方法を議論している時に、

52
00:01:34,840 --> 00:01:36,050
ちょくちょく出てくる方法に

53
00:01:36,440 --> 00:01:39,150
エルボー（肘）法というのがある。

54
00:01:39,630 --> 00:01:40,490
それについてちょっと説明しよう。

55
00:01:40,800 --> 00:01:43,760
そしてその後にその利点と欠点についても言及する。

56
00:01:44,690 --> 00:01:45,980
さて、エルボー法。

57
00:01:46,420 --> 00:01:47,570
我らがやる事は、

58
00:01:48,340 --> 00:01:49,860
Kを変化させていって、、、ここでKはクラスタの総数だ。

59
00:01:50,250 --> 00:01:51,570
そしてまず、K-meansを、1個のクラスタで実行する、

60
00:01:52,050 --> 00:01:53,340
それはつまり、全てを

61
00:01:53,630 --> 00:01:54,840
一つのクラスタにグルーピングして、

62
00:01:54,980 --> 00:01:56,530
そしてコスト関数または

63
00:01:56,660 --> 00:01:57,850
ディストーション関数であるJを計算して

64
00:01:58,460 --> 00:01:59,490
ここにプロットする、という事。

65
00:02:00,410 --> 00:02:01,090
次にK-meansを

66
00:02:01,310 --> 00:02:03,270
二つのクラスタに対して実行する、

67
00:02:03,610 --> 00:02:05,430
ランダムの初期化に対してかもしれないし、そうで無いかもしれない。

68
00:02:06,140 --> 00:02:07,150
なんにせよ、

69
00:02:07,280 --> 00:02:08,280
二つのクラスタに対しての方が

70
00:02:08,500 --> 00:02:09,510
ディストーションは小さくなる事が期待される、

71
00:02:10,710 --> 00:02:11,820
だからこんな感じにプロットしておく。

72
00:02:11,950 --> 00:02:13,100
そして次にK-meansを3つのクラスタに対して

73
00:02:13,310 --> 00:02:14,590
実行すると、期待される事としては

74
00:02:14,760 --> 00:02:16,680
より小さなディストーションとなる。それをここにプロットしておく。

75
00:02:16,990 --> 00:02:19,710
さらにK-meansを4、5などに対して走らせていく。

76
00:02:19,780 --> 00:02:20,790
最終的には、クラスタ数を

77
00:02:20,970 --> 00:02:22,840
増加させていくと、

78
00:02:23,240 --> 00:02:24,560
ディストーションが

79
00:02:24,800 --> 00:02:27,170
どう現象していくかを示す曲線となる。

80
00:02:27,440 --> 00:02:29,870
だから、こんな曲線が得られる。

81
00:02:31,390 --> 00:02:32,210
そしてこのカーブを見てみると、

82
00:02:32,300 --> 00:02:33,400
エルボー法がやる事は、

83
00:02:33,720 --> 00:02:35,770
「あー、このプロットを見て見てくれ、

84
00:02:36,450 --> 00:02:39,340
ここにエルボー（肘）っぽい形がはっきり見えるだろ？」と言ってる訳だ。

85
00:02:40,230 --> 00:02:41,620
つまり、これは人間の

86
00:02:41,830 --> 00:02:43,210
手みたいだ、という事だ。

87
00:02:43,550 --> 00:02:44,620
手を伸ばした所を

88
00:02:45,370 --> 00:02:46,460
想像してみると、

89
00:02:47,240 --> 00:02:48,940
これが肩の関節、

90
00:02:49,160 --> 00:02:50,340
これがエルボーの関節、

91
00:02:50,550 --> 00:02:52,960
そして手はここで終わる。

92
00:02:53,260 --> 00:02:54,170
だからこれはエルボー法と呼ばれる。

93
00:02:54,490 --> 00:02:55,930
そしてこの手のパターンが見つかったら、

94
00:02:56,250 --> 00:02:57,630
つまりディストーションが1から2、

95
00:02:58,550 --> 00:02:59,120
2から3へと急激に変化したら、

96
00:02:59,280 --> 00:03:01,330
そして3で肘に到達したら、

97
00:03:01,520 --> 00:03:03,160
そしてそこからディストーションが

98
00:03:03,330 --> 00:03:05,260
とてもゆっくりに低下したら、

99
00:03:05,430 --> 00:03:06,520
その場合はどうやら、

100
00:03:06,580 --> 00:03:08,700
三つのクラスタを使うのが

101
00:03:08,960 --> 00:03:09,920
クラスタの正しい

102
00:03:10,040 --> 00:03:11,340
総数かもしれない。

103
00:03:12,020 --> 00:03:14,430
何故ならそれがこの曲線の肘（エルボー）だからだ。でしょ？

104
00:03:14,700 --> 00:03:16,040
そこではディストーションは

105
00:03:16,250 --> 00:03:17,290
Kが3になるまで急激に減少していて、

106
00:03:17,610 --> 00:03:19,700
そこからはとても緩慢にしか減少しなくなる。

107
00:03:19,820 --> 00:03:20,850
だからK=3を選ぶ事としよう。

108
00:03:23,460 --> 00:03:24,570
もしエルボー法を適用して

109
00:03:25,110 --> 00:03:26,240
実際にこんな見た目の

110
00:03:26,540 --> 00:03:27,450
プロットが得られたなら、

111
00:03:27,890 --> 00:03:29,120
それはとてもグッド！

112
00:03:29,240 --> 00:03:30,160
これは合理的な

113
00:03:30,700 --> 00:03:32,590
クラスタの総数の決め方となる。

114
00:03:33,620 --> 00:03:34,600
実のところ、エルボー法は、

115
00:03:35,040 --> 00:03:37,170
そんなに良くは使われていない。

116
00:03:37,340 --> 00:03:38,270
その理由の一つには、

117
00:03:38,350 --> 00:03:39,470
実際にこれをクラスタの問題に

118
00:03:39,720 --> 00:03:41,060
使ってみると、

119
00:03:41,210 --> 00:03:42,640
かなりしばしば、

120
00:03:42,740 --> 00:03:43,610
もっと曖昧な、こんな感じの

121
00:03:43,910 --> 00:03:46,940
曲線が得られる事がある。

122
00:03:47,700 --> 00:03:48,370
もしこれを見たら、

123
00:03:48,920 --> 00:03:50,220
良く分からない。どうも、

124
00:03:50,390 --> 00:03:51,580
明確なエルボーは無く見える。

125
00:03:51,720 --> 00:03:53,090
ディストーションは連続的に低下していってるように見える。

126
00:03:53,440 --> 00:03:54,570
3が良い数かもしれないし、

127
00:03:54,620 --> 00:03:55,680
4かもしれない。

128
00:03:55,750 --> 00:03:58,180
5だって悪くないかもしれない。

129
00:03:58,390 --> 00:03:59,190
だからこれを実際に

130
00:03:59,600 --> 00:04:00,710
やってみると、

131
00:04:00,820 --> 00:04:02,690
もしプロットした結果が左側みたいだったら、それは素晴らしい。

132
00:04:03,400 --> 00:04:04,990
割と明確な答えを提供してくれている。

133
00:04:05,490 --> 00:04:06,550
でも同じくらいしばしば、

134
00:04:06,740 --> 00:04:07,580
右側みたいなプロットを

135
00:04:07,750 --> 00:04:09,020
得るはめにもなり、

136
00:04:09,110 --> 00:04:11,000
そこではどこが

137
00:04:11,790 --> 00:04:13,230
エルボーの場所なのか、あまりはっきりしない。

138
00:04:13,490 --> 00:04:14,440
その場合はこの手法を使って

139
00:04:14,640 --> 00:04:16,700
クラスタの数を決めるのはより難しい。

140
00:04:17,370 --> 00:04:18,220
つまり簡単にエルボー法について要約すると、

141
00:04:18,700 --> 00:04:20,500
一発試してみる価値はある、

142
00:04:21,010 --> 00:04:22,350
だがどんな問題にも

143
00:04:23,610 --> 00:04:24,700
とてもうまくいく、などと

144
00:04:24,870 --> 00:04:27,360
期待はしない方がいい。

145
00:04:29,880 --> 00:04:31,030
最後に、Kの値を決定する

146
00:04:31,300 --> 00:04:32,850
のに考えられる

147
00:04:32,990 --> 00:04:33,980
別の方法がある。

148
00:04:34,930 --> 00:04:36,030
だいたいは、人々は

149
00:04:36,310 --> 00:04:37,380
K-meansを、のちの問題で使う為の

150
00:04:37,530 --> 00:04:38,770
クラスタを得る為に用いる。

151
00:04:39,240 --> 00:04:40,880
言い換えるとある種の下流の目的の為に。

152
00:04:41,460 --> 00:04:42,900
K-meansを、マーケットの

153
00:04:43,380 --> 00:04:44,460
セグメンテーションの為に使いたいのかもしれない。

154
00:04:45,310 --> 00:04:47,600
ここまで話してきたTシャツの例のように。

155
00:04:48,140 --> 00:04:50,570
K-meansをコンピュータのクラスタを

156
00:04:51,130 --> 00:04:52,300
より良く構成する為に使いたいのかもしれない。

157
00:04:52,480 --> 00:04:53,430
または別の目的の為に

158
00:04:53,630 --> 00:04:55,070
クラスタを学習させたいのかもしれない。

159
00:04:55,450 --> 00:04:57,020
もしもあとに続く、下流の目的、

160
00:04:57,510 --> 00:04:59,050
マーケットのセグメンテーションのような物、

161
00:04:59,180 --> 00:05:00,420
もしそれが評価指標を与えてくれるなら、

162
00:05:01,310 --> 00:05:02,670
その場合はより良い

163
00:05:02,800 --> 00:05:03,890
クラスタ総数の決定方法は

164
00:05:03,960 --> 00:05:05,680
それぞれのクラスタ数が

165
00:05:06,010 --> 00:05:07,740
どれだけ下流の目的に

166
00:05:07,930 --> 00:05:10,140
うまく貢献出来るかを見てみる事だ。

167
00:05:11,230 --> 00:05:13,050
具体例を見ていこう。

168
00:05:14,190 --> 00:05:15,080
ここでもTシャツのサイズの例を

169
00:05:15,440 --> 00:05:17,420
見ていく事にする。

170
00:05:17,570 --> 00:05:19,700
三つのTシャツのサイズにしたいのか？

171
00:05:20,330 --> 00:05:22,320
そうなら、K=3を選ぶ、

172
00:05:22,560 --> 00:05:25,360
たぶんsmall、medium、largeのTシャツとなるだろう。

173
00:05:26,320 --> 00:05:27,250
またはK=5を選ぶかもしれない、

174
00:05:27,470 --> 00:05:28,240
その時は、

175
00:05:29,030 --> 00:05:30,140
extra small、small、

176
00:05:30,390 --> 00:05:33,130
medium、largeと

177
00:05:33,620 --> 00:05:35,070
extra largeのTシャツサイズとなるだろう。

178
00:05:35,860 --> 00:05:38,580
つまり、3つとか4つとか5つのTシャツサイズがあり得る。

179
00:05:39,270 --> 00:05:40,100
4つのTシャツのサイズはあり得るのだが、

180
00:05:40,430 --> 00:05:41,740
しかし便宜上、

181
00:05:41,930 --> 00:05:43,240
だが簡単の為、ここでは3と5を

182
00:05:43,490 --> 00:05:45,670
スライドをシンプルにする為見せておく。

183
00:05:46,930 --> 00:05:49,020
すると、K-MeansをK=3で

184
00:05:49,130 --> 00:05:50,290
走らせると、

185
00:05:50,670 --> 00:05:51,860
結果としては例えば

186
00:05:53,100 --> 00:05:55,020
ここがsmallで、

187
00:05:55,140 --> 00:05:56,720
ここがmedium、ここがlargeという感じになる。

188
00:05:58,580 --> 00:06:00,370
一方、5クラスタでK-meansを実行すると、

189
00:06:00,650 --> 00:06:03,540
結局得られるのは

190
00:06:03,700 --> 00:06:05,170
たとえば、

191
00:06:05,330 --> 00:06:07,400
これらがextra smallのTシャツ、

192
00:06:07,740 --> 00:06:10,920
これらがsmall、これらがmedium、

193
00:06:11,050 --> 00:06:13,740
これらがlarge、

194
00:06:13,990 --> 00:06:17,110
これらがextra largeだ。

195
00:06:19,320 --> 00:06:20,150
そしてこの例で良い事として、

196
00:06:20,320 --> 00:06:21,510
これはまた、

197
00:06:21,810 --> 00:06:22,940
3か4か5個のクラスターを

198
00:06:23,550 --> 00:06:24,730
選ぶ、もう一つの方法を

199
00:06:24,970 --> 00:06:26,070
与える。

200
00:06:28,570 --> 00:06:29,630
具体的には、

201
00:06:29,730 --> 00:06:30,630
行える事は、

202
00:06:30,810 --> 00:06:31,770
Tシャツビジネスの観点から

203
00:06:32,380 --> 00:06:33,810
この事を考えてみて、

204
00:06:34,320 --> 00:06:35,150
こう問うてみる事だ：「うーん、もし私が

205
00:06:35,620 --> 00:06:37,190
5つの顧客セグメントを持ったとしたら、

206
00:06:38,060 --> 00:06:39,610
どれだけの顧客に私のTシャツはフィットして、

207
00:06:39,780 --> 00:06:42,100
どれだけの数私のTシャツは売れるのか？

208
00:06:42,420 --> 00:06:44,390
私の顧客は、どれだけ幸せだろうか？」と。

209
00:06:44,550 --> 00:06:45,920
Tシャツビジネスの観点から

210
00:06:46,080 --> 00:06:47,530
何が最も説得力があるか、

211
00:06:47,590 --> 00:06:49,390
私は自分たちのTシャツが

212
00:06:49,520 --> 00:06:51,480
顧客にフィットするように

213
00:06:51,990 --> 00:06:54,040
より多くのサイズがある事を望んでいるのか、

214
00:06:54,970 --> 00:06:56,130
それともTシャツのサイズを少なくして

215
00:06:56,360 --> 00:06:57,570
作らなくてはいけない

216
00:06:58,410 --> 00:07:00,220
Tシャツのサイズを減らしたいのか。

217
00:07:00,610 --> 00:07:02,290
そうして顧客にTシャツをもっと安く売りたいのか。

218
00:07:02,840 --> 00:07:04,700
つまり、Tシャツを売るビジネスという観点が

219
00:07:05,040 --> 00:07:06,150
3つのクラスタと5つのクラスタの

220
00:07:06,660 --> 00:07:09,260
どちらを選ぶのかを決める方法を、提供してくれるかもしれない。

221
00:07:10,780 --> 00:07:12,000
以上が、下流でどう使うかの目的が

222
00:07:12,480 --> 00:07:13,880
例えばどんなTシャツを作るか、とかが、

223
00:07:14,130 --> 00:07:15,810
クラスタ数を選ぶ為に

224
00:07:16,010 --> 00:07:17,260
クラスタの数を評価する

225
00:07:17,390 --> 00:07:19,230
指標を与えてくれる事が

226
00:07:19,380 --> 00:07:21,980
どんな風にありうるかの例だ。

227
00:07:22,900 --> 00:07:23,800
プログラムの課題を

228
00:07:23,880 --> 00:07:25,490
やってる人なら、

229
00:07:25,670 --> 00:07:27,070
もし今週のK-meansに関する

230
00:07:27,290 --> 00:07:29,540
プログラムの課題を見てみたら、

231
00:07:29,790 --> 00:07:32,000
そこにはK-meansを画像圧縮に使う例がある。

232
00:07:32,910 --> 00:07:33,960
そこでは、どれだけの数のクラスタを

233
00:07:34,070 --> 00:07:35,170
その問題に使うべきかを

234
00:07:35,410 --> 00:07:36,950
選ぼうとするなら、

235
00:07:37,260 --> 00:07:38,550
そこでもまた、画像圧縮の

236
00:07:39,030 --> 00:07:40,330
評価指標を使って、

237
00:07:40,890 --> 00:07:42,470
クラスターの総数Kを選ぶ事になる。

238
00:07:43,130 --> 00:07:43,870
つまり、どれだけ画像を

239
00:07:44,000 --> 00:07:45,430
良く保ちたいかと、

240
00:07:45,680 --> 00:07:46,680
どれだけ画像のファイルサイズを

241
00:07:46,970 --> 00:07:48,390
圧縮したいのか。

242
00:07:48,610 --> 00:07:49,830
実際にプログラムの

243
00:07:50,050 --> 00:07:50,980
課題をやったら、

244
00:07:51,160 --> 00:07:52,480
今私の言った事がもっと良く分かるだろう。

245
00:07:53,760 --> 00:07:56,500
ではまとめだ。

246
00:07:56,590 --> 00:07:57,800
大多数のケースで、

247
00:07:58,030 --> 00:07:59,560
クラスター数Kを選ぶのは

248
00:08:00,150 --> 00:08:01,900
未だに手動で、人間による入力または洞察によって為されている。

249
00:08:02,800 --> 00:08:03,810
クラスター数を選ぶ一つの方法としては

250
00:08:03,950 --> 00:08:05,010
エルボー法を

251
00:08:05,170 --> 00:08:06,360
使うという物だ。

252
00:08:06,520 --> 00:08:07,660
だがそれはいつもうまくいく、と期待出来るほどの物じゃない。

253
00:08:07,760 --> 00:08:08,620
それよりも、

254
00:08:08,820 --> 00:08:09,730
クラスターの数を選ぶ

255
00:08:09,970 --> 00:08:10,800
より良い方法と考えられるのは、

256
00:08:10,920 --> 00:08:12,310
どういう目的であなたが

257
00:08:12,520 --> 00:08:13,890
K-meansを実行しているのか、という事を問うてみる事だ。

258
00:08:15,490 --> 00:08:16,610
そしてどんな

259
00:08:16,830 --> 00:08:18,210
クラスターの数Kが、

260
00:08:18,350 --> 00:08:19,490
K-meansを走らせる目的となっている

261
00:08:19,670 --> 00:08:21,710
あとに続く問題にーーそれがなんであれーーうまく寄与するかを。