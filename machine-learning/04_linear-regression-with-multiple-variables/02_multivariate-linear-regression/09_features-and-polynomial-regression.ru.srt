1
00:00:00,200 --> 00:00:03,878
Теперь вы знаете о линейной  регрессии с несколькими переменными

2
00:00:03,910 --> 00:00:05,185
В этом видео я расскажу

3
00:00:05,185 --> 00:00:06,369
немного о выборе

4
00:00:06,380 --> 00:00:07,830
параметров и о том,

5
00:00:07,830 --> 00:00:09,742
как выбор нужного параметра

6
00:00:09,750 --> 00:00:11,477
позволяет получить иной обучающий

7
00:00:11,477 --> 00:00:13,803
алгоритм, порой очень действенный.

8
00:00:13,810 --> 00:00:15,229
В частности, я расскажу о полиномиальной

9
00:00:15,229 --> 00:00:17,826
регрессии, которая

10
00:00:17,826 --> 00:00:19,535
позволяет использовать

11
00:00:19,535 --> 00:00:21,247
механизм линейной регрессии даже в случаях с очень сложными нелинейными

12
00:00:21,247 --> 00:00:25,060
функциями.

13
00:00:25,690 --> 00:00:28,827
Давайте рассмотрим пример с определением цены на дом.

14
00:00:29,300 --> 00:00:31,147
Пусть будет 2 параметра: это протяженность

15
00:00:31,147 --> 00:00:33,805
дома по фасаду и его протяженность вглубь участка.

16
00:00:33,805 --> 00:00:35,428
Здесь представлено изображение дома, который мы пытаемся продать.

17
00:00:35,428 --> 00:00:37,264
Протяженность по

18
00:00:37,264 --> 00:00:40,103
фасаду - это расстояние,

19
00:00:40,103 --> 00:00:43,009
представляющее собой ширину

20
00:00:43,009 --> 00:00:44,949
или длину

21
00:00:44,960 --> 00:00:46,652
вашего

22
00:00:46,652 --> 00:00:47,994
владения, а

23
00:00:48,020 --> 00:00:49,468
протяженность вглубь - это его "глубина".

24
00:00:49,500 --> 00:00:53,120
Таким образом, есть длина, а

25
00:00:53,130 --> 00:00:54,758
есть

26
00:00:54,770 --> 00:00:57,992
глубина,

27
00:00:57,992 --> 00:00:59,858
которые мы называем протяженность дома по фасаду и протяженность дома вглубь, соответственно.

28
00:00:59,858 --> 00:01:01,355
Вы можете построить подобную линейную

29
00:01:01,360 --> 00:01:04,163
регрессионную модель, где протяженность дома

30
00:01:04,180 --> 00:01:06,062
по фасаду будет первой

31
00:01:06,062 --> 00:01:07,535
переменной х1, глубина - второй

32
00:01:07,535 --> 00:01:10,169
переменной х2. Но в случае, если вы

33
00:01:10,169 --> 00:01:11,772
применяете линейную регрессию, вам не обязательно использовать

34
00:01:11,772 --> 00:01:13,342
только эти две

35
00:01:13,342 --> 00:01:16,607
переменные.

36
00:01:16,610 --> 00:01:20,531
Вы можете создать новые переменные.

37
00:01:20,531 --> 00:01:21,709
Итак, если мне нужно определить

38
00:01:21,710 --> 00:01:22,895
стоимость дома, я прежде

39
00:01:22,895 --> 00:01:24,840
всего определю размер дома,

40
00:01:24,850 --> 00:01:27,468
который будет выражаться размером

41
00:01:27,490 --> 00:01:29,133
моего земельного

42
00:01:29,133 --> 00:01:32,164
владения.

43
00:01:32,190 --> 00:01:33,365
Так, я могу ввести новую переменную.

44
00:01:33,380 --> 00:01:34,609
Назовем её Х. Х выражает произведение

45
00:01:34,609 --> 00:01:40,409
длины на глубину.

46
00:01:40,440 --> 00:01:42,404
Это символ умножения.

47
00:01:42,404 --> 00:01:44,334
То есть, произведение длины

48
00:01:44,334 --> 00:01:46,040
на глубину

49
00:01:46,090 --> 00:01:48,035
даст размер земельного владения, и я,

50
00:01:48,035 --> 00:01:50,651
возможно, смогу сделать предположение о

51
00:01:50,710 --> 00:01:53,327
цене, опираясь лишь на одну переменную, а именно

52
00:01:53,350 --> 00:01:54,785
величину земельного владения,

53
00:01:54,785 --> 00:01:57,430
верно?

54
00:01:57,580 --> 00:01:58,939
Потому что площадь прямоугольника - это,

55
00:01:58,940 --> 00:02:00,345
как вы знаете,

56
00:02:00,345 --> 00:02:01,432
произведение длины на

57
00:02:01,460 --> 00:02:03,822
ширину. Таким образом,

58
00:02:03,822 --> 00:02:05,253
понимая суть задачи и вводя

59
00:02:05,280 --> 00:02:07,481
новые параметры, вы можете

60
00:02:07,490 --> 00:02:09,604
получить гораздо более эффективную

61
00:02:09,620 --> 00:02:11,103
модель, нежели используя

62
00:02:11,130 --> 00:02:13,489
переменные [хх], которые

63
00:02:13,489 --> 00:02:16,771
мы обозначили в самом начале.

64
00:02:16,790 --> 00:02:18,163
Непосредственную связь с

65
00:02:18,163 --> 00:02:19,745
идеей выбора параметров

66
00:02:19,745 --> 00:02:22,973
имеет полиномиальная регрессия.

67
00:02:23,010 --> 00:02:26,868
Допустим, у вас есть данные о ценах на жилье, которые выглядят вот так.

68
00:02:26,880 --> 00:02:29,646
Затем, у вас есть несколько различных моделей, которые можно использовать с этим данным.

69
00:02:29,660 --> 00:02:32,587
Одна из них - это квадратичная модель, как здесь.

70
00:02:32,600 --> 00:02:35,598
Очевидно, что прямая линия не вполне подходит к этим данным.

71
00:02:35,598 --> 00:02:36,788
Поэтому вы можете решить, что

72
00:02:36,788 --> 00:02:38,408
квадратичная модель хорошо

73
00:02:38,420 --> 00:02:40,248
опишет цену дома,

74
00:02:40,248 --> 00:02:42,017
что цена дома - квадратичная

75
00:02:42,020 --> 00:02:43,956
функция, и что такая

76
00:02:43,970 --> 00:02:45,018
модель даст нам

77
00:02:45,020 --> 00:02:47,070
примерно такую кривую, которая хорошо аппроксимирует данные.

78
00:02:47,280 --> 00:02:48,560
Но затем вы можете решить,

79
00:02:48,570 --> 00:02:50,013
что квадратичная

80
00:02:50,013 --> 00:02:52,582
функция - это все

81
00:02:52,582 --> 00:02:53,858
таки неправильно,

82
00:02:53,858 --> 00:02:55,591
так как такая функция в

83
00:02:55,600 --> 00:02:58,899
итоге начнет убывать. Вряд ли цена жилья должна быть меньше, если его размер слишком велик.

84
00:02:58,970 --> 00:03:00,649
Возможно, затем мы

85
00:03:00,650 --> 00:03:02,700
выберем другую

86
00:03:02,700 --> 00:03:04,274
полиномиальную модель, например,

87
00:03:04,290 --> 00:03:07,480
будем использовать кубическую функцию и

88
00:03:07,480 --> 00:03:09,225
член третьего порядка.

89
00:03:09,225 --> 00:03:10,764
Применив ее, мы получим вот такую модель,

90
00:03:10,800 --> 00:03:12,367
где зеленая линия, возможно, лучше

91
00:03:12,390 --> 00:03:13,907
отразит

92
00:03:13,910 --> 00:03:15,278
наши данные, поскольку не будет

93
00:03:15,278 --> 00:03:18,052
стремиться вниз.

94
00:03:18,052 --> 00:03:21,992
Так как же мы сможем приспособить подобную модель к нашим данным?

95
00:03:22,020 --> 00:03:23,868
Используя механизм линейной регрессии с

96
00:03:23,868 --> 00:03:27,059
несколькими переменными, мы сможем

97
00:03:27,059 --> 00:03:30,692
сделать это лишь незначительно изменив наш алгоритм.

98
00:03:30,692 --> 00:03:32,632
Тогда наша гипотеза

99
00:03:32,632 --> 00:03:34,217
примет

100
00:03:34,217 --> 00:03:35,782
следующий

101
00:03:35,782 --> 00:03:37,612
вид:

102
00:03:37,612 --> 00:03:41,608
Н (х) = θ0 + θ1 x1 + θ 2 x2 + θ 3 x3

103
00:03:41,608 --> 00:03:42,775
А если мы хотим применить кубическую

104
00:03:42,775 --> 00:03:45,220
модель, которую я

105
00:03:45,250 --> 00:03:47,239
обвел зеленым, к

106
00:03:47,239 --> 00:03:48,940
определению цены

107
00:03:48,940 --> 00:03:49,825
дома, то это будет

108
00:03:49,825 --> 00:03:51,364
выглядеть следующим

109
00:03:51,364 --> 00:03:53,056
образом: θ0 + θ1 * размер дома + θ2 *

110
00:03:53,056 --> 00:03:55,905
размер дома в квадрате.

111
00:03:55,910 --> 00:03:58,974
Итак, этот член равен тому члену.

112
00:03:58,974 --> 00:04:00,885
А затем, плюс θ3 * размер

113
00:04:00,890 --> 00:04:02,343
дома в кубе, что в итоге даст

114
00:04:02,350 --> 00:04:05,302
третий член.

115
00:04:05,470 --> 00:04:06,967
Чтобы соотнести эти два

116
00:04:06,990 --> 00:04:08,668
определения, необходимо

117
00:04:08,668 --> 00:04:10,339
первой переменной

118
00:04:10,339 --> 00:04:12,128
Х1 присвоить значение

119
00:04:12,150 --> 00:04:13,568
размера дома, второй - Х2 -

120
00:04:13,568 --> 00:04:15,320
размер

121
00:04:15,320 --> 00:04:16,721
дома, возведенный в

122
00:04:16,721 --> 00:04:17,766
квадрат, а

123
00:04:17,766 --> 00:04:20,400
третьей - Х3 - размера дома, возведенный

124
00:04:20,400 --> 00:04:22,780
в куб.

125
00:04:22,800 --> 00:04:24,292
То есть, я могу приспособить

126
00:04:24,292 --> 00:04:26,311
эту модель к моим

127
00:04:26,311 --> 00:04:27,720
данным, просто выбрав

128
00:04:27,720 --> 00:04:30,540
три переменные и

129
00:04:30,540 --> 00:04:31,901
применив механизм

130
00:04:31,901 --> 00:04:34,374
линейной регрессии.

131
00:04:34,374 --> 00:04:35,523
Особо хочу отметить, что

132
00:04:35,523 --> 00:04:36,799
если вы выбираете

133
00:04:36,800 --> 00:04:38,610
ваши параметры подобным

134
00:04:38,610 --> 00:04:40,925
образом, то вы должны

135
00:04:40,925 --> 00:04:43,688
быть очень осторожны со значениями.

136
00:04:44,130 --> 00:04:45,254
К примеру,

137
00:04:45,254 --> 00:04:46,794
если размер дома

138
00:04:46,800 --> 00:04:47,992
варьируется от 1 до 1000

139
00:04:47,992 --> 00:04:49,300
квадратных футов, то размер

140
00:04:49,310 --> 00:04:50,918
дома, возведенный в

141
00:04:50,930 --> 00:04:52,175
квадрат,

142
00:04:52,175 --> 00:04:54,519
варьируется от 1 до 1 млн, а

143
00:04:54,520 --> 00:04:55,953
третья

144
00:04:55,953 --> 00:04:58,468
переменная, х3, - размер дома в кубе, даст диапазон от 1 до 10 в 9 степени.

145
00:04:58,490 --> 00:05:01,335
Итак, эти

146
00:05:01,360 --> 00:05:03,106
три переменных

147
00:05:03,120 --> 00:05:04,732
будут принимать

148
00:05:04,732 --> 00:05:05,941
диапазоны

149
00:05:05,950 --> 00:05:07,478
очень разных

150
00:05:07,478 --> 00:05:09,311
значений, поэтому

151
00:05:09,330 --> 00:05:10,955
если вы используете градиентный спуск, то очень трудно

152
00:05:10,955 --> 00:05:13,459
использовать

153
00:05:13,490 --> 00:05:15,105
масштабирование переменных,

154
00:05:15,110 --> 00:05:16,509
чтобы их значения

155
00:05:16,509 --> 00:05:18,554
оказались в похожих

156
00:05:18,554 --> 00:05:21,139
диапазонах.

157
00:05:21,140 --> 00:05:23,243
И последний пример

158
00:05:23,250 --> 00:05:25,138
покажет то, насколько широк выбор

159
00:05:25,150 --> 00:05:29,056
параметров, которые вы можете использовать.

160
00:05:29,090 --> 00:05:30,446
Ранее мы обсуждали то, что хотя

161
00:05:30,446 --> 00:05:31,559
квадратичная модель и

162
00:05:31,559 --> 00:05:33,122
будет подходить к

163
00:05:33,122 --> 00:05:34,408
данным, она может быть не идеальной в

164
00:05:34,408 --> 00:05:35,952
силу того, что квадратичная

165
00:05:35,952 --> 00:05:37,514
функция начинает убывать, а

166
00:05:37,514 --> 00:05:39,065
мы совсем не хотим,

167
00:05:39,070 --> 00:05:40,352
чтобы наша кривая

168
00:05:40,352 --> 00:05:43,567
предсказывала уменьшение цены жилья при увеличении его размера.

169
00:05:43,567 --> 00:05:45,388
Но вместо того, чтобы

170
00:05:45,388 --> 00:05:46,938
перейти к кубической

171
00:05:46,938 --> 00:05:48,389
модели, вы

172
00:05:48,389 --> 00:05:50,798
можете рассмотреть и другие параметры, которых огромное множество.

173
00:05:50,800 --> 00:05:52,313
Другой

174
00:05:52,313 --> 00:05:53,691
пример

175
00:05:53,691 --> 00:05:55,620
разумного выбора, это,

176
00:05:55,620 --> 00:05:57,263
например, следующая

177
00:05:57,263 --> 00:05:58,832
формула цены

178
00:05:58,850 --> 00:05:59,992
дома: θ0 + θ1 * размер + θ2 *

179
00:05:59,992 --> 00:06:01,264
квадратный корень из

180
00:06:01,320 --> 00:06:03,625
размера.

181
00:06:03,630 --> 00:06:05,364
Таким образом, квадратный корень

182
00:06:05,364 --> 00:06:08,110
является такой функцией, и, возможно,

183
00:06:08,110 --> 00:06:09,318
найдутся значения θ1, θ2, θ3, которые

184
00:06:09,318 --> 00:06:11,355
позволят вам применить

185
00:06:11,355 --> 00:06:14,049
эту модель. То есть, в целом

186
00:06:14,080 --> 00:06:15,445
кривая будет стремиться

187
00:06:15,445 --> 00:06:16,952
вверх,

188
00:06:16,952 --> 00:06:19,500
немного выравниваться,

189
00:06:19,520 --> 00:06:21,529
но никогда не

190
00:06:21,540 --> 00:06:23,877
будет возвращаться вниз.

191
00:06:24,154 --> 00:06:26,584
Таким образом, если

192
00:06:26,584 --> 00:06:27,630
знать форму графиков функций,

193
00:06:27,630 --> 00:06:30,952
в данном случае, функции

194
00:06:30,990 --> 00:06:32,555
квадратного корня, и

195
00:06:32,555 --> 00:06:36,469
знать форму имеющихся данных, то выбирая различные параметры, иногда можно подобрать более удачные модели.

196
00:06:36,469 --> 00:06:39,026
В этом курсе мы говорили о полиномиальной регрессии.

197
00:06:39,026 --> 00:06:40,672
О том, как подобрать многочлен вроде

198
00:06:40,672 --> 00:06:42,298
квадратичной или

199
00:06:42,298 --> 00:06:43,868
кубической функции для аппроксимации ваших данных.

200
00:06:43,868 --> 00:06:45,112
Также была озвучена идея о

201
00:06:45,112 --> 00:06:46,640
том, что можно использовать

202
00:06:46,640 --> 00:06:47,732
различные параметры.

203
00:06:47,748 --> 00:06:48,804
Например, от использования в качестве

204
00:06:48,804 --> 00:06:50,078
переменных длины и ширины фасада здания перейти к

205
00:06:50,078 --> 00:06:51,092
их произведению –

206
00:06:51,092 --> 00:06:53,133
переменной, описывающей

207
00:06:53,133 --> 00:06:55,317
площадь земельного участка под зданием.

208
00:06:55,317 --> 00:06:57,551
Разнообразие параметров немного

209
00:06:57,551 --> 00:06:58,895
сбивает с толку, поскольку

210
00:06:58,896 --> 00:07:03,265
нужно решить, какие именно параметры мы будем использовать.

211
00:07:03,265 --> 00:07:04,594
Позже мы поговорим об алгоритмах,

212
00:07:04,594 --> 00:07:06,622
которые автоматически

213
00:07:06,622 --> 00:07:08,083
выбирают нужные параметры.

214
00:07:08,083 --> 00:07:09,466
То есть алгоритм

215
00:07:09,466 --> 00:07:10,611
анализирует данные и

216
00:07:10,611 --> 00:07:12,040
позволяет вам на выбор

217
00:07:12,040 --> 00:07:13,357
аппроксимировать их

218
00:07:13,357 --> 00:07:15,528
квадратичной либо кубической зависимостью или чем-то еще.

219
00:07:15,528 --> 00:07:17,164
Но пока мы не добрались до

220
00:07:17,164 --> 00:07:18,764
таких алгоритмов, я

221
00:07:18,764 --> 00:07:20,295
лишь хочу, чтобы вы имели представление о

222
00:07:20,295 --> 00:07:21,582
том, что у вас есть выбор, какие

223
00:07:21,582 --> 00:07:23,094
параметры использовать.

224
00:07:23,094 --> 00:07:25,256
Создавая различные параметры, вы

225
00:07:25,256 --> 00:07:26,888
можете приспособить к вашим

226
00:07:26,888 --> 00:07:28,156
данным более сложные

227
00:07:28,156 --> 00:07:30,471
функции, чем

228
00:07:30,471 --> 00:07:32,092
использование прямых. В частности,

229
00:07:32,092 --> 00:07:35,065
вы можете использовать

230
00:07:35,065 --> 00:07:36,072
полиномальные функции

231
00:07:36,072 --> 00:07:37,564
и, выбирая

232
00:07:37,564 --> 00:07:40,020
наиболее подходящие параметры, создавать более удачные модели.