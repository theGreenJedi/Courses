Nesse e no próximo vídeo, quero contar para vocês alguns truques para melhorar o Gradiente Descendente. Nesse vídeo, vou falar sobre "Dimensionamento das Variáveis". Aqui está a ideia: Se você tiver um problema com múltiplas variáveis, se você tiver certeza que elas estão numa escala parecida, ou seja, as diferentes variáveis assumem faixa de valores similares, então, o Gradiente Descendente convergirá mais rapidamente. Por exemplo, digamos que você tenha um problema com duas variáveis, onde "x1" é o tamanho da casa, e assume valores entre "0" e "2000". E "x2" é o número de quartos, e assume valores entre "1" e "5". Se você desenha as curvas de nível da função de custo "J(θ)", o desenho deve ter essa aparência, onde "J(θ)" é uma função parametrizada por "θ0", "θ1" e "θ2". Eu vou ignorar "θ0", vamos esquecer "θ0", e fingir que "J(θ)" é uma função apenas em "θ1" e "θ2". Mas, se "x1" pode assumir uma faixa de valores muito maior que "x2", as curvas de nível da função de custo "J(θ)" podem apresentar essa forma de elipse bem achatada. Na verdade, com a razão "2000:5", será ainda mais achatada. Então, essas elipses muito muito altas e magras, ou ovais, podem ser a curvas de nível da função de custo "J(θ)". E, se você aplicar Gradiente Descendente nessa função de custo, o seu gradiente vai demorar muito e pode oscilar para frente e para trás, levando um longo tempo até finalmente chegar ao mínimo global. Se você imaginar essas linhas ainda mais exageradamente, desenhando elas ainda mais magras e altas, um cenário ainda mais extremo, o Gradiente Descendente terá muito mais dificuldades em encontrar seu caminho, podendo levar muito tempo até encontrar o caminho até o mínimo global. Nesses cenários, uma técnica muito útil é Redimensionar as variáveis. Se você, ao invés, definir a variável "x1" como o tamanho da casa dividido por "2000", e definir "x2" como o número de quartos divido por "5", as curvas de nível e a função de custo "J" podem se tornar muito menos achatadas, e as curvas pareceriam mais com círculos. E ao aplicar o Gradiente Descendente a uma função de custo como essa, podemos mostrar matematicamente que o algoritmo encontrará um caminho muito mais direto para o mínimo global, em vez de um caminho mais contorcido, seguindo um caminho muito mais complicado até o mínimo global. Assim, ao redimensionar as variáveis, para que as faixas de valores sejam similares, nós teremos nesse exemplo as duas variáveis "x1" e "x2" com valores entre "0" e "1". Que poderá resultar em uma implementação do Gradiente Descendente, convergindo mais rapidamente. Em geral, ao aplicarmos Redimensionamento de variáveis, o que queremos é ter todas as variáveis em muita faixa entre "-1" e "1". Como a sua variável "x0" é sempre "1", já está nessa faixa, mas você acabará dividindo outras variáveis por diferentes números para conseguir essa faixa. Os número "-1" e "1" não são tão importantes, então se você tiver uma variável "x1" que acabe entre "0" e "3", não tem problema. Ou se alguma variável acabar na faixa entre "-2" e "0.5", é próximo o suficiente a "-1" e "+1". Não tem problema. É apenas quando temos uma outra variável, digamos "x3", que está na faixa entre "-100" e "100", que são valores bem diferentes de "-1" e "+1". Então, essa poderá ser uma variável mais assimétrica e, analogamente, se as suas variáveis assumirem valores numa faixa muito, muito baixa. Se "x4" assumir valores entre "-0.0001" e "+0.0001", então a variável pertence a uma faixa de valores muito menor do que "-1" e "1", e eu a consideraria mal dimensionada. Assim, o que desejamos é uma faixa de valores que pode ser maior que "+1" ou menor que "-1", desde que não seja muito maior, como "100", ou muito menor, como o "0.0001". Pessoas podem ter regras diferentes, mas a que eu uso é: se a variável assumir a faixa de valores entre "-3" e "+3", isso pode ser considerado aceitável, mas se os valores forem muito maiores que "3" ou menores que "-3", eu começaria a me preocupar, e se os valores estivessem entre, digamos,"-1/3" e "1/3", também não há problema, ou entre "0" e "-1/3", ou "1/3" e "0", eu também consideraria essa faixa aceitável. Porém, se os limites forem muito pequenos como "x4", eu começaria a me preocupar. Então, a mensagem para guardar é: não se preocupe se as variáveis não estiverem exatamente na mesma escala, ou exatamente na mesma faixa de valores, desde que essa faixa seja próxima o suficiente, o Gradiente Descendente deve funcionar bem. Além de dividir pelo valor máximo ao aplicar Redimensionamento, às vezes aplica-se também "Normalização pela média". E o que eu quero dizer com isso é que você deveria pegar a variável "xi",  e trocar por "xi - μi", para deixar a média próxima de "0". E obviamente nós não vamos aplicar isso para "x0", pois a variável "x0" é sempre igual a "1", então não temos como ter um valor médio igual a "0". Mas para as outras variáveis, se, por exemplo, a faixa de valores do tamanho das casas assume valores entre "0" e "2000", e se o tamanho médio das casas for igual a "1000", então você poderia usar essa fórmula. Assinale à variável "x1", o valor do tamanho menos a média, divido por "2000" e, similarmente, se as casas tiverem entre "1" e "5" quartos, e se a na média uma casa tem "2" quartos, então você poderia usar essa fórmula para normalizar a segunda variável "x2". Em ambos os casos, você então terá valores para "x1" e "x2" que caem na faixa entre "-0.5" e "0.5", aproximadamente, "x2" pode ser um pouco maior que 0,5. E a regra mais geral é que você deveria substituir um atributo "x1" por "x1- μ1" sobre "s1", onde "μ1" é a média de "x1", no conjunto de treino, e "s1" é o intervalo de valores daquele atributo. E por "intervalo", eu quero dizer o máximo menos o valor mínimo. Ou, para aqueles que sabem o que é desvio padrão da variável, definir "s1" como o desvio padrão é aceitável também. Mas utilizar "max-min" não teria problema. E, de forma similar, para "x2", você substitui "x2" por: "x2" menos a média, dividido pelo intervalo de valores, "max-min". E esse tipo de fórmula irá colocar suas variáveis, não exatamente, mas aproximadamente, dentro desses intervalos. E, para aqueles que são tecnicamente muito cuidadosos, pegando o intervalo como "max-min", esse "5" se tornaria um "4". Então, se "max=5", "min=1", então o intervalo dos seus valores é 4. Mas tudo isso é aproximado, e qualquer valor que colocar as variaveis em qualquer coisa próxima desses intervalos está bom. E o dimensionamento de recursos não precisa ser tão exato, para que a fazer o Gradiente Descendente rode mais rápido. Agora você sabe sobre dimensionamento de variáveis, e esse truque simples fará o gradiente descendente rodar muito mais rápido e convergir em muito menos iterações. Isso foi dimensionamento de variáveis. No próximo vídeo, irei falar sobre outro truque para fazer o gradiente descendente funcionar melhor na prática.
Tradução: Eduardo Bonet | Revisão: Pablo de Morais Andrade