1
00:00:00,220 --> 00:00:05,060
在这段视频中我想谈谈正规方程 ( normal equation )

2
00:00:05,060 --> 00:00:07,640
以及它们的不可逆性

3
00:00:07,640 --> 00:00:09,890
由于这是一种较为深入的概念

4
00:00:09,890 --> 00:00:12,490
并且总有人问我有关这方面的问题

5
00:00:12,490 --> 00:00:14,400
因此 我想在这里来讨论它

6
00:00:14,400 --> 00:00:17,550
由于概念较为深入

7
00:00:18,600 --> 00:00:23,210
所以对这段可选材料大家放轻松吧

8
00:00:23,210 --> 00:00:26,890
也许你可能会深入地探索下去

9
00:00:26,890 --> 00:00:29,610
并且会觉得理解以后会非常有用

10
00:00:31,340 --> 00:00:32,030
但即使你没有理解

11
00:00:33,470 --> 00:00:37,450
正规方程和线性回归的关系

12
00:00:37,450 --> 00:00:39,520
也没有关系

13
00:00:39,520 --> 00:00:45,610
我们要讲的问题如下

14
00:00:45,610 --> 00:00:49,580
你或许可能对

15
00:00:49,580 --> 00:00:52,400
线性代数比较熟悉

16
00:00:52,400 --> 00:00:56,060
有些同学曾经问过我

17
00:00:56,060 --> 00:01:00,680
当计算

18
00:01:00,680 --> 00:01:04,220
θ等于inv(X'X ) X'y （注：X的转置翻译为X'，下同）

19
00:01:04,220 --> 00:01:05,120
那对于矩阵X'X的结果是不可逆的情况咋办呢?

20
00:01:05,120 --> 00:01:10,978
如果你懂一点线性代数的知识

21
00:01:10,978 --> 00:01:15,720
你或许会知道

22
00:01:15,720 --> 00:01:20,260
有些矩阵可逆 而有些矩阵不可逆

23
00:01:20,260 --> 00:01:23,910
我们称那些不可逆矩阵为

24
00:01:23,910 --> 00:01:27,850
奇异或退化矩阵

25
00:01:27,850 --> 00:01:31,370
问题的重点在于X'X的不可逆的问题

26
00:01:31,370 --> 00:01:35,090
很少发生

27
00:01:35,090 --> 00:01:37,930
在Octave里 如果你用它来实现θ的计算

28
00:01:37,930 --> 00:01:40,490
你将会得到一个正常的解

29
00:01:40,490 --> 00:01:45,430
在这里我不想赘述

30
00:01:45,430 --> 00:01:51,000
在Octave里 有两个函数可以求解矩阵的逆

31
00:01:51,000 --> 00:01:52,720
一个被称为pinv() 另一个是inv()

32
00:01:52,720 --> 00:01:54,450
这两者之间的差异是些许计算过程上的

33
00:01:54,450 --> 00:01:55,690
一个是所谓的伪逆 另一个被称为逆

34
00:01:55,690 --> 00:01:59,090
使用pinv() 函数可以展现数学上的过程

35
00:01:59,090 --> 00:02:00,740
这将计算出θ的值

36
00:02:00,740 --> 00:02:05,220
即便矩阵X'X是不可逆的

37
00:02:05,220 --> 00:02:08,982
在pinv() 和 inv() 之间

38
00:02:08,982 --> 00:02:13,140
又有哪些具体区别呢 ?

39
00:02:13,140 --> 00:02:18,400
其中inv() 引入了先进的数值计算的概念

40
00:02:18,400 --> 00:02:22,160
我真的不希望讲那些

41
00:02:22,160 --> 00:02:26,560
因此 我认为

42
00:02:26,560 --> 00:02:27,710
可以试着给你一点点直观的参考

43
00:02:27,710 --> 00:02:32,140
关于矩阵X'X的不可逆的问题

44
00:02:32,140 --> 00:02:37,940
如果你懂一点线性代数

45
00:02:37,940 --> 00:02:46,060
或许你可能会感兴趣

46
00:02:46,060 --> 00:02:49,720
我不会从数学的角度来证明它

47
00:02:49,720 --> 00:02:54,650
但如果矩阵X'X结果是不可逆的

48
00:02:54,650 --> 00:02:58,730
通常有两种最常见的原因

49
00:02:58,730 --> 00:03:02,753
第一个原因是 如果不知何故 在你的学习问题

50
00:03:02,753 --> 00:03:05,470
你有多余的功能

51
00:03:05,470 --> 00:03:08,770
例如 在预测住房价格时

52
00:03:08,770 --> 00:03:13,430
如果x1是以英尺为尺寸规格计算的房子

53
00:03:13,430 --> 00:03:18,350
x2是以平方米为尺寸规格计算的房子

54
00:03:18,350 --> 00:03:22,520
同时 你也知道1米等于3.28英尺 ( 四舍五入到两位小数 )

55
00:03:22,520 --> 00:03:27,850
这样 你的这两个特征值将始终满足约束

56
00:03:27,850 --> 00:03:32,770
x1等于x2倍的3.28平方

57
00:03:32,770 --> 00:03:37,280
并且你可以将这过程显示出来 讲到这里 可能 或许对你来说有点难了

58
00:03:37,280 --> 00:03:38,350
但如果你在线性代数上非常熟练

59
00:03:38,350 --> 00:03:42,550
实际上 你可以用这样的一个线性方程 来展示那两个相关联的特征值

60
00:03:44,100 --> 00:03:48,490
矩阵X'X将是不可逆的

61
00:03:48,490 --> 00:03:53,210
第二个原因是 在你想用大量的特征值

62
00:03:53,210 --> 00:03:58,060
尝试实践你的学习算法的时候

63
00:03:58,060 --> 00:04:02,300
可能会导致矩阵X'X的结果是不可逆的

64
00:04:02,300 --> 00:04:03,990
具体地说 在m小于或等于n的时候

65
00:04:03,990 --> 00:04:07,780
例如 有m等于10个的训练样本

66
00:04:07,780 --> 00:04:11,260
也有n等于100的特征数量

67
00:04:11,260 --> 00:04:15,450
要找到适合的 ( n +1 ) 维参数矢量θ 这是第 n+1 维

68
00:04:15,450 --> 00:04:20,420
这将会变成一个101维的矢量

69
00:04:20,420 --> 00:04:23,660
尝试从10个训练样本中找到满足101个参数的值

70
00:04:23,660 --> 00:04:27,380
这工作可能会让你花上一阵子时间

71
00:04:27,380 --> 00:04:32,625
但这并不总是一个好主意

72
00:04:32,625 --> 00:04:37,930
因为 正如我们所看到 你只有10个样本  以适应这100或101个参数

73
00:04:37,930 --> 00:04:43,400
数据还是有些少

74
00:04:43,400 --> 00:04:47,300
稍后我们将看到

75
00:04:47,300 --> 00:04:51,290
如何使用小数据样本以得到这100或101个参数

76
00:04:51,290 --> 00:04:53,050
通常 我们会使用一种叫做正则化的线性代数方法

77
00:04:53,050 --> 00:04:55,330
通过删除某些特征或者是使用某些技术

78
00:04:55,330 --> 00:04:58,790
来解决当m比n小的时候的问题

79
00:04:58,790 --> 00:05:02,430
这也是在本节课后面要讲到的内容

80
00:05:02,430 --> 00:05:05,770
即使你有一个相对较小的训练集

81
00:05:05,770 --> 00:05:07,190
也可使用很多的特征来找到很多合适的参数

82
00:05:07,190 --> 00:05:09,220
有关正规化的内容将是本节之后课程的话题

83
00:05:09,220 --> 00:05:11,640
总之当你发现的矩阵X'X的结果是奇异矩阵

84
00:05:11,640 --> 00:05:16,050
或者找到的其它矩阵是不可逆的

85
00:05:16,050 --> 00:05:20,390
我会建议你这么做

86
00:05:20,390 --> 00:05:22,570
首先 看特征值里是否有一些多余的特征

87
00:05:24,050 --> 00:05:26,690
像这些x1和x2是线性相关的

88
00:05:26,690 --> 00:05:31,640
或像这样 互为线性函数

89
00:05:31,640 --> 00:05:35,700
同时 当有一些多余的特征时

90
00:05:35,700 --> 00:05:38,490
可以删除这两个重复特征里的其中一个

91
00:05:38,490 --> 00:05:42,410
无须两个特征同时保留

92
00:05:42,410 --> 00:05:46,100
所以 发现多余的特征删除二者其一

93
00:05:46,100 --> 00:05:49,180
将解决不可逆性的问题

94
00:05:49,180 --> 00:05:52,420
因此 首先应该通过观察所有特征检查是否有多余的特征

95
00:05:52,420 --> 00:05:58,450
如果有多余的就删除掉