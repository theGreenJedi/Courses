1
00:00:00,220 --> 00:00:05,060
В этом видео я хочу рассказать о системе нормальных

2
00:00:05,060 --> 00:00:07,640
уравнений и необратимости матриц.

3
00:00:07,640 --> 00:00:09,890
Это – немного более сложное понятие, но это именно то, о

4
00:00:09,890 --> 00:00:12,490
чем меня часто спрашивают.

5
00:00:12,490 --> 00:00:14,400
Так что именно об этом я хотел бы поговорить.

6
00:00:14,400 --> 00:00:17,550
Так как  это немного более сложная концепция,

7
00:00:18,600 --> 00:00:23,210
считайте этот материал  факультативным. Необратимость матриц существует, и вы с ней

8
00:00:23,210 --> 00:00:26,890
можете столкнуться, поэтому полезно

9
00:00:26,890 --> 00:00:29,610
понимать проблему.

10
00:00:31,340 --> 00:00:32,030
Но даже если вы не поймете проблему, нормальные

11
00:00:33,470 --> 00:00:37,450
уравнения или линейную регрессию, это не

12
00:00:37,450 --> 00:00:39,520
должно помешать дальнейшему продвижению в курсе.

13
00:00:39,520 --> 00:00:45,610
Вот в чем проблема: когда мы

14
00:00:45,610 --> 00:00:49,580
вычисляем тету как (X' * X) ^ (-1) * X' * y, что произойдет если

15
00:00:49,580 --> 00:00:52,400
матрица (X' * X) будет необратима?

16
00:00:52,400 --> 00:00:56,060
Для тех, кто изучал

17
00:00:56,060 --> 00:01:00,680
линейную алгебру, не

18
00:01:00,680 --> 00:01:04,220
секрет, что только некоторые

19
00:01:04,220 --> 00:01:05,120
матрицы имеют

20
00:01:05,120 --> 00:01:10,978
обратную. Те, что не имеют,

21
00:01:10,978 --> 00:01:15,720
называются необратимыми,

22
00:01:15,720 --> 00:01:20,260
сингулярными или

23
00:01:20,260 --> 00:01:23,910
вырожденными

24
00:01:23,910 --> 00:01:27,850
матрицами.

25
00:01:27,850 --> 00:01:31,370
Необратимость (X' * X) возникает

26
00:01:31,370 --> 00:01:35,090
довольно редко.

27
00:01:35,090 --> 00:01:37,930
И, если вы просто реализуете обсуждающуюся формулу, к

28
00:01:37,930 --> 00:01:40,490
примеру, в Octave, то будете правы.

29
00:01:40,490 --> 00:01:45,430
Я сейчас уклоняюсь в технические подробности и, не

30
00:01:45,430 --> 00:01:51,000
углубляясь слишком в детали, скажу лишь, что в Octave есть 2 функции для

31
00:01:51,000 --> 00:01:52,720
нахождения обратной матрицы: pinv() и inv().

32
00:01:52,720 --> 00:01:54,450
Между ними есть только техническая разница.

33
00:01:54,450 --> 00:01:55,690
pinv() - нахождение псевдо-обратной матрицы, inv() - нахождение обратной

34
00:01:55,690 --> 00:01:59,090
Можно строго показать, что, даже когда матрица (X' * X)

35
00:01:59,090 --> 00:02:00,740
необратима, вычисление с помощью

36
00:02:00,740 --> 00:02:05,220
функции pinv() все равно даст корректное

37
00:02:05,220 --> 00:02:08,982
значение теты. Функция pinv() работает

38
00:02:08,982 --> 00:02:13,140
в более широком классе

39
00:02:13,140 --> 00:02:18,400
ситуаций, нежели inv(), за

40
00:02:18,400 --> 00:02:22,160
счет применения более сложного алгоритма, и я не хотел бы углубляться тут в детали.

41
00:02:22,160 --> 00:02:26,560
Но я бы хотел рассказать еще немного об

42
00:02:26,560 --> 00:02:27,710
интуитивных соображениях по поводу того,

43
00:02:27,710 --> 00:02:32,140
что в нашем случае

44
00:02:32,140 --> 00:02:37,940
означает

45
00:02:37,940 --> 00:02:46,060
необратимость (X' * X).

46
00:02:46,060 --> 00:02:49,720
Я не собираюсь доказывать это математически, но

47
00:02:49,720 --> 00:02:54,650
необратимость (X' * X) обычно

48
00:02:54,650 --> 00:02:58,730
вызвана одной из двух наиболее

49
00:02:58,730 --> 00:03:02,753
распространённые причин. Первая

50
00:03:02,753 --> 00:03:05,470
причина - наличие в данных

51
00:03:05,470 --> 00:03:08,770
зависимых переменных. Например, вы пытаетесь предсказать

52
00:03:08,770 --> 00:03:13,430
цены на жильё и x1 – размер дома в

53
00:03:13,430 --> 00:03:18,350
квадратных футах,  а x2 – размер

54
00:03:18,350 --> 00:03:22,520
дома в квадратных метрах, – тогда, как известно, 1 метр равен 3.28

55
00:03:22,520 --> 00:03:27,850
футам (округлённо до сотых), и,

56
00:03:27,850 --> 00:03:32,770
таким образом, обе ваши

57
00:03:32,770 --> 00:03:37,280
величины всегда будут удовлетворять

58
00:03:37,280 --> 00:03:38,350
условию, что x1 равняется  (3.28)^2 * х2. То

59
00:03:38,350 --> 00:03:42,550
есть переменные x1и x2 линейно

60
00:03:44,100 --> 00:03:48,490
зависимы. Можно

61
00:03:48,490 --> 00:03:53,210
показать (используя линейную

62
00:03:53,210 --> 00:03:58,060
алгебру) что в этом случае

63
00:03:58,060 --> 00:04:02,300
матрица (X' * X), будет необратимой.  Вторая причина, которая может вызвать необратимость, возникает при использовании алгоритма обучения с большим количеством переменных.

64
00:04:02,300 --> 00:04:03,990
А точнее, если m ≤ n.

65
00:04:03,990 --> 00:04:07,780
К примеру, представьте, что у вас

66
00:04:07,780 --> 00:04:11,260
есть m = 10 обучающих примеров, и n = 100 факторов. В этом

67
00:04:11,260 --> 00:04:15,450
случае, вы пытаетесь подобрать вектор параметров θ размером n+1 - то есть,

68
00:04:15,450 --> 00:04:20,420
размером 101. Соответственно,

69
00:04:20,420 --> 00:04:23,660
вы пытаетесь подобрать 101 параметров по всего лишь 10-ти обучающим примерам.

70
00:04:23,660 --> 00:04:27,380
Иногда это даже работает, но сложно

71
00:04:27,380 --> 00:04:32,625
назвать это хорошей идеей.

72
00:04:32,625 --> 00:04:37,930
Как мы увидим позже, если у вас всего 10 примеров для подбора 100

73
00:04:37,930 --> 00:04:43,400
или 101 параметра, данных в этом случае недостаточно.

74
00:04:43,400 --> 00:04:47,300
Далее, по ходу курса, мы увидим, почему этого количества

75
00:04:47,300 --> 00:04:51,290
данных недостаточно для получения такого большого числа параметров.

76
00:04:51,290 --> 00:04:53,050
Обычно, в случае, если m ≤ n, мы пробуем

77
00:04:53,050 --> 00:04:55,330
либо избавиться от части факторов, либо используем метод, называемый регуляризацией. О нём

78
00:04:55,330 --> 00:04:58,790
мы еще поговорим немного позже. Он

79
00:04:58,790 --> 00:05:02,430
позволяет оценить большое число параметров для

80
00:05:02,430 --> 00:05:05,770
большого числа факторов даже в том случае, если

81
00:05:05,770 --> 00:05:07,190
число обучающих примеров относительно мало.

82
00:05:07,190 --> 00:05:09,220
Но регуляризация будет объектом нашего рассмотрения чуть позже.

83
00:05:09,220 --> 00:05:11,640
Таким образом, если вы получите

84
00:05:11,640 --> 00:05:16,050
сингулярную (необратимую) матрицу (X' * X) я

85
00:05:16,050 --> 00:05:20,390
рекомендую прежде всего

86
00:05:20,390 --> 00:05:22,570
проверить

87
00:05:24,050 --> 00:05:26,690
данные на наличие избыточных

88
00:05:26,690 --> 00:05:31,640
факторов.  Так рассмотренные х1 и х2 являются линейной функцией друг друга.

89
00:05:31,640 --> 00:05:35,700
Нет необходимости иметь

90
00:05:35,700 --> 00:05:38,490
оба фактора в описании, т.к.

91
00:05:38,490 --> 00:05:42,410
они линейно зависимые.

92
00:05:42,410 --> 00:05:46,100
Удаление одного из факторов

93
00:05:46,100 --> 00:05:49,180
может решить проблему

94
00:05:49,180 --> 00:05:52,420
необратимости, но  необходимо

95
00:05:52,420 --> 00:05:58,450
удалить все избыточные