このビデオでは、 行列と行列の積、つまり 2つの行列をどう掛け合わせるかをやっていきます。 線形回帰ついて話した時に、 パラメータについて、 シータ0、シータ1を 一発で解く方法を話した時に、 勾配降下法のような繰り返しのアルゴリズム無しで解く方法、 そんなアルゴリズムについて話す時、 行列同士の積は 知らなくてはならない鍵となるステップだ。 ではいつもの通り、例から始めよう。 2つの行列があるとする。 それらを掛け合わせたいとする。 まず実際に例を見て、 その後に何をしたのかについて解説をする事にする。 では、最初に行うのは この右側の行列の 最初の列を 取り出す事だ。 そしてこの左側の行列を持ってきて、 さっきのベクトルに 掛け合わせる。 このベクトルは単なる最初の列だ。OK？ で、計算すると、 ベクトル11、9となる。 つまり、これは前回のビデオでやった ベクトルと行列の掛け算だ。 私はこれを前もって計算しておいたので、結果が11と9になる事を知っている。 次に、二番目に やらなくてはならないのは、 二番目の列を取り出し、 この右側の行列からですが、 そしてこの左側の 行列を持ってきて、 つまりあの行列、 で、それを右側の二番目の列に 掛ける！ だから今回も、 行列とベクトルの掛け算となる。 これは前回のビデオでお馴染み。 で、この行列と このベクトルを掛けると、 結果は10と、 14となる。 ところで、もし行列とベクトルの掛け算を 練習したいなぁ、と思ってるなら、 ビデオを止めて、この掛け算を自分でチェックしてみてくれ。 次に、 この2つの結果を持ってきて、 一つに合わせる！これが求める答えとなる。 つまり、結果としては、 この積の結果は、 2掛ける2行列で、 この行列を どう埋めるかというと、 11、9のベクトルの要素を取ってきて それをここに突っ込む。 そして10、14を取ってきて、 二番目の列に突っ込む。 OK？ 以上が、行列同士の掛け算が どうなってるかの メカニズムだ。 基本的には二番目の行列の 各列を一度に一列ずつ見て、そして結果を組み立てる。 少し後に この手順をより詳しく見ていくが、 その前に 一つ指摘しておきたい。 この最初の例は2x3行列を、 3x2行列に 掛け合わせる。 そしてこの積の結果は 2x2行列と あいなる。 これも、ちょっとしたら何故成り立つのか、見る事となる。 オーライ。 以上が計算のメカニズム。 では実際に、詳細を見ていき、 実際に何が起こるのか 見ていこう。 これが詳細だ。 行列Aがあって それを行列Bと 掛け算したい。そしてその結果は 何らかの新しい行列Cになるとする。 以下の条件を満たす 行列同士しか掛け合わせられない事が分かるーー Aの次元が m掛けるn行列だとすると、 つまりm行n列だとすると、 それはn掛けるoに対して 掛けるとすると、 この、ここのnは この、こっちのnと 一致していなくてはならない。
つまり最初の行列の列の数は 二番目の行列の行の数と一致していなくてはならない。 そしてその掛け算の結果は m掛けるo 行列となる。 ちょうどこの行列Cのように。 そして前回のビデオで 行った事は全て、 このoが1、という 特殊ケースに過ぎない。 OK? それはBがベクトルのケースだった。 だが今回は、 oが1より大きいケースを見ている。 それで、以上が2つの行列を 掛け算する方法だ。 何をしているかを理解する為には、 行列Bの 最初の列を 取ってきて、 それをベクトルと扱い、 行列Aを掛ける、 Bの最初の列に。 そして結果は m掛ける1ベクトルとなる。 それをここに置く。 次に、行列Bの 二番目の列を取り、 いい？ これはまた別のn掛ける1ベクトルだ。 つまりこの列、 ここの。 n掛ける1ベクトル。それらn次元ベクトルを、 この行列に掛ける、 このn掛ける1ベクトルに。 その結果は m次元ベクトルとなり、 それをここに置く。 などなど。 OK？ 続きは 三番目の列を取って この行列でかける。 そしてm次元ベクトルを得る。 これを最後の列と 行列を掛け合わせて Cの最後の列を 得るまで 続ける。 もう一度繰り返そう。 行列Cのi番目の列は 以下の手続きで得られる、つまり 行列Aを取って その行列Aで 行列Bのi番目を取って 掛け算する。 iは1、2、、、とoまでの値を取る。 OK? これは単に 行列Cを計算する為に やってきた事をまとめただけ。 もう一つ別の例を見てみよう。 これら2つの行列を掛け算したいとしよう。