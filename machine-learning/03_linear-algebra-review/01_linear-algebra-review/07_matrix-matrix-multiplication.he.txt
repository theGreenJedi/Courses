בסרטון הזה נדבר על כפל מטריצה במטריצה, או על איך מכפילים שתי מטריצות. כשנדבר על שיטת הרגרסיה הליניארית לחשב את הפרמטרים תטא-0 ותטא-1 במכה אחת, ללא צורך באלגוריתם איטרטיבי כמו הירידה בשיפוע. כשנדבר על האלגוריתם, יתברר לנו שכפל מטריצה במטריצה הוא אחד מצעדי המפתח שצריך לדעת. אז בואו, כרגיל, נתחיל עם דוגמה. נניח שיש לי שתי מטריצות ואני רוצה להכפיל אותם. תרשו לי כמו קודם לעשות את הדוגמא ואז אני אסביר קצת על מה שקרה. אז הדבר הראשון שאני עושה הוא לשלוף את הטור הראשון של המטריצה הימנית. ואני לוקח את המטריצה משמאל וכופל אותה בוקטור שהוא העמודה הראשונה הזו. כשעושים את זה, מקבלים את הווקטור 11, 9. זה אותו כפל של וקטור-מטריצה כמו שראינו בסרטון הקודם. עשיתי את זה מקודם, אז אני יודע שזה יוצא 11, 9. והדבר הבא שאני רוצה לעשות הוא לשלוף את העמודה השנייה של המטריצה מימין. ואז אני לוקח את המטריצה משמאל, לוקח את המטריצה, ומכפיל אותה בטור השני של המטריצה הימנית. זהו פשוט עוד כפל וקטור במטריצה שראינו בוידאו הקודם. אז אם תכפיל את המטריצה הזו בווקטור הזה תקבל 10, 14. ודרך אגב, אם אתה רוצה להתאמן בכפל של מטריצה בוקטור, אל תהסס, תשהה את הוידאו ותחשב את המכפלה הזו בעצמך. אז אני פשוט לוקח את שתי התוצאות האלה ומשרשר אותם לוקטור, וזו התשובה. אז אנחנו רואים שהתוצאה של ההכפלה הזו היא מטריצה שתיים על שתיים. וכדי למלא את המטריצה אנחנו לוקחים את האברים 11, 9, ומציבים אותם כאן. ולוקחים את 10, 14 ומציבים אותם בעמודה השניה, בסדר? אז זו היא המכניקה של כפל מטריצה במטריצה אחרת. באופן כללי אתה מסתכל על המטריצה השניה כאוסף של עמודות ובונה את התשובות. שוב, אני אסביר את זה הרבה יותר בפרטים תיכף. אבל אני רק רוצה גם לציין, המטריצה הראשונה היא מטריצה ​​2x3. וכפלנו אותה במטריצה 3x2, והתוצאה של הכפל היא מטריצה 2x2. ושוב, תיכף נראה למה זה יצא ככה. בסדר, זו היתה המכניקה של החישוב. בואו באמת נעיין בפרטים ונבין מה בדיוק קרה. אז הנה הפרטים. יש לי מטריצה A ​​ואני רוצה להכפיל אותה במטריצה B והתוצאה תהיה איזו מטריצה חדשה C. אז אפשר להכפיל רק מטריצות שהמידות שלהם מתאימות. אז אם A היא מטריצה ​​m x n, של m שורות ו-n עמודות. ואנחנו מכפילים אותה במטריצה  n x o. אז ה-n הזה כאן חייב להתאים ל-n הזה כאן. מספר העמודות במטריצה ​​הראשונה צריך להיות זהה למספר השורות במטריצה ​​השנייה. והתוצאה של הכפל הזה תהיה מטריצה  m x o, כמו המטריצה C כאן. מה שעשינו בוידאו הקודם הוא בעצם המקרה הפרטי בו o = 1. זה היה המקרה בו B הוא וקטור. אבל עכשיו אנחנו עומדים לעבוד עם מקרים של ערכי o גדולים מ -1. אז הנה איך מכפילים שתי מטריצות. מה שאני עומד לעשות הוא לקחת את העמודה הראשונה של B ולהתייחס אליה כוקטור, ולהכפיל את המטריצה ​​A בעמודה הראשונה של B. והתוצאה של זה תהיה וקטור של n x 1, ואותו אני מעמיד כאן. ואחר כך אני אקח את העמודה השניה של B, בסדר? וזה יתן לי עוד וקטור של n x 1. אז הטור הזה כאן, הוא n x 1. זה וקטור בממד n. אני אכפיל את המטריצה ה​​זו בוקטור n x 1 הזה. התוצאה תהיה וקטור m-ממדי, שנעמיד פה. ואז אני אקח את העמודה השלישית, אכפול אותה במטריצה ה​​זו. אקבל וקטור m-ממדי. וכן הלאה, עד שמגיעים לעמודה האחרונה. המטריצה כפול העמודה האחרונה נותנת את העמודה האחרונה של C אז אני אומר שוב, העמודה ה-i של המטריצה C מתקבלת על ידי לקיחת המטריצה A והכפלתה בעמודה ה-i של מטריצה B עבור ערכי i מ-1,2 ועד o. זהו פשוט הסיכום של כל מה שעשינו שם על מנת לחשב את המטריצה C בואו נראה רק עוד דוגמא אחת. נניח שאני רוצה להכפיל את שתי המטריצות האלה. אז מה שאני עושה הוא קודם כל לשלוף את העמודה הראשונה של המטריצה השניה. זו היא מה שקראנו המטריצה B בשקופית הקודמת אז אני צריך את המטריצה הזו כפול הוקטור הזה. אז בואו נעשה את החישוב הזה במהירות. זה שווה 1, 3x0 3, אז אנחנו מקבלים 1x0 + 3x3 והאיבר השני הוא 2, 5x0 3, אז יוצא 2x0 + 5x3 שהם 9, 15 אה, תרשו לי לכתוב את זה בירוק. אז זה 9, 15. ואז אני עומד לשלוף את הטור השני ולעשות את אותם חישובים. אז זה המטריצה הזו כפול הוקטור הזה 1, 2. בואו נעשה גם את זה מהר, אז זה 1x1 + 3x2, אז זו היתה השורה הזו. ובואו נעשה את הבאה בתור. אז בואו נראה, זה נותן לי 2x1 + 5x2 שזה שווה, הבה נראה, 1x1 + 3x2 שווה 7 ו-2x1 + 5x2 הם 12. אז עכשיו יש לי את שני אלה ולכן התוצאה שלי, המכפלה של שתי המטריצות האלה, הולכת להיות זה זז לכאן וזה זז לכאן. אז אני מקבל 9, 15 ו-4, 12. ואתם עשויים גם לראות שהתוצאה של הכפלת מטריצה ​​2x2 עם עוד מטריצה ​​2x2, המימד של התוצאה יהיה ה-2 של כאן וה-2 של כאן. אז התוצאה עצמה גם היא מטריצה ​​2x2. לבסוף, הרשו לי להראות לכם עוד טריק אחד שאפשר לעשות בעזרת כפל מטריצה במטריצה. נניח, כמו קודם, שיש לנו ארבעה בתים שאת מחיריהם אנחנו רוצים לחזות. אבל עכשיו, יש לנו שלוש פונקציות השערה מתחרות המוצגות כאן מימין. אז אם אתה רוצה לחשב את כל שלוש ההשערות המתחרות לכל ארבעת הבתים, אז אפשר לעשות את זה בצורה יעילה מאוד באמצעות כפל מטריצות. אז הנה משמאל המטריצה הרגילה שלי, זהה לזו בסרטון שעבר שבה הערכים הללו הם מחירי הבתים ושמתי טור של 1 כאן משמאל. ומה שאני אעשה הוא לבנות עוד מטריצה שבה כאן, בעמודה הראשונה יש 40- ו-0.25 ובעמודה השניה 200, 0.1 וכו'. אז אם תכפיל את שתי המטריצות האלה, מה שתמצא הוא שהעמודה הראשונה הזו, אני אצייר אותה בכחול. ובכן, איך אתה מחשב את העמודה הראשונה הזו? התהליך שלנו לכפל מטריצה במטריצה הוא כזה שכדי לחשב את העמודה הראשונה בתוצאה אתה לוקח את המטריצה הזו ומכפיל אותה בעמודה הראשונה הזו. וראינו בסרטון הקודם שזו בדיוק התחזית של מחירי הבתים לפי ההשערה הראשונה, נכון, לפי ההשערה הראשונה כאן. ומה בקשר לעמודה השנייה? איך מחשבים את העמודה השנייה? הדרך לחשב את העמודה השנייה היא לקחת את המטריצה הזו ולכפול אותה בעמודה השנייה כאן. ולכן העמודה השנייה של התוצאה היא תחזית מחירי הבתים של ההשערה השנייה שם למעלה, ובדומה לכך גם הטור השלישי. אז למרות שלא עברתי דרך כל הפרטים, אני מקווה שאתם מבינים, אל תהססו להשהות את הווידאו ולבדוק ולהבין את המתמטיקה בעצמכם ולוודא שמה שאני טענתי עכשיו הוא באמת נכון. מתברר שעל ידי בניית שתי המטריצות האלה, מה שאפשר לעשות הוא לחשב מהר מאוד את כל 3 ההשערות על כל 4 הגדלים של הבתים כדי לקבל את כל 12 התחזיות של המחירים לפי 3 השערות על 4 הבתים. אז בצעד אחד בלבד של כפל מטריצה במטריצה הצלחנו לעשות 12 תחזיות. ואפילו עוד יותר טוב, מתברר שעל מנת לעשות כפל מטריצות, יש הרבה ספריות טובות של אלגברה לינארית שעושות את הכפל הזה בשבילנו. אז פחות או יותר בכל שפת תכנות סבירה שייתכן שאתה משתמש בה. אין כל ספק שבכל שפות התכנות הפופולריות ביותר בעשירייה הראשונה תהיינה ספריות מצוינות של אלגברה לינארית. ויהיו ספריות טובות של אלגברה לינארית שמותאמות במיוחד כדי לעשות כפל מטריצות ביעילות רבה. כולל כל ניצול אפשרי של חישוב מקביל שמחשב עשוי לאפשר, אם במחשב יש מספר רב של ליבות או מעבדים מרובים. או לפעמים גם בתוך המעבד יש מקביליות שנקראת מקביליות SIMD שהמחשב יוכל לבצע. ויש ספריות חופשיות טובות מאוד, שאפשר להשתמש בהן כדי לעשות כפל מטריצות והן מאוד יעילות, כך שאפשר בצורה יעילה מאוד לעשות הרבה תחזיות עם המון השערות.