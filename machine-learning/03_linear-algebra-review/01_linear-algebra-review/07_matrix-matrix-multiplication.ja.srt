1
00:00:00,290 --> 00:00:03,747
このビデオでは、

2
00:00:03,747 --> 00:00:06,630
行列と行列の積、つまり

3
00:00:06,630 --> 00:00:10,170
2つの行列をどう掛け合わせるかをやっていきます。

4
00:00:10,170 --> 00:00:13,123
線形回帰ついて話した時に、

5
00:00:13,123 --> 00:00:16,270
パラメータについて、

6
00:00:16,270 --> 00:00:18,810
シータ0、シータ1を

7
00:00:18,810 --> 00:00:22,840
一発で解く方法を話した時に、

8
00:00:24,090 --> 00:00:27,440
勾配降下法のような繰り返しのアルゴリズム無しで解く方法、

9
00:00:28,840 --> 00:00:32,610
そんなアルゴリズムについて話す時、

10
00:00:32,610 --> 00:00:34,805
行列同士の積は

11
00:00:34,805 --> 00:00:38,060
知らなくてはならない鍵となるステップだ。

12
00:00:38,060 --> 00:00:43,460
ではいつもの通り、例から始めよう。

13
00:00:43,460 --> 00:00:46,480
2つの行列があるとする。

14
00:00:46,480 --> 00:00:49,240
それらを掛け合わせたいとする。

15
00:00:49,240 --> 00:00:53,790
まず実際に例を見て、

16
00:00:55,180 --> 00:00:59,770
その後に何をしたのかについて解説をする事にする。

17
00:00:59,770 --> 00:01:03,370
では、最初に行うのは

18
00:01:03,370 --> 00:01:04,790
この右側の行列の

19
00:01:06,070 --> 00:01:08,570
最初の列を

20
00:01:08,570 --> 00:01:12,620
取り出す事だ。

21
00:01:12,620 --> 00:01:16,550
そしてこの左側の行列を持ってきて、

22
00:01:16,550 --> 00:01:20,430
さっきのベクトルに

23
00:01:20,430 --> 00:01:24,960
掛け合わせる。

24
00:01:24,960 --> 00:01:28,840
このベクトルは単なる最初の列だ。OK？

25
00:01:28,840 --> 00:01:30,580
で、計算すると、

26
00:01:30,580 --> 00:01:35,540
ベクトル11、9となる。

27
00:01:35,540 --> 00:01:39,650
つまり、これは前回のビデオでやった

28
00:01:39,650 --> 00:01:42,159
ベクトルと行列の掛け算だ。

29
00:01:43,260 --> 00:01:46,880
私はこれを前もって計算しておいたので、結果が11と9になる事を知っている。

30
00:01:46,880 --> 00:01:48,470
次に、二番目に

31
00:01:48,470 --> 00:01:53,060
やらなくてはならないのは、

32
00:01:53,060 --> 00:01:58,005
二番目の列を取り出し、

33
00:01:58,005 --> 00:01:59,950
この右側の行列からですが、

34
00:01:59,950 --> 00:02:07,510
そしてこの左側の

35
00:02:07,510 --> 00:02:12,350
行列を持ってきて、

36
00:02:12,350 --> 00:02:15,810
つまりあの行列、

37
00:02:15,810 --> 00:02:17,550
で、それを右側の二番目の列に

38
00:02:17,550 --> 00:02:20,252
掛ける！

39
00:02:20,252 --> 00:02:25,494
だから今回も、

40
00:02:25,494 --> 00:02:31,270
行列とベクトルの掛け算となる。

41
00:02:31,270 --> 00:02:36,520
これは前回のビデオでお馴染み。

42
00:02:36,520 --> 00:02:39,744
で、この行列と

43
00:02:39,744 --> 00:02:42,730
このベクトルを掛けると、

44
00:02:42,730 --> 00:02:46,540
結果は10と、

45
00:02:46,540 --> 00:02:47,480
14となる。

46
00:02:47,480 --> 00:02:52,550
ところで、もし行列とベクトルの掛け算を

47
00:02:52,550 --> 00:02:54,540
練習したいなぁ、と思ってるなら、

48
00:02:55,720 --> 00:03:00,300
ビデオを止めて、この掛け算を自分でチェックしてみてくれ。

49
00:03:00,300 --> 00:03:04,630
次に、

50
00:03:04,630 --> 00:03:07,000
この2つの結果を持ってきて、

51
00:03:07,000 --> 00:03:10,680
一つに合わせる！これが求める答えとなる。

52
00:03:10,680 --> 00:03:13,340
つまり、結果としては、

53
00:03:13,340 --> 00:03:16,830
この積の結果は、

54
00:03:16,830 --> 00:03:25,470
2掛ける2行列で、

55
00:03:25,470 --> 00:03:30,220
この行列を

56
00:03:30,220 --> 00:03:32,400
どう埋めるかというと、

57
00:03:32,400 --> 00:03:35,540
11、9のベクトルの要素を取ってきて

58
00:03:35,540 --> 00:03:40,930
それをここに突っ込む。

59
00:03:40,930 --> 00:03:46,690
そして10、14を取ってきて、

60
00:03:46,690 --> 00:03:51,712
二番目の列に突っ込む。

61
00:03:51,712 --> 00:03:57,960
OK？

62
00:03:57,960 --> 00:04:03,980
以上が、行列同士の掛け算が

63
00:04:05,220 --> 00:04:11,880
どうなってるかの

64
00:04:11,880 --> 00:04:14,820
メカニズムだ。

65
00:04:14,820 --> 00:04:17,130
基本的には二番目の行列の

66
00:04:17,130 --> 00:04:18,810
各列を一度に一列ずつ見て、そして結果を組み立てる。

67
00:04:18,810 --> 00:04:22,460
少し後に

68
00:04:22,460 --> 00:04:28,600
この手順をより詳しく見ていくが、

69
00:04:29,750 --> 00:04:34,860
その前に

70
00:04:34,860 --> 00:04:37,530
一つ指摘しておきたい。

71
00:04:37,530 --> 00:04:41,200
この最初の例は2x3行列を、

72
00:04:41,200 --> 00:04:45,230
3x2行列に

73
00:04:46,510 --> 00:04:50,198
掛け合わせる。

74
00:04:50,198 --> 00:04:55,154
そしてこの積の結果は

75
00:04:55,154 --> 00:05:01,149
2x2行列と

76
00:05:01,149 --> 00:05:05,080
あいなる。

77
00:05:05,080 --> 00:05:10,190
これも、ちょっとしたら何故成り立つのか、見る事となる。

78
00:05:11,530 --> 00:05:13,660
オーライ。

79
00:05:13,660 --> 00:05:17,300
以上が計算のメカニズム。

80
00:05:17,300 --> 00:05:24,230
では実際に、詳細を見ていき、

81
00:05:24,230 --> 00:05:29,670
実際に何が起こるのか

82
00:05:29,670 --> 00:05:32,670
見ていこう。

83
00:05:32,670 --> 00:05:35,340
これが詳細だ。

84
00:05:35,340 --> 00:05:41,332
行列Aがあって

85
00:05:41,332 --> 00:05:46,168
それを行列Bと

86
00:05:46,168 --> 00:05:51,255
掛け算したい。そしてその結果は

87
00:05:51,255 --> 00:05:55,488
何らかの新しい行列Cになるとする。

88
00:05:55,488 --> 00:06:00,748
以下の条件を満たす

89
00:06:00,748 --> 00:06:03,158
行列同士しか掛け合わせられない事が分かるーー

90
00:06:03,158 --> 00:06:07,948
Aの次元が

91
00:06:07,948 --> 00:06:13,552
m掛けるn行列だとすると、

92
00:06:13,552 --> 00:06:16,948
つまりm行n列だとすると、

93
00:06:16,948 --> 00:06:21,608
それはn掛けるoに対して

94
00:06:21,608 --> 00:06:24,731
掛けるとすると、

95
00:06:24,731 --> 00:06:30,150
この、ここのnは

96
00:06:30,150 --> 00:06:31,168
この、こっちのnと

97
00:06:31,168 --> 00:06:33,972
一致していなくてはならない。
つまり最初の行列の列の数は

98
00:06:33,972 --> 00:06:39,577
二番目の行列の行の数と一致していなくてはならない。

99
00:06:39,577 --> 00:06:45,184
そしてその掛け算の結果は

100
00:06:45,184 --> 00:06:51,219
m掛けるo 行列となる。

101
00:06:51,219 --> 00:06:55,570
ちょうどこの行列Cのように。

102
00:06:55,570 --> 00:06:59,896
そして前回のビデオで

103
00:06:59,896 --> 00:07:03,715
行った事は全て、

104
00:07:03,715 --> 00:07:08,820
このoが1、という

105
00:07:08,820 --> 00:07:13,937
特殊ケースに過ぎない。

106
00:07:13,937 --> 00:07:16,950
OK?

107
00:07:16,950 --> 00:07:22,547
それはBがベクトルのケースだった。

108
00:07:22,547 --> 00:07:27,930
だが今回は、

109
00:07:27,930 --> 00:07:31,950
oが1より大きいケースを見ている。

110
00:07:34,900 --> 00:07:39,839
それで、以上が2つの行列を

111
00:07:39,839 --> 00:07:41,040
掛け算する方法だ。

112
00:07:41,040 --> 00:07:47,019
何をしているかを理解する為には、

113
00:07:48,470 --> 00:07:53,780
行列Bの

114
00:07:53,780 --> 00:07:56,380
最初の列を

115
00:07:56,380 --> 00:07:59,480
取ってきて、

116
00:07:59,480 --> 00:08:04,030
それをベクトルと扱い、

117
00:08:04,030 --> 00:08:09,050
行列Aを掛ける、

118
00:08:09,050 --> 00:08:15,620
Bの最初の列に。

119
00:08:15,620 --> 00:08:22,486
そして結果は

120
00:08:22,486 --> 00:08:27,572
m掛ける1ベクトルとなる。

121
00:08:27,572 --> 00:08:33,189
それをここに置く。

122
00:08:33,189 --> 00:08:37,930
次に、行列Bの

123
00:08:37,930 --> 00:08:44,560
二番目の列を取り、

124
00:08:44,560 --> 00:08:46,160
いい？

125
00:08:47,430 --> 00:08:51,080
これはまた別のn掛ける1ベクトルだ。

126
00:08:51,080 --> 00:08:56,330
つまりこの列、

127
00:08:56,330 --> 00:09:01,970
ここの。

128
00:09:01,970 --> 00:09:07,540
n掛ける1ベクトル。それらn次元ベクトルを、

129
00:09:08,790 --> 00:09:10,810
この行列に掛ける、

130
00:09:10,810 --> 00:09:13,040
このn掛ける1ベクトルに。

131
00:09:13,040 --> 00:09:15,050
その結果は

132
00:09:15,050 --> 00:09:19,340
m次元ベクトルとなり、

133
00:09:19,340 --> 00:09:23,541
それをここに置く。

134
00:09:23,541 --> 00:09:29,319
などなど。

135
00:09:29,319 --> 00:09:33,400
OK？

136
00:09:34,450 --> 00:09:36,890
続きは

137
00:09:36,890 --> 00:09:41,600
三番目の列を取って

138
00:09:41,600 --> 00:09:44,120
この行列でかける。

139
00:09:44,120 --> 00:09:48,290
そしてm次元ベクトルを得る。

140
00:09:48,290 --> 00:09:54,000
これを最後の列と

141
00:09:54,000 --> 00:09:59,860
行列を掛け合わせて

142
00:10:00,930 --> 00:10:05,902
Cの最後の列を

143
00:10:05,902 --> 00:10:10,760
得るまで

144
00:10:10,760 --> 00:10:13,852
続ける。

145
00:10:13,852 --> 00:10:16,742
もう一度繰り返そう。

146
00:10:16,742 --> 00:10:21,518
行列Cのi番目の列は

147
00:10:21,518 --> 00:10:22,072
以下の手続きで得られる、つまり

148
00:10:22,072 --> 00:10:25,436
行列Aを取って

149
00:10:25,436 --> 00:10:27,935
その行列Aで

150
00:10:27,935 --> 00:10:31,295
行列Bのi番目を取って

151
00:10:31,295 --> 00:10:35,840
掛け算する。

152
00:10:35,840 --> 00:10:41,333
iは1、2、、、とoまでの値を取る。

153
00:10:41,333 --> 00:10:47,070
OK?

154
00:10:47,070 --> 00:10:51,685
これは単に

155
00:10:51,685 --> 00:10:56,310
行列Cを計算する為に

156
00:10:56,310 --> 00:10:59,410
やってきた事をまとめただけ。

157
00:10:59,410 --> 00:11:03,720
もう一つ別の例を見てみよう。

158
00:11:03,720 --> 00:11:08,440
これら2つの行列を掛け算したいとしよう。