1
00:00:00,210 --> 00:00:02,931
Давайте начнем разбираться с логистической регрессией.

2
00:00:02,950 --> 00:00:04,315
В этом видео я хочу показать вам

3
00:00:04,315 --> 00:00:07,210
общую форму гипотезы, то есть функцию, которую мы

4
00:00:07,210 --> 00:00:08,805
будем использовать для предсказания в

5
00:00:08,810 --> 00:00:10,266
задачах

6
00:00:10,300 --> 00:00:15,446
классификации.

7
00:00:15,450 --> 00:00:16,969
Я уже говорил, что наш классификатор

8
00:00:16,969 --> 00:00:20,426
должен принимать значения

9
00:00:20,426 --> 00:00:21,956
от нуля до

10
00:00:21,956 --> 00:00:23,250
единицы.

11
00:00:23,270 --> 00:00:24,566
Так что нам нужна такая

12
00:00:24,566 --> 00:00:26,385
функция-гипотеза, чтобы

13
00:00:26,385 --> 00:00:30,396
ее предсказания лежали на отрезке от нуля до единицы.

14
00:00:30,396 --> 00:00:32,764
В задаче

15
00:00:32,764 --> 00:00:34,262
линейной регресии наша

16
00:00:34,262 --> 00:00:35,604
гипотеза h(x) равнялась транспонированному

17
00:00:35,604 --> 00:00:38,319
вектору тета,

18
00:00:38,330 --> 00:00:39,831
умноженному на x. Для

19
00:00:39,831 --> 00:00:41,075
логистической регресии я

20
00:00:41,075 --> 00:00:43,352
немного изменю формулу и

21
00:00:43,360 --> 00:00:46,218
положу h(x) равной функции

22
00:00:46,218 --> 00:00:47,711
g от транспонированного

23
00:00:47,711 --> 00:00:50,693
тета на x. Функция g

24
00:00:50,693 --> 00:00:51,926
определяется так: g(z) (z — вещественное число)

25
00:00:51,926 --> 00:00:53,633
равно единице, деленной на

26
00:00:53,640 --> 00:00:55,640
один плюс e в степени −z. Эта

27
00:00:55,640 --> 00:00:58,480
функция называется

28
00:00:58,490 --> 00:01:01,716
сигмоидой или логистической

29
00:01:01,720 --> 00:01:04,843
функцией.

30
00:01:04,843 --> 00:01:07,089
И поэтому алгоритм называется

31
00:01:07,120 --> 00:01:11,103
логистической регрессией.

32
00:01:11,103 --> 00:01:12,781
К слову, термины "сигмоида" и

33
00:01:12,781 --> 00:01:14,551
"логистическая функция"

34
00:01:14,551 --> 00:01:16,996
являются синонимами и по сути

35
00:01:16,996 --> 00:01:18,362
означают одно и то же.

36
00:01:18,362 --> 00:01:19,756
В общем, они

37
00:01:19,756 --> 00:01:21,893
взаимозаменяемы и

38
00:01:21,893 --> 00:01:23,160
функцию g

39
00:01:23,160 --> 00:01:24,620
можно описать любым из них.

40
00:01:24,620 --> 00:01:26,283
Если я сведу
эти два равенства в одно,

41
00:01:26,283 --> 00:01:27,734
то получу

42
00:01:27,734 --> 00:01:30,089
вот такое выражение

43
00:01:30,089 --> 00:01:32,354
для моей

44
00:01:32,354 --> 00:01:34,843
гипотезы.

45
00:01:34,843 --> 00:01:36,533
h(x) равняется

46
00:01:36,540 --> 00:01:38,933
единице,

47
00:01:38,933 --> 00:01:41,765
деленной на один плюс

48
00:01:41,765 --> 00:01:43,106
e в степени

49
00:01:43,106 --> 00:01:45,353
минус транспонированный

50
00:01:45,353 --> 00:01:46,700
вектор тета на x.

51
00:01:46,760 --> 00:01:48,173
Я просто подставил

52
00:01:48,173 --> 00:01:50,201
вместо z произведение из

53
00:01:50,201 --> 00:01:52,560
первого равенства

54
00:01:52,560 --> 00:01:54,933
слева.

55
00:01:54,940 --> 00:01:57,949
Наконец, я хочу показать вам, как выглядит график сигмоиды.

56
00:01:57,949 --> 00:02:00,296
Я нарисую его здесь.

57
00:02:00,296 --> 00:02:02,022
Сигмоида g(z), она же логистическая

58
00:02:02,022 --> 00:02:04,652
функция, выглядит так.

59
00:02:04,652 --> 00:02:07,078
Начинаясь у нуля, она быстро

60
00:02:07,078 --> 00:02:09,366
растет возле начала координат, пересекает ось

61
00:02:09,366 --> 00:02:13,473
ординат в точке 0,5, а затем снова замедляется и выравнивается.

62
00:02:13,500 --> 00:02:16,051
Вот так.

63
00:02:16,051 --> 00:02:17,898
Как видите, сигмоида

64
00:02:17,898 --> 00:02:19,725
асимптотически

65
00:02:19,740 --> 00:02:21,894
приближается к

66
00:02:21,894 --> 00:02:24,256
горизонтальной прямой на

67
00:02:24,256 --> 00:02:26,388
уровне 1 и к оси абсцисс.

68
00:02:26,388 --> 00:02:27,659
Когда z стремится к минус

69
00:02:27,659 --> 00:02:29,304
бесконечности,

70
00:02:29,304 --> 00:02:31,396
g(z) приближается к нулю, когда z

71
00:02:31,396 --> 00:02:33,816
стремится к плюс бесконечности, g(z) приближается к

72
00:02:33,816 --> 00:02:35,864
единице. Поскольку все

73
00:02:35,880 --> 00:02:37,252
значения g(z) лежат

74
00:02:37,252 --> 00:02:39,408
между нулем и единицей, то и

75
00:02:39,408 --> 00:02:41,696
значения функции h(x) также лежат

76
00:02:41,730 --> 00:02:44,592
между нулем и

77
00:02:44,610 --> 00:02:47,141
единицей.

78
00:02:47,141 --> 00:02:50,029
Теперь, определив общий вид

79
00:02:50,040 --> 00:02:52,123
гипотезы, мы должны, как и

80
00:02:52,123 --> 00:02:53,740
раньше, подобрать вектор

81
00:02:53,740 --> 00:02:58,841
параметров тета, подходящий к нашим данным.

82
00:02:58,841 --> 00:03:00,490
То есть, исходя из обучающих данных,

83
00:03:00,490 --> 00:03:01,743
определить значения тета. Это позволит

84
00:03:01,743 --> 00:03:03,773
нам использовать гипотезу,

85
00:03:03,773 --> 00:03:06,981
чтобы делать предсказания.

86
00:03:06,981 --> 00:03:08,534
Мы поговорим об алгоритме, который это

87
00:03:08,534 --> 00:03:11,828
делает, чуть позже.

88
00:03:11,828 --> 00:03:13,506
Сначала я хочу поговорить о том, как

89
00:03:13,506 --> 00:03:17,379
трактовать эту модель.

90
00:03:17,640 --> 00:03:19,612
Каков смысл значения,

91
00:03:19,620 --> 00:03:21,660
которое

92
00:03:21,660 --> 00:03:23,637
гипотеза принимает в

93
00:03:23,637 --> 00:03:26,387
точке x?

94
00:03:26,400 --> 00:03:28,238
Я буду рассматривать

95
00:03:28,240 --> 00:03:30,126
это число как вероятность

96
00:03:30,126 --> 00:03:33,400
того, что y для этого x равняется единице.

97
00:03:33,400 --> 00:03:35,170
Вот что я имею в

98
00:03:35,170 --> 00:03:38,266
виду.

99
00:03:38,266 --> 00:03:40,324
Поясню на примере.

100
00:03:40,324 --> 00:03:43,932
Допустим, мы имеем дело с задачей классификации опухолей.

101
00:03:43,932 --> 00:03:45,234
То есть в нашем векторе характеристик x

102
00:03:45,234 --> 00:03:47,945
нулевое, как всегда,

103
00:03:47,945 --> 00:03:49,860
равно 1, а x первое

104
00:03:49,860 --> 00:03:52,836
соответствует размеру опухоли.

105
00:03:52,836 --> 00:03:54,045
Допустим, ко мне приходит пациент,

106
00:03:54,045 --> 00:03:55,459
его размер опухоли известен,

107
00:03:55,459 --> 00:03:57,183
я подаю на вход

108
00:03:57,183 --> 00:03:58,759
алгоритму соответствующий

109
00:03:58,759 --> 00:04:00,963
вектор x и получаю предсказание

110
00:04:00,970 --> 00:04:03,760
гипотезы, равное 0,7.

111
00:04:03,760 --> 00:04:05,758
Этот результат я буду

112
00:04:05,758 --> 00:04:07,298
понимать так.

113
00:04:07,298 --> 00:04:08,790
Я скажу: алгоритм предсказывает

114
00:04:08,790 --> 00:04:10,235
мне, что для пациента с

115
00:04:10,235 --> 00:04:12,143
вектором характеристик x

116
00:04:12,143 --> 00:04:14,490
вероятность того,

117
00:04:14,520 --> 00:04:16,772
что y = 1, равна 0,7.

118
00:04:16,772 --> 00:04:18,703
Другими словами, мне придется

119
00:04:18,720 --> 00:04:21,106
сообщить пациенту, что

120
00:04:21,106 --> 00:04:23,320
такая опухоль, увы, в 70% случаев,

121
00:04:23,320 --> 00:04:27,836
или, что то же самое, с вероятностью 0,7 злокачественная.

122
00:04:27,860 --> 00:04:29,420
Немного более формально, в

123
00:04:29,420 --> 00:04:30,473
математической нотации, я могу

124
00:04:30,480 --> 00:04:31,763
записать это так:

125
00:04:31,763 --> 00:04:34,803
значение гипотезы — это вероятность того,

126
00:04:34,820 --> 00:04:37,144
что y = 1 при данном x,

127
00:04:37,150 --> 00:04:39,913
параметризованная вектором

128
00:04:39,913 --> 00:04:41,813
тета.

129
00:04:41,830 --> 00:04:43,389
Для тех из вас, кто знаком с

130
00:04:43,389 --> 00:04:45,320
теорией

131
00:04:45,320 --> 00:04:46,766
вероятностей, эта запись

132
00:04:46,766 --> 00:04:48,673
понятна, для остальных повторю, эта

133
00:04:48,673 --> 00:04:51,564
запись так и читается:

134
00:04:51,580 --> 00:04:53,215
вероятность того, что y равно

135
00:04:53,215 --> 00:04:54,988
единице при данном x, то есть при том, что

136
00:04:54,988 --> 00:04:56,493
характеристики пациента, в нашем

137
00:04:56,493 --> 00:04:58,027
случае — размер его опухоли, —

138
00:04:58,040 --> 00:04:59,860
определяются вектором x. И эта

139
00:04:59,860 --> 00:05:01,575
вероятность параметризована

140
00:05:01,575 --> 00:05:03,156
вектором

141
00:05:03,156 --> 00:05:06,956
тета.

142
00:05:07,130 --> 00:05:09,166
Итак, вероятность того,

143
00:05:09,166 --> 00:05:11,009
что y = 1, соответствует

144
00:05:11,009 --> 00:05:13,332
значению

145
00:05:13,332 --> 00:05:15,349
гипотезы.

146
00:05:15,349 --> 00:05:16,523
Но раз это задача классификации,

147
00:05:16,523 --> 00:05:18,629
мы знаем, что y может быть

148
00:05:18,640 --> 00:05:21,497
только нулем или единицей,

149
00:05:21,497 --> 00:05:23,373
возможно только два значения — как

150
00:05:23,390 --> 00:05:25,466
в обучающем наборе,

151
00:05:25,466 --> 00:05:26,654
так и для будущих пациентов,

152
00:05:26,654 --> 00:05:28,077
приходящих ко мне или

153
00:05:28,077 --> 00:05:32,014
к врачу.

154
00:05:32,014 --> 00:05:33,529
Таким образом, зная h(x), мы

155
00:05:33,550 --> 00:05:36,153
знаем также и вероятность

156
00:05:36,153 --> 00:05:39,116
того, что y = 0.

157
00:05:39,116 --> 00:05:41,209
А именно, поскольку y равняется

158
00:05:41,250 --> 00:05:43,065
либо нулю, либо

159
00:05:43,070 --> 00:05:45,141
единице, сумма вероятности того,

160
00:05:45,141 --> 00:05:46,329
что y = 0, и вероятности

161
00:05:46,329 --> 00:05:47,512
того, что y = 1,

162
00:05:47,550 --> 00:05:50,173
равна 1.

163
00:05:50,173 --> 00:05:51,483
Это равенство выглядит более

164
00:05:51,483 --> 00:05:52,828
сложным, но по сути

165
00:05:52,828 --> 00:05:54,603
оно утверждает, что вероятность

166
00:05:54,610 --> 00:05:56,287
того, что y = 0, при данных

167
00:05:56,320 --> 00:05:58,319
характеристиках пациента x и данных

168
00:05:58,360 --> 00:06:01,002
параметрах тета и

169
00:06:01,010 --> 00:06:02,305
вероятность того, что y = 1, при

170
00:06:02,305 --> 00:06:04,470
тех же характеристиках x и

171
00:06:04,471 --> 00:06:06,334
параметрах тета в сумме дают

172
00:06:06,360 --> 00:06:08,260
единицу. Если его сложно воспринять, мысленно

173
00:06:08,260 --> 00:06:10,171
уберите эти условия для x и

174
00:06:10,200 --> 00:06:14,049
тета.

175
00:06:14,049 --> 00:06:15,476
Получится буквально: вероятность

176
00:06:15,480 --> 00:06:16,993
того, что y = 0 и вероятность того,

177
00:06:16,993 --> 00:06:19,272
что y = 1, в сумме дают единицу.

178
00:06:19,280 --> 00:06:20,365
Это так, потому что y может

179
00:06:20,365 --> 00:06:23,120
принимать только эти два значения, либо 0, либо 1.

180
00:06:23,120 --> 00:06:24,240
Так что сумма вероятностей

181
00:06:24,240 --> 00:06:25,918
должна быть

182
00:06:25,930 --> 00:06:29,547
равна 1.

183
00:06:29,547 --> 00:06:31,387
Если перенести

184
00:06:31,440 --> 00:06:33,780
этот член в

185
00:06:33,780 --> 00:06:35,409
правую часть равенства,

186
00:06:35,409 --> 00:06:37,327
получим выражение для

187
00:06:37,327 --> 00:06:38,995
вероятности того, что y = 0: она

188
00:06:38,995 --> 00:06:40,502
равна 1

189
00:06:40,530 --> 00:06:43,548
минус вероятность

190
00:06:43,560 --> 00:06:46,009
того,

191
00:06:46,009 --> 00:06:47,775
что y = 1. Таким образом, поскольку значение гипотезы h(x) дает нам вот

192
00:06:47,790 --> 00:06:49,948
этот член, мы без

193
00:06:49,948 --> 00:06:51,508
труда можем вычислить и

194
00:06:51,510 --> 00:06:53,282
вероятность того,

195
00:06:53,282 --> 00:06:55,411
что y = 0.

196
00:06:55,411 --> 00:06:56,720
Итак, теперь вы знаете, какие

197
00:06:56,720 --> 00:06:59,779
гипотезы мы используем в

198
00:06:59,790 --> 00:07:01,576
логистической регрессии, и

199
00:07:01,580 --> 00:07:03,534
знаете формулу функции-гипотезы

200
00:07:03,534 --> 00:07:06,701
для задач логистической регрессии.

201
00:07:06,701 --> 00:07:07,880
В следующем видео

202
00:07:07,880 --> 00:07:09,018
я постараюсь дать вам

203
00:07:09,040 --> 00:07:11,091
более глубокое понимание того, как устроена

204
00:07:11,091 --> 00:07:12,518
гипотеза.

205
00:07:12,518 --> 00:07:13,606
Также я введу

206
00:07:13,620 --> 00:07:15,294
понятие

207
00:07:15,294 --> 00:07:16,700
границы решений и покажу несколько

208
00:07:16,700 --> 00:07:18,846
графиков, чтобы проиллюстрировать

209
00:07:18,846 --> 00:07:20,186
поведение функции-гипотезы

210
00:07:20,186 --> 00:07:22,370
логистической регрессии и лучше

211
00:07:22,370 --> 00:07:24,697
понять ее.