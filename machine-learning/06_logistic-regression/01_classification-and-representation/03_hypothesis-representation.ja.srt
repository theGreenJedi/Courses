1
00:00:00,210 --> 00:00:02,931
ロジスティック回帰について話そう。

2
00:00:02,950 --> 00:00:04,315
このビデオでは

3
00:00:04,315 --> 00:00:07,210
仮説の表現を見ていく。

4
00:00:07,210 --> 00:00:08,805
つまり、分類問題に対して

5
00:00:08,810 --> 00:00:10,266
どのような関数を

6
00:00:10,300 --> 00:00:15,446
仮説の表現に使っていくか、という事。

7
00:00:15,450 --> 00:00:16,969
以前、我らの望む分類器（classifier）は

8
00:00:16,969 --> 00:00:20,426
0から1までの間の

9
00:00:20,426 --> 00:00:21,956
結果の値を吐く物だと

10
00:00:21,956 --> 00:00:23,250
言った。

11
00:00:23,270 --> 00:00:24,566
だからこの性質を満たす

12
00:00:24,566 --> 00:00:26,385
仮説が欲しい。

13
00:00:26,385 --> 00:00:30,396
これらの予測は0から1の間になるような。

14
00:00:30,396 --> 00:00:32,764
線形回帰を使うと、

15
00:00:32,764 --> 00:00:34,262
仮説の形はこうなった。

16
00:00:34,262 --> 00:00:35,604
h(x)は

17
00:00:35,604 --> 00:00:38,319
シータの転置にxを掛けた物。

18
00:00:38,330 --> 00:00:39,831
ロジスティック回帰の場合は

19
00:00:39,831 --> 00:00:41,075
これをちょっと変更して、

20
00:00:41,075 --> 00:00:43,352
仮説をgの シータ転置 x と

21
00:00:43,360 --> 00:00:46,218
する。ここでgは

22
00:00:46,218 --> 00:00:47,711
以下のように

23
00:00:47,711 --> 00:00:50,693
定義する。

24
00:00:50,693 --> 00:00:51,926
g(z)は、

25
00:00:51,926 --> 00:00:53,633
zを実数として、

26
00:00:53,640 --> 00:00:55,640
= 1+eの-z乗 分の1。

27
00:00:55,640 --> 00:00:58,480
これは

28
00:00:58,490 --> 00:01:01,716
sigmoid関数、または

29
00:01:01,720 --> 00:01:04,843
ロジスティック関数と呼ばれる。

30
00:01:04,843 --> 00:01:07,089
そしてロジスティック関数という言葉が

31
00:01:07,120 --> 00:01:11,103
ロジスティック回帰の語源でもある。

32
00:01:11,103 --> 00:01:12,781
ところで、sigmoid関数と

33
00:01:12,781 --> 00:01:14,551
ロジスティック関数という用語は

34
00:01:14,551 --> 00:01:16,996
どちらも基本的には略称で

35
00:01:16,996 --> 00:01:18,362
そして同じ物を意味する。

36
00:01:18,362 --> 00:01:19,756
つまり2つの用語は

37
00:01:19,756 --> 00:01:21,893
交換可能で、

38
00:01:21,893 --> 00:01:23,160
どちらの用語でも

39
00:01:23,160 --> 00:01:24,620
この関数gを指すのに使える。

40
00:01:24,620 --> 00:01:26,283
そして

41
00:01:26,283 --> 00:01:27,734
これら2つの等式をとり、

42
00:01:27,734 --> 00:01:30,089
一つにくっつけると、

43
00:01:30,089 --> 00:01:32,354
我らの仮説の形式の

44
00:01:32,354 --> 00:01:34,843
別の書き方となる。

45
00:01:34,843 --> 00:01:36,533
つまり、h(x)は

46
00:01:36,540 --> 00:01:38,933
1足すeの-シータ転置のx

47
00:01:38,933 --> 00:01:41,765
分の一。

48
00:01:41,765 --> 00:01:43,106
自分が今やってみせたのは

49
00:01:43,106 --> 00:01:45,353
変数zをとり、

50
00:01:45,353 --> 00:01:46,700
zはここでは実数で、

51
00:01:46,760 --> 00:01:48,173
そこにシータ転置のxを

52
00:01:48,173 --> 00:01:50,201
代入した。

53
00:01:50,201 --> 00:01:52,560
最終的には、シータ転置のxが、

54
00:01:52,560 --> 00:01:54,933
zの場所に収まった。

55
00:01:54,940 --> 00:01:57,949
最後に、sigmoid関数がどんな感じか見ておこう。

56
00:01:57,949 --> 00:02:00,296
この図にプロットしてみる。

57
00:02:00,296 --> 00:02:02,022
sigmoid関数gのzは、

58
00:02:02,022 --> 00:02:04,652
ロジスティック関数とも呼ばれているが、それはこんなだ。

59
00:02:04,652 --> 00:02:07,078
ゼロのそばから始まって、

60
00:02:07,078 --> 00:02:09,366
進むに連れて上昇し、

61
00:02:09,366 --> 00:02:13,473
原点で0.5となる。そしてふたたび平らになっていく。

62
00:02:13,500 --> 00:02:16,051
以上がsigmoid関数がどんな感じか、だ。

63
00:02:16,051 --> 00:02:17,898
気づいたと思うが

64
00:02:17,898 --> 00:02:19,725
sigmoid関数は

65
00:02:19,740 --> 00:02:21,894
1に漸近していき、

66
00:02:21,894 --> 00:02:24,256
0に漸近していく、

67
00:02:24,256 --> 00:02:26,388
横軸のzに対して。

68
00:02:26,388 --> 00:02:27,659
Zがマイナスの無限大に行くと

69
00:02:27,659 --> 00:02:29,304
gのzはゼロに

70
00:02:29,304 --> 00:02:31,396
近づく。

71
00:02:31,396 --> 00:02:33,816
そしてzが無限大に近づくと、

72
00:02:33,816 --> 00:02:35,864
gのzは1へと近づく。

73
00:02:35,880 --> 00:02:37,252
つまり、gのzは

74
00:02:37,252 --> 00:02:39,408
0と1の間の値を

75
00:02:39,408 --> 00:02:41,696
提供する。

76
00:02:41,730 --> 00:02:44,592
hのxも

77
00:02:44,610 --> 00:02:47,141
0と1の間になる。

78
00:02:47,141 --> 00:02:50,029
最後にこの仮説の形式で、

79
00:02:50,040 --> 00:02:52,123
我らが知る必要のある物は

80
00:02:52,123 --> 00:02:53,740
前回同様、

81
00:02:53,740 --> 00:02:58,841
我らのデータへのフィットのパラメータ、シータだ。

82
00:02:58,841 --> 00:03:00,490
つまり、所与のトレーニングセットに対し、

83
00:03:00,490 --> 00:03:01,743
パラメータであるシータの値を

84
00:03:01,743 --> 00:03:03,773
選ばなくてはいけない。

85
00:03:03,773 --> 00:03:06,981
そうしてはじめて、この仮説は予測に使えるようになる。

86
00:03:06,981 --> 00:03:08,534
パラメータ シータのフィッティングのアルゴリズムは

87
00:03:08,534 --> 00:03:11,828
のちほど議論する。

88
00:03:11,828 --> 00:03:13,506
だがその前に、このモデルの

89
00:03:13,506 --> 00:03:17,379
解釈について少し議論しよう。

90
00:03:17,640 --> 00:03:19,612
hのxの結果は、

91
00:03:19,620 --> 00:03:21,660
こんな感じで

92
00:03:21,660 --> 00:03:23,637
解釈する。

93
00:03:23,637 --> 00:03:26,387
自分の仮説がなんらかの数を

94
00:03:26,400 --> 00:03:28,238
出力したら、

95
00:03:28,240 --> 00:03:30,126
その数字をyが1になる確率の

96
00:03:30,126 --> 00:03:33,400
推計値として扱う、

97
00:03:33,400 --> 00:03:35,170
その新規の入力の標本

98
00:03:35,170 --> 00:03:38,266
xに対する。
ようするにこういう事だ。

99
00:03:38,266 --> 00:03:40,324
例を示そう。

100
00:03:40,324 --> 00:03:43,932
腫瘍を分類する例を使う。

101
00:03:43,932 --> 00:03:45,234
特徴ベクトル X が

102
00:03:45,234 --> 00:03:47,945
あるとして、いつものように

103
00:03:47,945 --> 00:03:49,860
x1 を

104
00:03:49,860 --> 00:03:52,836
腫瘍の大きさとする。

105
00:03:52,836 --> 00:03:54,045
ある患者の

106
00:03:54,045 --> 00:03:55,459
腫瘍の大きさが

107
00:03:55,459 --> 00:03:57,183
わかっているとして、

108
00:03:57,183 --> 00:03:58,759
その特徴ベクトル X を

109
00:03:58,759 --> 00:04:00,963
私の仮説に与え、

110
00:04:00,970 --> 00:04:03,760
0.7 を得たとする。

111
00:04:03,760 --> 00:04:05,758
この仮説を次のように

112
00:04:05,758 --> 00:04:07,298
解釈する。

113
00:04:07,298 --> 00:04:08,790
この仮説が

114
00:04:08,790 --> 00:04:10,235
告げているのは

115
00:04:10,235 --> 00:04:12,143
特徴 X を持った患者の

116
00:04:12,143 --> 00:04:14,490
Y=1 である確率は

117
00:04:14,520 --> 00:04:16,772
0.7 だということだ。

118
00:04:16,772 --> 00:04:18,703
言い換えれば

119
00:04:18,720 --> 00:04:21,106
その患者の腫瘍は

120
00:04:21,106 --> 00:04:23,320
残念ながら

121
00:04:23,320 --> 00:04:27,836
70%、0.7 の確率で悪性ということだ。

122
00:04:27,860 --> 00:04:29,420
もう少し形式的に、

123
00:04:29,420 --> 00:04:30,473
あるいは数学的に

124
00:04:30,480 --> 00:04:31,763
書き出すと、

125
00:04:31,763 --> 00:04:34,803
私の仮説の

126
00:04:34,820 --> 00:04:37,144
出力を P(y=1) とし、

127
00:04:37,150 --> 00:04:39,913
θ によってパラメータ化された

128
00:04:39,913 --> 00:04:41,813
X を与える。

129
00:04:41,830 --> 00:04:43,389
確率に慣れた人なら、

130
00:04:43,389 --> 00:04:45,320
この等式の意味がわかるだろう。

131
00:04:45,320 --> 00:04:46,766
少し不慣れなら、

132
00:04:46,766 --> 00:04:48,673
この式は

133
00:04:48,673 --> 00:04:51,564
このように読もう。

134
00:04:51,580 --> 00:04:53,215
これはあるxの時に

135
00:04:53,215 --> 00:04:54,988
y が 1 に等しい確率だ。

136
00:04:54,988 --> 00:04:56,493
つまりある患者に対して、という事だ。

137
00:04:56,493 --> 00:04:58,027
その患者がフィーチャーxを持っている。

138
00:04:58,040 --> 00:04:59,860
所与の患者が特定の

139
00:04:59,860 --> 00:05:01,575
腫瘍のサイズだったとして、

140
00:05:01,575 --> 00:05:03,156
ーーそれはフィーチャーxで表されるがーー

141
00:05:03,156 --> 00:05:06,956
この確率はシータでパラメトライズされてる。

142
00:05:07,130 --> 00:05:09,166
ようするに、私は基本的には

143
00:05:09,166 --> 00:05:11,009
仮説がy=1となる

144
00:05:11,009 --> 00:05:13,332
確率の推計値を

145
00:05:13,332 --> 00:05:15,349
与えてくれると思う訳だ。

146
00:05:15,349 --> 00:05:16,523
ここで、

147
00:05:16,523 --> 00:05:18,629
これは分類のタスクなので、

148
00:05:18,640 --> 00:05:21,497
yは0か1のどちらかだと知っているのだ。

149
00:05:21,497 --> 00:05:23,373
それら2つのみが、

150
00:05:23,390 --> 00:05:25,466
yがとる事の出来る値なのだ。

151
00:05:25,466 --> 00:05:26,654
それがトレーニングセットだろうと

152
00:05:26,654 --> 00:05:28,077
私のオフィスや医者の所に将来やってきた

153
00:05:28,077 --> 00:05:32,014
新たな患者に対してだろうと。

154
00:05:32,014 --> 00:05:33,529
つまりhのxが与えられると

155
00:05:33,550 --> 00:05:36,153
yがゼロとなる確率も

156
00:05:36,153 --> 00:05:39,116
計算出来る。

157
00:05:39,116 --> 00:05:41,209
具体的には、yは

158
00:05:41,250 --> 00:05:43,065
0か1のどちらかなのだから、

159
00:05:43,070 --> 00:05:45,141
yがゼロとなる確率と

160
00:05:45,141 --> 00:05:46,329
yが一となる確率を足すと、

161
00:05:46,329 --> 00:05:47,512
1にならなくてはならない事を

162
00:05:47,550 --> 00:05:50,173
知っているのだ。

163
00:05:50,173 --> 00:05:51,483
この等式はちょっと複雑に

164
00:05:51,483 --> 00:05:52,828
見えるかもしれないが、

165
00:05:52,828 --> 00:05:54,603
言ってる事は基本的には、

166
00:05:54,610 --> 00:05:56,287
ある患者の、その患者のフィーチャーがxとして、

167
00:05:56,320 --> 00:05:58,319
あるシータの時に、y=0である確率と

168
00:05:58,360 --> 00:06:01,002
その同じ患者が、同じフィーチャーの時、同じシータで

169
00:06:01,010 --> 00:06:02,305
y=1となる確率、との和は

170
00:06:02,305 --> 00:06:04,470
合計したら必ず1となる、

171
00:06:04,471 --> 00:06:06,334
と言ってるに過ぎない。

172
00:06:06,360 --> 00:06:08,260
もしこの等式が

173
00:06:08,260 --> 00:06:10,171
ちょっと複雑に見えたら

174
00:06:10,200 --> 00:06:14,049
心の目でxとシータ無しにしてしまっていいよ。

175
00:06:14,049 --> 00:06:15,476
するとこれは単に

176
00:06:15,480 --> 00:06:16,993
y=0となる確率 足すことの

177
00:06:16,993 --> 00:06:19,272
y=1となる確率 は必ず1とならなくてはならない。

178
00:06:19,280 --> 00:06:20,365
yは0か1のどちらかの値しか取らないのだから

179
00:06:20,365 --> 00:06:23,120
これが成立しないといけない。

180
00:06:23,120 --> 00:06:24,240
つまりyが0となる場合

181
00:06:24,240 --> 00:06:25,918
足すことの yが1となる場合は

182
00:06:25,930 --> 00:06:29,547
それら2つを足し合わせたら1に必ずなる。

183
00:06:29,547 --> 00:06:31,387
だからこの項を

184
00:06:31,440 --> 00:06:33,780
右辺へと移項すると

185
00:06:33,780 --> 00:06:35,409
すると結果は

186
00:06:35,409 --> 00:06:37,327
この式となり、

187
00:06:37,327 --> 00:06:38,995
その意味する所は、y=0となる確率は

188
00:06:38,995 --> 00:06:40,502
1引くことのy=1とる確率、という事。

189
00:06:40,530 --> 00:06:43,548
従ってもし

190
00:06:43,560 --> 00:06:46,009
我々の仮説 h(x) が

191
00:06:46,009 --> 00:06:47,775
この項を与えるなら

192
00:06:47,790 --> 00:06:49,948
極めて簡単に確率、

193
00:06:49,948 --> 00:06:51,508
つまり y=0

194
00:06:51,510 --> 00:06:53,282
となる推定確率を

195
00:06:53,282 --> 00:06:55,411
計算できる。

196
00:06:55,411 --> 00:06:56,720
さて、ロジスティック回帰における

197
00:06:56,720 --> 00:06:59,779
仮説の表現がわかって、

198
00:06:59,790 --> 00:07:01,576
またどんな数式により

199
00:07:01,580 --> 00:07:03,534
ロジスティック回帰の仮説が

200
00:07:03,534 --> 00:07:06,701
定義されるかを見ている。

201
00:07:06,701 --> 00:07:07,880
次のビデオでは、

202
00:07:07,880 --> 00:07:09,018
仮説の関数がどんな物かを

203
00:07:09,040 --> 00:07:11,091
より良い感覚が得られるように

204
00:07:11,091 --> 00:07:12,518
なりたいと思う。

205
00:07:12,518 --> 00:07:13,606
そして決定境界と呼ばれる

206
00:07:13,620 --> 00:07:15,294
物についても説明し、

207
00:07:15,294 --> 00:07:16,700
ある種の可視化も一緒に行うことで、

208
00:07:16,700 --> 00:07:18,846
このロジスティック回帰における仮説の関数が

209
00:07:18,846 --> 00:07:20,186
どんな物か

210
00:07:20,186 --> 00:07:22,370
より感覚的に分かるように

211
00:07:22,370 --> 00:07:24,697
見ていこう。