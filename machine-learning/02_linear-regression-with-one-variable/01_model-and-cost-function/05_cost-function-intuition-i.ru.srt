1
00:00:00,000 --> 00:00:04,100
В предыдущем видео мы
дали математическое определение

2
00:00:04,100 --> 00:00:08,616
функции затрат.Теперь я хочу рассмотреть
несколько примеров, чтобы привести вас к интуитивному пониманию

3
00:00:08,616 --> 00:00:14,466
того, как устроена функция затрат и почему
мы ее используем.Вкратце повторю, о

4
00:00:14,466 --> 00:00:19,396
чем шла речь в прошлый раз.Мы хотим
подобрать прямую, хорошо описывающую

5
00:00:19,396 --> 00:00:23,958
наши данные. Мы сформировали
такую гипотезу с параметрами тета

6
00:00:23,958 --> 00:00:28,888
нулевое и тета первое. Меняя
значения параметров, мы получим прямые,

7
00:00:31,323 --> 00:00:33,758
в разной степени подходящиек нашим данным, вот такие.
И мы описали функцию стоимости

8
00:00:33,758 --> 00:00:38,554
и задачу оптимизации.
В этом видео, чтобы было

9
00:00:38,554 --> 00:00:43,293
легче представить себе функцию
стоимости J, я буду использовать

10
00:00:43,293 --> 00:00:48,220
упрощенную гипотезу, как показано справа.
То есть упрощенная гипотеза это тета первое умножить

11
00:00:48,220 --> 00:00:53,275
на x. Если хотите, считайте, что мы положили
тета нулевое равным

12
00:00:53,275 --> 00:00:58,721
нулю.Тогда у
нас есть только один параметр, тета первое,

13
00:00:58,721 --> 00:01:04,372
и функция стоимости
почти такая же, как и раньше,

14
00:01:04,372 --> 00:01:10,309
только h(x) это просто тета первое на x.
И задача оптимизации

15
00:01:10,309 --> 00:01:16,246
сводится к минимизации J
по одному параметру, тета первому.На графике это выглядит

16
00:01:16,246 --> 00:01:21,611
так. То есть, если положить тета нулевое
равным нулю, то мы рассматриваем только функции-гипотезы,

17
00:01:21,611 --> 00:01:27,176
чей график проходит через
начало координат, точку (0.0).

18
00:01:27,176 --> 00:01:33,415
Используя этот упрощенный вариант гипотезы и функции
затрат, давайте попробуем вникнуть в суть

19
00:01:33,415 --> 00:01:40,178
функции затрат.На самом деле,
нам нужно разобраться в двух функциях.

20
00:01:40,178 --> 00:01:46,432
Первая — функция-гипотеза, а
вторая — функция затрат.Заметим, что

21
00:01:46,432 --> 00:01:52,068
гипотеза h(x) при
фиксированном значении тета первого — это функция

22
00:01:52,068 --> 00:01:58,168
от x. То есть гипотеза является функцией от размера
дома, x. Функция

23
00:01:58,168 --> 00:02:03,959
стоимости J,
напротив, — функция от тета

24
00:02:03,959 --> 00:02:09,993
первого, параметра, который определяет угол
наклона прямой.Давайте построим графики

25
00:02:09,993 --> 00:02:15,481
этих функций и попробуем понять их лучше.
Начнем с гипотезы.Пусть в

26
00:02:15,481 --> 00:02:20,283
левой части представлен мой обучающий набор из
трех точек: (1.1), (2.2) и (3.3).Давайте

27
00:02:20,283 --> 00:02:25,338
подбирать тета первое. Так, если его значение
равно единице,

28
00:02:25,338 --> 00:02:30,392
то график гипотезы — вот
такая прямая.

29
00:02:30,392 --> 00:02:35,234
Обратите внимание: когда я строю график
функции-гипотезы,по оси абсцисс,

30
00:02:35,234 --> 00:02:40,525
по горизонтальной оси, откладывается x, то есть
размер дома.

31
00:02:40,525 --> 00:02:46,551
Теперь, пока мы
зафиксировали тета первое равным единице, я хочу вычислить значение

32
00:02:46,551 --> 00:02:52,430
J в точке 1, значение J, когда тета
первое равно 1.Давайте

33
00:02:52,430 --> 00:02:58,781
посчитаем, чему равна функция
затрат.в точке 1.Функция затрат

34
00:02:58,781 --> 00:03:05,761
по-прежнему равна этому выражению,
так?Сумма по обучающему набору и

35
00:03:05,761 --> 00:03:13,840
квадрат ошибки.
И это, следовательно, равносумме...

36
00:03:14,740 --> 00:03:25,066
тета первого на x минус y, и
если подставить значения...получим...сумму

37
00:03:25,066 --> 00:03:31,995
квадратов трех нулей, что конечно равно
нулю.Смотрите,

38
00:03:31,995 --> 00:03:39,098
в функции затраткаждый из трех
слагаемых оказался равен нулю.Потому

39
00:03:39,098 --> 00:03:46,288
что для этого конкретного обучающего набора, для
трех примеров (1.1), (2.2) и (3.3)при тета первом равном

40
00:03:46,288 --> 00:03:54,667
единицеh(x), то естьзначение h для
x(i)в точности равно y(i). Сейчас я

41
00:03:54,667 --> 00:04:04,164
перепишу это понятнее.Так?И тогда разница
h(x) − y для каждого i равняется нулю, а значит и

42
00:04:04,164 --> 00:04:14,821
значение J в точке 1
равняется 0.Таким образом, теперь мы

43
00:04:14,821 --> 00:04:20,504
знаем, что J(1) = 0.Давайте отобразим это на графике.График
функции затрат J я

44
00:04:20,504 --> 00:04:26,187
буду рисовать в правой части.И обратите внимание: теперь,
поскольку функция затрат —

45
00:04:26,187 --> 00:04:32,017
функция параметра тета первое, на
графике ось абсцисс обозначена как

46
00:04:32,017 --> 00:04:38,069
тета первое.Итак, J(1) равно 0.
Давайте отобразим это на графике.То есть

47
00:04:38,069 --> 00:04:46,464
поставимкрестик вот здесь.Рассмотрим еще
несколько примеров.Тета первое может принимать

48
00:04:46,464 --> 00:04:52,470
различные значения.Так?
Отрицательные значения, ноль, положительные

49
00:04:52,470 --> 00:04:58,876
значения.Положим тета первое
равным 0,5.Что тогда?Давайте

50
00:04:58,876 --> 00:05:05,442
построим график.Если принять
значение тета первого равным 0,5, график гипотезы

51
00:05:05,442 --> 00:05:11,688
будет таким.Прямая, наклон
которой равен 0,5. Теперь

52
00:05:11,688 --> 00:05:17,855
вычислим J(0,5).Единица, деленная на
2m — наша обычная функция стоимости —

53
00:05:17,855 --> 00:05:23,769
умножить на сумму квадрата
длины вот этого

54
00:05:23,769 --> 00:05:29,609
отрезка,квадрата длины
этого отрезка и квадрата

55
00:05:29,609 --> 00:05:34,783
длины этого отрезка,
верно?Потому что это

56
00:05:34,783 --> 00:05:42,854
расстояние по вертикали — это
разница между y(i) и предсказанным значением,

57
00:05:42,854 --> 00:05:48,772
h от x(i), так?Для первого примера
получаем (0.5 − 1) в квадрате.

58
00:05:49,033 --> 00:05:55,647
Потому что предсказание гипотезы — 0.5,
а фактическое значение — 1.Для второго

59
00:05:55,647 --> 00:06:02,436
примера получаем (1 − 2) в квадрате, поскольку
гипотеза предсказала 1, но дом был

60
00:06:02,436 --> 00:06:09,663
продан по цене 2.
И, наконец, добавляем(1.5 − 3) в

61
00:06:09,663 --> 00:06:17,263
квадрате.Это равно единице, деленной на
дважды три,потому что m,

62
00:06:17,263 --> 00:06:24,274
размер обучающего набора, равно трем: у
нас три примера.И умножаем, суммируя

63
00:06:24,274 --> 00:06:33,011
слагаемые в скобках, на 3,5.
3.5 разделить на 6 примерно

64
00:06:33,011 --> 00:06:41,085
равняется 0.68.Теперь мы знаем,
что J(0.5) приблизительно равно 0.68.Отобразим это на графике.О,

65
00:06:41,085 --> 00:06:50,308
простите, арифметическая ошибка, на самом деле примерно 0.58.Значит,
точка на графике будет примерно

66
00:06:50,308 --> 00:07:00,293
здесь.Так?Еще один пример.Что, если
положить тета первое равным нулю? Чему

67
00:07:00,293 --> 00:07:08,975
будет равно J(0)?Если тета
первое равно нулю, то график h(x) будет просто

68
00:07:08,975 --> 00:07:16,916
этой горизонтальной прямой, так? Будет
просто лежать на горизонтальной

69
00:07:16,916 --> 00:07:26,882
оси.И теперь вычислим ошибки.
J(0) равняется 1 поделить на

70
00:07:26,882 --> 00:07:34,659
2m и умножить на сумму квадратов
единицы, двойки и тройки, то есть 1/6 умножить

71
00:07:34,659 --> 00:07:41,555
на 14, то есть примерно 2,3.Отметим
на графике и эту точку.Точка

72
00:07:41,555 --> 00:07:47,622
2.3 окажется где-то здесь.
Мы можем попробовать и

73
00:07:47,622 --> 00:07:53,335
другие значения параметра.Тета
первое может быть и отрицательным,

74
00:07:53,335 --> 00:07:59,327
вы можете положить значение
параметра меньше нуля, например, h(x) может

75
00:07:59,327 --> 00:08:05,179
равняться −0,5x, то есть тета первое
равно −0,5. Тогда графиком

76
00:08:05,179 --> 00:08:10,188
гипотезы будет
прямая с наклоном −0,5.Можно, собственно,

77
00:08:10,188 --> 00:08:15,694
вычислить ошибку и для таких значений;
для −0.5 значение ошибки будет

78
00:08:15,694 --> 00:08:21,520
уже весьма большим,
получится где-то 5.25.И так

79
00:08:21,520 --> 00:08:28,087
далее, мы можем вычислить ошибку для многих
значений параметра.

80
00:08:28,087 --> 00:08:34,413
Окажется, что, вычисляя значения
J в разных точках вы получите

81
00:08:34,413 --> 00:08:40,499
примерно такую картинуи по
вычисленным точкам постепенно сможете

82
00:08:40,499 --> 00:08:50,999
начертитькак выглядит график J от тета
первого, вот такую кривую.Резюмируя: каждое значение

83
00:08:50,999 --> 00:08:57,851
тета первогосоответствует
своей гипотезе, своей прямой линии

84
00:08:57,851 --> 00:09:04,448
на графике
слева.И для каждого

85
00:09:04,448 --> 00:09:11,723
значения параметра тета первое мы можем вычислить
значение J в этой точке.К примеру, вы

86
00:09:11,723 --> 00:09:19,354
помните, что при тета первом равном единице,
прямая линия пройдет точно через

87
00:09:19,354 --> 00:09:27,846
данные.А при тета
первом равном 0.5мы получили эту точку, отмеченную

88
00:09:27,846 --> 00:09:35,340
пурпурным крестиком, ей соответствует примерно такая
линия; а при значении ноль — эту горизонтальную

89
00:09:35,340 --> 00:09:41,527
линию.Так вот, для каждого
значения параметра мы вычислили

90
00:09:41,527 --> 00:09:48,516
значение J в этой точке и по этим
точкам построили график в правой

91
00:09:48,516 --> 00:09:54,461
части.Напомню теперь, что
задача оптимизации нашего

92
00:09:54,461 --> 00:10:01,963
алгоритма обучения состоит в выборе
такого значения тета первого,чтобы величина J в этой точке была минимальной.

93
00:10:01,963 --> 00:10:08,076
Так?Это наша целевая
функция в задаче линейной регрессии.Ну, по этой кривой понятно,

94
00:10:08,076 --> 00:10:13,710
что минимальное значение
J принимает при тета первом равном

95
00:10:13,710 --> 00:10:19,132
единице.И, кто бы мог подумать,
прямая, которая точнее всего соответствует

96
00:10:19,132 --> 00:10:24,624
нашим данным, получается
при тета первом равном единице.Для нашего конкретного

97
00:10:24,624 --> 00:10:30,328
обучающего набора эта прямая идеально вписывается в известные
данные.Поэтому минимизация

98
00:10:30,328 --> 00:10:36,447
значения J по тета первому соответствует нахождению прямой, хорошо
соответствующей данным.Подведу

99
00:10:36,447 --> 00:10:40,884
итог.В этом видео мы нарисовали
пару графиков,чтобы осознать, как устроена

100
00:10:40,884 --> 00:10:45,259
функция стоимости.Для этого мы упростили
алгоритмтак, что у нас остался

101
00:10:45,259 --> 00:10:50,258
только один параметр, тета первое.То есть мы зафиксировали
значение тета нулевого, равное нулю.В следующем видео

102
00:10:50,258 --> 00:10:54,445
мы вернемся к полной
формулировке задачи и рассмотрим

103
00:10:54,445 --> 00:10:59,570
графики, визуализирующие поиск
обоих параметров.То есть, не будем считать

104
00:10:59,570 --> 00:11:04,757
тета нулевое всегда равным нулю.Надеюсь, это даст вам
еще более четкое понимание того, как функция стоимости помогает нам

105
00:11:04,757 --> 00:11:09,257
решить исходную задачу линейной
регрессии.