В предыдущем видео мы
дали математическое определение функции затрат.Теперь я хочу рассмотреть
несколько примеров, чтобы привести вас к интуитивному пониманию того, как устроена функция затрат и почему
мы ее используем.Вкратце повторю, о чем шла речь в прошлый раз.Мы хотим
подобрать прямую, хорошо описывающую наши данные. Мы сформировали
такую гипотезу с параметрами тета нулевое и тета первое. Меняя
значения параметров, мы получим прямые, в разной степени подходящиек нашим данным, вот такие.
И мы описали функцию стоимости и задачу оптимизации.
В этом видео, чтобы было легче представить себе функцию
стоимости J, я буду использовать упрощенную гипотезу, как показано справа.
То есть упрощенная гипотеза это тета первое умножить на x. Если хотите, считайте, что мы положили
тета нулевое равным нулю.Тогда у
нас есть только один параметр, тета первое, и функция стоимости
почти такая же, как и раньше, только h(x) это просто тета первое на x.
И задача оптимизации сводится к минимизации J
по одному параметру, тета первому.На графике это выглядит так. То есть, если положить тета нулевое
равным нулю, то мы рассматриваем только функции-гипотезы, чей график проходит через
начало координат, точку (0.0). Используя этот упрощенный вариант гипотезы и функции
затрат, давайте попробуем вникнуть в суть функции затрат.На самом деле,
нам нужно разобраться в двух функциях. Первая — функция-гипотеза, а
вторая — функция затрат.Заметим, что гипотеза h(x) при
фиксированном значении тета первого — это функция от x. То есть гипотеза является функцией от размера
дома, x. Функция стоимости J,
напротив, — функция от тета первого, параметра, который определяет угол
наклона прямой.Давайте построим графики этих функций и попробуем понять их лучше.
Начнем с гипотезы.Пусть в левой части представлен мой обучающий набор из
трех точек: (1.1), (2.2) и (3.3).Давайте подбирать тета первое. Так, если его значение
равно единице, то график гипотезы — вот
такая прямая. Обратите внимание: когда я строю график
функции-гипотезы,по оси абсцисс, по горизонтальной оси, откладывается x, то есть
размер дома. Теперь, пока мы
зафиксировали тета первое равным единице, я хочу вычислить значение J в точке 1, значение J, когда тета
первое равно 1.Давайте посчитаем, чему равна функция
затрат.в точке 1.Функция затрат по-прежнему равна этому выражению,
так?Сумма по обучающему набору и квадрат ошибки.
И это, следовательно, равносумме... тета первого на x минус y, и
если подставить значения...получим...сумму квадратов трех нулей, что конечно равно
нулю.Смотрите, в функции затраткаждый из трех
слагаемых оказался равен нулю.Потому что для этого конкретного обучающего набора, для
трех примеров (1.1), (2.2) и (3.3)при тета первом равном единицеh(x), то естьзначение h для
x(i)в точности равно y(i). Сейчас я перепишу это понятнее.Так?И тогда разница
h(x) − y для каждого i равняется нулю, а значит и значение J в точке 1
равняется 0.Таким образом, теперь мы знаем, что J(1) = 0.Давайте отобразим это на графике.График
функции затрат J я буду рисовать в правой части.И обратите внимание: теперь,
поскольку функция затрат — функция параметра тета первое, на
графике ось абсцисс обозначена как тета первое.Итак, J(1) равно 0.
Давайте отобразим это на графике.То есть поставимкрестик вот здесь.Рассмотрим еще
несколько примеров.Тета первое может принимать различные значения.Так?
Отрицательные значения, ноль, положительные значения.Положим тета первое
равным 0,5.Что тогда?Давайте построим график.Если принять
значение тета первого равным 0,5, график гипотезы будет таким.Прямая, наклон
которой равен 0,5. Теперь вычислим J(0,5).Единица, деленная на
2m — наша обычная функция стоимости — умножить на сумму квадрата
длины вот этого отрезка,квадрата длины
этого отрезка и квадрата длины этого отрезка,
верно?Потому что это расстояние по вертикали — это
разница между y(i) и предсказанным значением, h от x(i), так?Для первого примера
получаем (0.5 − 1) в квадрате. Потому что предсказание гипотезы — 0.5,
а фактическое значение — 1.Для второго примера получаем (1 − 2) в квадрате, поскольку
гипотеза предсказала 1, но дом был продан по цене 2.
И, наконец, добавляем(1.5 − 3) в квадрате.Это равно единице, деленной на
дважды три,потому что m, размер обучающего набора, равно трем: у
нас три примера.И умножаем, суммируя слагаемые в скобках, на 3,5.
3.5 разделить на 6 примерно равняется 0.68.Теперь мы знаем,
что J(0.5) приблизительно равно 0.68.Отобразим это на графике.О, простите, арифметическая ошибка, на самом деле примерно 0.58.Значит,
точка на графике будет примерно здесь.Так?Еще один пример.Что, если
положить тета первое равным нулю? Чему будет равно J(0)?Если тета
первое равно нулю, то график h(x) будет просто этой горизонтальной прямой, так? Будет
просто лежать на горизонтальной оси.И теперь вычислим ошибки.
J(0) равняется 1 поделить на 2m и умножить на сумму квадратов
единицы, двойки и тройки, то есть 1/6 умножить на 14, то есть примерно 2,3.Отметим
на графике и эту точку.Точка 2.3 окажется где-то здесь.
Мы можем попробовать и другие значения параметра.Тета
первое может быть и отрицательным, вы можете положить значение
параметра меньше нуля, например, h(x) может равняться −0,5x, то есть тета первое
равно −0,5. Тогда графиком гипотезы будет
прямая с наклоном −0,5.Можно, собственно, вычислить ошибку и для таких значений;
для −0.5 значение ошибки будет уже весьма большим,
получится где-то 5.25.И так далее, мы можем вычислить ошибку для многих
значений параметра. Окажется, что, вычисляя значения
J в разных точках вы получите примерно такую картинуи по
вычисленным точкам постепенно сможете начертитькак выглядит график J от тета
первого, вот такую кривую.Резюмируя: каждое значение тета первогосоответствует
своей гипотезе, своей прямой линии на графике
слева.И для каждого значения параметра тета первое мы можем вычислить
значение J в этой точке.К примеру, вы помните, что при тета первом равном единице,
прямая линия пройдет точно через данные.А при тета
первом равном 0.5мы получили эту точку, отмеченную пурпурным крестиком, ей соответствует примерно такая
линия; а при значении ноль — эту горизонтальную линию.Так вот, для каждого
значения параметра мы вычислили значение J в этой точке и по этим
точкам построили график в правой части.Напомню теперь, что
задача оптимизации нашего алгоритма обучения состоит в выборе
такого значения тета первого,чтобы величина J в этой точке была минимальной. Так?Это наша целевая
функция в задаче линейной регрессии.Ну, по этой кривой понятно, что минимальное значение
J принимает при тета первом равном единице.И, кто бы мог подумать,
прямая, которая точнее всего соответствует нашим данным, получается
при тета первом равном единице.Для нашего конкретного обучающего набора эта прямая идеально вписывается в известные
данные.Поэтому минимизация значения J по тета первому соответствует нахождению прямой, хорошо
соответствующей данным.Подведу итог.В этом видео мы нарисовали
пару графиков,чтобы осознать, как устроена функция стоимости.Для этого мы упростили
алгоритмтак, что у нас остался только один параметр, тета первое.То есть мы зафиксировали
значение тета нулевого, равное нулю.В следующем видео мы вернемся к полной
формулировке задачи и рассмотрим графики, визуализирующие поиск
обоих параметров.То есть, не будем считать тета нулевое всегда равным нулю.Надеюсь, это даст вам
еще более четкое понимание того, как функция стоимости помогает нам решить исходную задачу линейной
регрессии.