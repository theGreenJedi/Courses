1
00:00:00,190 --> 00:00:01,190
이전 강의에서 여러분에게

2
00:00:01,190 --> 00:00:04,960
기울기 하강에 대한 수학적인 정의를 드렸습니다.

3
00:00:04,960 --> 00:00:08,830
이번에는 알고리즘의 개념에 대해서 
더 깊게 이해해보기 위해

4
00:00:08,830 --> 00:00:12,580
몇가지를 더 배워보겠습니다.

5
00:00:15,430 --> 00:00:19,580
저번시간에 봤던 기울기 하강알고리즘입니다.

6
00:00:19,580 --> 00:00:25,800
다시한번 기억시켜드리자면,
여기에 있는 α는 훈련비율입니다.

7
00:00:25,800 --> 00:00:30,620
얼마나 많은 값이 변하는가에 대한 변수이며,
파라메터 j값이 영향을 받습니다.

8
00:00:31,660 --> 00:00:36,406
그리고 여기에 있는 두번째 용어는 
미분계수입니다.

9
00:00:39,147 --> 00:00:43,904
그래서 이번 시간에 배울 것은,
이 두 용어에 대한 개념을 설명하고

10
00:00:43,904 --> 00:00:49,281
같이 사용됐을 때, 어떤 변화가 있는지
설명해드리겠습니다.

11
00:00:49,281 --> 00:00:55,054
이 개념을 잘 설명해 드리기 위해서, 
약간 간단한 예제를 사용해보겠습니다.

12
00:00:55,054 --> 00:01:00,403
하나의 파라메터를 가지고
함수를 최소화해보겠습니다.

13
00:01:00,403 --> 00:01:03,930
비용함수 j와 하나의 파라메터가 있다고 합시다.

14
00:01:03,930 --> 00:01:09,410
이전 비디오에서 많이 사용했던 Θ1을 쓰겠습니다.
Θ1은 실제 정수입니다.

15
00:01:09,410 --> 00:01:14,410
그래서 하나의 그래프를 그릴수 있게되는데요,
더 간단하게 표현해보겠습니다.

16
00:01:14,410 --> 00:01:17,360
이 함수에서 기울기 하강이
어떤 일을 하는지 봅시다.

17
00:01:20,850 --> 00:01:26,980
여기에 j Θ1 함수가 있습니다.

18
00:01:26,980 --> 00:01:28,550
이런식으로 생겼고요.

19
00:01:28,550 --> 00:01:31,505
Θ1은 실제 정수입니다.

20
00:01:32,635 --> 00:01:33,755
아시겠죠?

21
00:01:33,755 --> 00:01:39,605
Θ1의 위치를 그래프에서
표시해보도록 합시다.

22
00:01:39,605 --> 00:01:43,085
Θ1값이 함수와 만나는 지점을 표시해봅시다.

23
00:01:44,495 --> 00:01:48,105
함수가 어떤 값이 될까요?

24
00:01:49,570 --> 00:01:54,719
Θ1은 Θ1 - α 의 값으로
변할 것입니다.

25
00:01:54,719 --> 00:02:01,940
d/dΘ1, 맞죠?

26
00:02:01,940 --> 00:02:09,140
이게 바로 미분계수입니다.

27
00:02:09,140 --> 00:02:13,170
왜 갑자기 미분계수의 부분의 기호를 바꿨는지,

28
00:02:13,170 --> 00:02:16,280
두 기호간의 차이는 무엇인지,

29
00:02:16,280 --> 00:02:18,490
그리고 d는 무엇인지 모르셔도 괜찮습니다.

30
00:02:18,490 --> 00:02:22,000
수학 기술적으로, 이것을 부분 미분계수나

31
00:02:22,000 --> 00:02:27,170
미분계수라고 부르는데, 
함수j의 파라메터의 개수에 따라 달라집니다.

32
00:02:27,170 --> 00:02:28,690
그렇지만 이것은 수학 기술적인 의미입니다.

33
00:02:28,690 --> 00:02:32,000
이 강의에서 의미하는 바는,

34
00:02:32,000 --> 00:02:36,430
부분기호와 d, dΘ1은 같은 것입니다.

35
00:02:36,430 --> 00:02:38,650
실제로 뭐가 다른지에 대해 고민하지마세요.

36
00:02:38,650 --> 00:02:42,340
정확한 수학 표기법을 사용하려고 하겠지만,

37
00:02:42,340 --> 00:02:46,550
두 표기법이 의도하는 바는
정확히 같은 것입니다.

38
00:02:46,550 --> 00:02:48,890
이제 공식이 뭘 하는지를 봅시다.

39
00:02:48,890 --> 00:02:53,470
이 미분계수를 계산하려고하는데,

40
00:02:53,470 --> 00:02:57,460
계산하기 전에, 이 점에서 미분계수가 하는 일은

41
00:02:57,460 --> 00:03:02,380
그 점의 탄젠트값을 구하는 것입니다.
여기의 빨간 선처럼요.

42
00:03:02,380 --> 00:03:06,480
이 함수와 맞닿기만 하고요, 
이 빨간 선의 기울기를 봅시다.

43
00:03:06,480 --> 00:03:07,870
이 기울기 값이 바로

44
00:03:07,870 --> 00:03:11,890
함수의 탄젠트값이 바로
미분계수입니다.

45
00:03:11,890 --> 00:03:17,278
좋아요, 이 선의 기울기를 이정도 길이의
수직선으로 나눠봅시다.

46
00:03:17,278 --> 00:03:22,780
기울기가 양수값임을 알 수 있습니다.

47
00:03:22,780 --> 00:03:26,690
그 말은 미분계수가 양수라는 겁니다.

48
00:03:26,690 --> 00:03:30,370
이제 Θ1값은 변하게 되겠죠.

49
00:03:30,370 --> 00:03:35,813
Θ1 - α 값에 양수값을 곱한 값이 됩니다.

50
00:03:39,296 --> 00:03:40,271
좋아요.

51
00:03:40,271 --> 00:03:43,300
이제 α값은 항상 양수라는 것을 알았습니다.

52
00:03:43,300 --> 00:03:47,220
이제 우리가 해야할 일은 Θ1값에서
특정 값을 빼는겁니다.

53
00:03:47,220 --> 00:03:49,910
Θ1을 왼쪽으로 옮겨보겠습니다.

54
00:03:49,910 --> 00:03:53,350
그리고 Θ1값을 줄여보겠습니다.

55
00:03:53,350 --> 00:03:55,810
값이 줄어든다는 것은
이 방향으로 Θ1값이 이동하는 것을 말합니다.

56
00:03:55,810 --> 00:03:59,490
아시다시피, 최소값은 이 지점이니까요.

57
00:04:00,810 --> 00:04:04,060
그래서 지금까지 얘기한 것이
기울기하강입니다.

58
00:04:04,060 --> 00:04:06,120
다른 예제를 보시죠.

59
00:04:06,120 --> 00:04:10,330
같은 함수 j를 사용해보도록 하겠습니다.

60
00:04:10,330 --> 00:04:11,530
j Θ1 함수를 말입니다.

61
00:04:11,530 --> 00:04:16,140
그리고 저 왼쪽으로 파라메터를 
초기화해보겠습니다.

62
00:04:16,140 --> 00:04:17,740
Θ1은 여기에 있고요.

63
00:04:17,740 --> 00:04:19,240
함수의 표면과 만나는 점을 표시하겠습니다.

64
00:04:20,650 --> 00:04:25,680
이제 미분계수인 d/dΘ1 의 값을 구하기위해

65
00:04:25,680 --> 00:04:31,420
이 선의 기울기에 대해 보도록하죠.

66
00:04:31,420 --> 00:04:34,580
그러니까 이 선의 기울기가 
즉, 미분계수가 되는겁니다.

67
00:04:34,580 --> 00:04:37,644
그러나 이런 기울기는 음수값입니다.

68
00:04:41,021 --> 00:04:41,990
좋아요.

69
00:04:41,990 --> 00:04:45,880
이 함수를 음수 미분계수라고 하겠습니다.

70
00:04:45,880 --> 00:04:48,220
이 점의 기울기가 음수라는 뜻입니다.

71
00:04:48,220 --> 00:04:54,690
이 말은 값이 0과 같거나 작다는 것입니다.

72
00:04:54,690 --> 00:04:59,100
이제 Θ값은 Θ - α값에 음수를 곱한값이 됩니다.

73
00:05:02,380 --> 00:05:07,460
그래서 Θ1에 음수 값을 뺀다는 말은,

74
00:05:07,460 --> 00:05:11,210
Θ값이 증가한다는 말입니다.
왜냐하면 음수값을 빼주기 때문이죠.

75
00:05:11,210 --> 00:05:12,840
Θ값에 어떤 값을 더해준다는 말입니다.

76
00:05:12,840 --> 00:05:16,640
그 뜻은 바로 Θ값이 증가하면

77
00:05:16,640 --> 00:05:21,110
이제 이점에 있는 것이아니라

78
00:05:21,110 --> 00:05:24,270
최소값과 가까운 쪽으로 이동하게됩니다.

79
00:05:26,430 --> 00:05:31,600
이것이 바로 미분계수의 모든 개념적 이론입니다.

80
00:05:31,600 --> 00:05:36,250
이제 α가 의미하는 비율의 값을 보도록 합시다.

81
00:05:38,090 --> 00:05:42,330
여기에 기울기 하강 공식이 있습니다.

82
00:05:43,890 --> 00:05:48,440
이제부터 α값이 매우 작거나,

83
00:05:48,440 --> 00:05:50,740
크다면 어떻게 되는지 보도록합시다.

84
00:05:50,740 --> 00:05:54,200
첫번째 예시로는, 
α값이 매우 작다면 어떻게될까요?

85
00:05:54,200 --> 00:05:59,228
함수 j, j Θ가 있습니다.

86
00:05:59,228 --> 00:06:02,460
여기서부터 시작하도록 하죠.

87
00:06:02,460 --> 00:06:06,920
만약 α값이 매우 작다면,

88
00:06:06,920 --> 00:06:11,220
여기에 작은 숫자를 곱하게 될 겁니다.
그리고 매우 작게 이동할 겁니다.

89
00:06:11,220 --> 00:06:13,350
좋아요, 첫번째 점의 이동입니다.

90
00:06:13,350 --> 00:06:16,520
이제 새로운 점에서,
다른 이동을 해보도록 합시다.

91
00:06:16,520 --> 00:06:19,690
그러나 α값이 매우 작기때문에,
조금만 움직이도록 하겠습니다.

92
00:06:19,690 --> 00:06:26,530
그래서 만약 훈련 비율이 너무 작다면

93
00:06:26,530 --> 00:06:31,770
최소값에 도달하기위해 조금씩만 움직여야  할 겁니다.

94
00:06:31,770 --> 00:06:35,380
그리고 최소값에 이동하기위해 많은 이동이 필요하게 됩니다.

95
00:06:35,380 --> 00:06:38,980
α가 너무 작다면, 하강은 매우 느려집니다.

96
00:06:38,980 --> 00:06:40,880
많은 이동이 필요하기 때문이죠.

97
00:06:40,880 --> 00:06:44,830
전역적 최소값에 도달하기 위해서는
많은 이동이 필요합니다.

98
00:06:46,750 --> 00:06:49,460
이제 만약에 α값이 매우 크다면 어떻게 될까요?

99
00:06:49,460 --> 00:06:54,880
여기에 함수 j를 그려보도록 하겠습니다.

100
00:06:54,880 --> 00:06:59,180
그리고 α값이 너무 크다면 최소값보다 더 가거나,

101
00:06:59,180 --> 00:07:00,910
값을 바꾸거나 방향을 바꾸는 것도 어려워질 수 있습니다.

102
00:07:00,910 --> 00:07:04,170
우리의 자료가 이 지점에 있다고 해봅시다.
실제로 최소값과 매우 가깝습니다.

103
00:07:04,170 --> 00:07:07,430
그리고 방향은 오른쪽으로 이동해야합니다.
그러나 α값이 너무 큽니다.

104
00:07:07,430 --> 00:07:09,060
큰 거리를 이동을 해야합니다.

105
00:07:09,060 --> 00:07:10,820
기억하세요, 매우 큰 거리입니다.

106
00:07:10,820 --> 00:07:14,980
그래서 큰 거리를 이동했습니다.
그리고 비용함수의 반대편으로 가게됩니다.

107
00:07:14,980 --> 00:07:19,390
이 지점에서 시작했기때문이죠.
이제 제 값은 큰 반대값이 됩니다.

108
00:07:19,390 --> 00:07:22,872
이제 미분계수는 왼쪽에 있습니다.
자료값이 감소하게 되죠.

109
00:07:22,872 --> 00:07:25,070
하지만 훈련값이 너무 크기때문에.

110
00:07:25,070 --> 00:07:27,930
저기에 있는 지점으로 이동하게 됩니다.

111
00:07:27,930 --> 00:07:31,560
이 지점에서 끝나게 됩니다. 맞죠?

112
00:07:31,560 --> 00:07:35,020
그리고 α값이 크기때문에, 
또 다른 값으로 크게 이동합니다.

113
00:07:35,020 --> 00:07:39,950
계속해서 더 이동하고, 더 이동합니다.

114
00:07:39,950 --> 00:07:44,170
계속해서 최소값으로부터
멀어지게되죠.

115
00:07:44,170 --> 00:07:49,530
그래서 α값이 너무 크게되면, 
방향을 전환하는 것 조차 실패합니다.

116
00:07:49,530 --> 00:07:52,170
한가지 다른 질문을  해보겠습니다.

117
00:07:52,170 --> 00:07:55,870
약간 꼰 문제이며,
제가 처음에 이 문제를 풀기위해

118
00:07:55,870 --> 00:07:57,020
꽤 많은 시간을 썼습니다.

119
00:07:57,020 --> 00:08:00,740
만약 파라메터 Θ1이 이미 최소값이라면,

120
00:08:00,740 --> 00:08:03,420
어떤 각도로 하강해야할까요?

121
00:08:06,520 --> 00:08:10,260
Θ1이 지역최소값이라고 가정해봅시다.

122
00:08:10,260 --> 00:08:15,580
그리고 Θ1인 지역최소값은
이 지점이라고 해봅시다.

123
00:08:15,580 --> 00:08:18,630
이미 지역적 최적, 최소값입니다.

124
00:08:19,960 --> 00:08:23,280
지역 최적값이라면, 
미분계수는 0이됩니다.

125
00:08:23,280 --> 00:08:29,070
그래서 이 선의 기울기, 탄젠트값은

126
00:08:29,070 --> 00:08:36,370
0과 같아질거고, 미분계수는 0이됩니다.

127
00:08:36,370 --> 00:08:38,430
그래서 하강 기울기를 찾아봅시다.

128
00:08:38,430 --> 00:08:43,970
Θ1 값은 Θ - α값에 0을 곱한 값이됩니다.

129
00:08:43,970 --> 00:08:48,780
이 의미는 만약 이미 지역최적값이라면,

130
00:08:48,780 --> 00:08:54,680
Θ1값은 변하지 않게되고,
Θ1 = Θ1이 됩니다.

131
00:08:54,680 --> 00:08:57,830
그래서 만약 파라메터가 지역최소값이라면,

132
00:08:57,830 --> 00:09:00,980
하강 기울기는 파라메터에 
아무런 영향도 끼치지않습니다.

133
00:09:00,980 --> 00:09:04,830
이렇게 되면 지역최적값이 유지가 됩니다.

134
00:09:05,970 --> 00:09:09,860
그리고 만약 훈련 비율인 α가 고정되어있다면,

135
00:09:09,860 --> 00:09:13,110
하강 기울기는 최소값에 영향을 미치지못합니다.

136
00:09:13,110 --> 00:09:15,570
이 예제를 보시면서 이해해봅시다.

137
00:09:15,570 --> 00:09:20,570
Θ에 대한 비용함수 j가 있습니다.

138
00:09:20,570 --> 00:09:24,750
저는 최소화하고싶고,
알고리즘을 초기화해봅시다.

139
00:09:24,750 --> 00:09:29,040
하강 기울기 또한 초기화해봅시다.
이 분홍색으로 표시한 점으로 말입니다.

140
00:09:29,040 --> 00:09:33,060
하강 기울기에서 이동하게 된다면, 
저는 이 지점으로 이동하게 될 것입니다.

141
00:09:33,060 --> 00:09:34,770
왜냐면 미분계수가 매우 가파르기때문입니다.

142
00:09:34,770 --> 00:09:36,020
그렇지 않습니까?

143
00:09:36,020 --> 00:09:41,130
저는 이제 이 초록색 지점에 있게되고,
하강 기울기에서 또 이동해봅시다.

144
00:09:41,130 --> 00:09:45,740
미분계수가 기울기를 의미한다는 것을 기억하실겁니다.

145
00:09:45,740 --> 00:09:49,470
분홍색지점보다 초록색지점이
기울기가 덜 가파릅니다.

146
00:09:49,470 --> 00:09:54,060
왜냐하면 최소값에 가까워지고 있고,
제 미분계수는 0에 가까워지고 있으니까요.

147
00:09:54,060 --> 00:09:57,570
최소값에 가까워질수록 말입니다.

148
00:09:57,570 --> 00:10:02,350
좀 더 하강해본다면, 
제 미분계수는 더 작아질겁니다.

149
00:10:02,350 --> 00:10:04,890
하강 기울기에서 더 내려가보겠습니다.

150
00:10:04,890 --> 00:10:08,910
분홍색 점에서 초록색 점으로 이동한 거리보다

151
00:10:08,910 --> 00:10:11,290
더 적게 이동해보도록 하겠습니다.

152
00:10:11,290 --> 00:10:15,030
새로운 지점에서,
전역적 최소값에 더 가까워졌습니다.

153
00:10:15,030 --> 00:10:19,390
그리고 미분계수는 초록색 점보다 더 작아집니다.

154
00:10:19,390 --> 00:10:21,050
하강 기울기에서 또 이동했습니다.

155
00:10:22,280 --> 00:10:26,560
이렇게 적은 거리를 이동거리를 이동하게 되더라도

156
00:10:26,560 --> 00:10:31,700
미분계수는 더 작아지고, Θ1의 값도 더 작아집니다.

157
00:10:31,700 --> 00:10:36,630
하강 기울기를 계속 진행하면서,

158
00:10:36,630 --> 00:10:40,870
자연스럽게 더 조금씩 움직일 겁니다.

159
00:10:41,880 --> 00:10:45,230
결국에 조금씩 이동하다보면,

160
00:10:45,230 --> 00:10:48,990
지역 최소값에 도달하게 될겁니다.

161
00:10:50,270 --> 00:10:55,580
요약하자면, 하강 기울기는 지역 최소값에 가까워질수록,

162
00:10:55,580 --> 00:10:58,290
더 작은 거리를 이동하게 됩니다.

163
00:10:58,290 --> 00:11:01,060
왜냐하면, 최소값에 가까워진다는 것은

164
00:11:01,060 --> 00:11:06,110
지역 최소값의 정의는, 미분계수가 0이 되는 것이기 때문입니다.

165
00:11:06,110 --> 00:11:10,450
지역 최소값에 가까워질수록,

166
00:11:10,450 --> 00:11:16,720
미분계수값은 작아지게 되고,
하강 기울기는 더 조금씩 이동하게 됩니다.

167
00:11:16,720 --> 00:11:21,140
그렇기 때문에 α값을 감소할 필요가 없는겁니다.

168
00:11:22,810 --> 00:11:27,840
이게 바로 기울기 하강 알고리즘이였습니다.

169
00:11:27,840 --> 00:11:32,940
선형회귀에서 어떤 비용함수 j나 비용함수가 아니더라도 
최소값을 구할 때 사용할 수 있습니다.

170
00:11:32,940 --> 00:11:35,720
다음시간에서는 비용함수 j를 사용해서

171
00:11:35,720 --> 00:11:39,350
선형회귀에서 사용되는 비용함수로 돌아가보도록 하겠습니다.

172
00:11:39,350 --> 00:11:42,140
우리가 했던 비용함수의 제곱말입니다.

173
00:11:42,140 --> 00:11:46,210
그리고 이 함수와 기울기 하강 알고리즘을 
함께
사용해보도록 하겠습니다.

174
00:11:46,210 --> 00:11:48,830
지도 알고리즘을 이해하고,

175
00:11:48,830 --> 00:11:50,750
선형 회귀 알고리즘을 이해하게 해 줄겁니다.